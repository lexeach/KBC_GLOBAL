const __vite__fileDeps=["assets/index-ONNC42Bc.js","assets/index-CGqSlFVE.js","assets/index-DFiRnuao.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{u as fw,v as dw,w as pw,x as gw,y as yw,z as mw,A as vw,C as ww,D as bw,E as _w,F as Ew,G as Iw,J as xw,K as Sw,L as Pw,M as Qc,N as Df,O as oe,P as jf,Q as ko,R as Ow,S as Mf,T as Rw,U as Aw,V as Tw,W as ds,e as Yc,X as Nw,Y as Lf,Z as Kr,_ as Cw}from"./index-CGqSlFVE.js";import{e as Cr,$ as Xc}from"./events-CoGBI-gR.js";function Zc(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Uf(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Zc(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function Mc(n,t){t||(t=n.reduce((a,u)=>a+u.length,0));const r=Uf(t);let s=0;for(const a of n)r.set(a,s),s+=a.length;return Zc(r)}const pl={...fw,...dw,...pw,...gw,...yw,...mw,...vw,...ww,...bw,..._w};function qf(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const gl=qf("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),wc=qf("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=Uf(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),zf={utf8:gl,"utf-8":gl,hex:pl.base16,latin1:wc,ascii:wc,binary:wc,...pl};function fr(n,t="utf8"){const r=zf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Zc(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function tr(n,t="utf8"){const r=zf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}var yl=function(n,t,r){if(r||arguments.length===2)for(var s=0,a=t.length,u;s<a;s++)(u||!(s in t))&&(u||(u=Array.prototype.slice.call(t,0,s)),u[s]=t[s]);return n.concat(u||Array.prototype.slice.call(t))},$w=function(){function n(t,r,s){this.name=t,this.version=r,this.os=s,this.type="browser"}return n}(),Dw=function(){function n(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return n}(),jw=function(){function n(t,r,s,a){this.name=t,this.version=r,this.os=s,this.bot=a,this.type="bot-device"}return n}(),Mw=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),Lw=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),Uw=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,qw=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ml=3,zw=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Uw]],vl=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function kw(n){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Lw:typeof navigator<"u"?Kw(navigator.userAgent):Fw()}function Hw(n){return n!==""&&zw.reduce(function(t,r){var s=r[0],a=r[1];if(t)return t;var u=a.exec(n);return!!u&&[s,u]},!1)}function Kw(n){var t=Hw(n);if(!t)return null;var r=t[0],s=t[1];if(r==="searchbot")return new Mw;var a=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);a?a.length<ml&&(a=yl(yl([],a,!0),Vw(ml-a.length),!0)):a=[];var u=a.join("."),f=Bw(n),g=qw.exec(n);return g&&g[1]?new jw(r,u,f,g[1]):new $w(r,u,f)}function Bw(n){for(var t=0,r=vl.length;t<r;t++){var s=vl[t],a=s[0],u=s[1],f=u.exec(n);if(f)return a}return null}function Fw(){var n=typeof process<"u"&&process.version;return n?new Dw(process.version.slice(1)):null}function Vw(n){for(var t=[],r=0;r<n;r++)t.push("0");return t}const Ww={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var us={};(function(n){const t=xw,r=Sw,s=Ew,a=Iw,u=A=>A==null,f=Symbol("encodeFragmentIdentifier");function g(A){switch(A.arrayFormat){case"index":return $=>(j,U)=>{const B=j.length;return U===void 0||A.skipNull&&U===null||A.skipEmptyString&&U===""?j:U===null?[...j,[_($,A),"[",B,"]"].join("")]:[...j,[_($,A),"[",_(B,A),"]=",_(U,A)].join("")]};case"bracket":return $=>(j,U)=>U===void 0||A.skipNull&&U===null||A.skipEmptyString&&U===""?j:U===null?[...j,[_($,A),"[]"].join("")]:[...j,[_($,A),"[]=",_(U,A)].join("")];case"colon-list-separator":return $=>(j,U)=>U===void 0||A.skipNull&&U===null||A.skipEmptyString&&U===""?j:U===null?[...j,[_($,A),":list="].join("")]:[...j,[_($,A),":list=",_(U,A)].join("")];case"comma":case"separator":case"bracket-separator":{const $=A.arrayFormat==="bracket-separator"?"[]=":"=";return j=>(U,B)=>B===void 0||A.skipNull&&B===null||A.skipEmptyString&&B===""?U:(B=B===null?"":B,U.length===0?[[_(j,A),$,_(B,A)].join("")]:[[U,_(B,A)].join(A.arrayFormatSeparator)])}default:return $=>(j,U)=>U===void 0||A.skipNull&&U===null||A.skipEmptyString&&U===""?j:U===null?[...j,_($,A)]:[...j,[_($,A),"=",_(U,A)].join("")]}}function v(A){let $;switch(A.arrayFormat){case"index":return(j,U,B)=>{if($=/\[(\d*)\]$/.exec(j),j=j.replace(/\[\d*\]$/,""),!$){B[j]=U;return}B[j]===void 0&&(B[j]={}),B[j][$[1]]=U};case"bracket":return(j,U,B)=>{if($=/(\[\])$/.exec(j),j=j.replace(/\[\]$/,""),!$){B[j]=U;return}if(B[j]===void 0){B[j]=[U];return}B[j]=[].concat(B[j],U)};case"colon-list-separator":return(j,U,B)=>{if($=/(:list)$/.exec(j),j=j.replace(/:list$/,""),!$){B[j]=U;return}if(B[j]===void 0){B[j]=[U];return}B[j]=[].concat(B[j],U)};case"comma":case"separator":return(j,U,B)=>{const W=typeof U=="string"&&U.includes(A.arrayFormatSeparator),J=typeof U=="string"&&!W&&x(U,A).includes(A.arrayFormatSeparator);U=J?x(U,A):U;const Oe=W||J?U.split(A.arrayFormatSeparator).map(Qe=>x(Qe,A)):U===null?U:x(U,A);B[j]=Oe};case"bracket-separator":return(j,U,B)=>{const W=/(\[\])$/.test(j);if(j=j.replace(/\[\]$/,""),!W){B[j]=U&&x(U,A);return}const J=U===null?[]:U.split(A.arrayFormatSeparator).map(Oe=>x(Oe,A));if(B[j]===void 0){B[j]=J;return}B[j]=[].concat(B[j],J)};default:return(j,U,B)=>{if(B[j]===void 0){B[j]=U;return}B[j]=[].concat(B[j],U)}}}function y(A){if(typeof A!="string"||A.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function _(A,$){return $.encode?$.strict?t(A):encodeURIComponent(A):A}function x(A,$){return $.decode?r(A):A}function M(A){return Array.isArray(A)?A.sort():typeof A=="object"?M(Object.keys(A)).sort(($,j)=>Number($)-Number(j)).map($=>A[$]):A}function z(A){const $=A.indexOf("#");return $!==-1&&(A=A.slice(0,$)),A}function T(A){let $="";const j=A.indexOf("#");return j!==-1&&($=A.slice(j)),$}function re(A){A=z(A);const $=A.indexOf("?");return $===-1?"":A.slice($+1)}function ae(A,$){return $.parseNumbers&&!Number.isNaN(Number(A))&&typeof A=="string"&&A.trim()!==""?A=Number(A):$.parseBooleans&&A!==null&&(A.toLowerCase()==="true"||A.toLowerCase()==="false")&&(A=A.toLowerCase()==="true"),A}function ce(A,$){$=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},$),y($.arrayFormatSeparator);const j=v($),U=Object.create(null);if(typeof A!="string"||(A=A.trim().replace(/^[?#&]/,""),!A))return U;for(const B of A.split("&")){if(B==="")continue;let[W,J]=s($.decode?B.replace(/\+/g," "):B,"=");J=J===void 0?null:["comma","separator","bracket-separator"].includes($.arrayFormat)?J:x(J,$),j(x(W,$),J,U)}for(const B of Object.keys(U)){const W=U[B];if(typeof W=="object"&&W!==null)for(const J of Object.keys(W))W[J]=ae(W[J],$);else U[B]=ae(W,$)}return $.sort===!1?U:($.sort===!0?Object.keys(U).sort():Object.keys(U).sort($.sort)).reduce((B,W)=>{const J=U[W];return J&&typeof J=="object"&&!Array.isArray(J)?B[W]=M(J):B[W]=J,B},Object.create(null))}n.extract=re,n.parse=ce,n.stringify=(A,$)=>{if(!A)return"";$=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},$),y($.arrayFormatSeparator);const j=J=>$.skipNull&&u(A[J])||$.skipEmptyString&&A[J]==="",U=g($),B={};for(const J of Object.keys(A))j(J)||(B[J]=A[J]);const W=Object.keys(B);return $.sort!==!1&&W.sort($.sort),W.map(J=>{const Oe=A[J];return Oe===void 0?"":Oe===null?_(J,$):Array.isArray(Oe)?Oe.length===0&&$.arrayFormat==="bracket-separator"?_(J,$)+"[]":Oe.reduce(U(J),[]).join("&"):_(J,$)+"="+_(Oe,$)}).filter(J=>J.length>0).join("&")},n.parseUrl=(A,$)=>{$=Object.assign({decode:!0},$);const[j,U]=s(A,"#");return Object.assign({url:j.split("?")[0]||"",query:ce(re(A),$)},$&&$.parseFragmentIdentifier&&U?{fragmentIdentifier:x(U,$)}:{})},n.stringifyUrl=(A,$)=>{$=Object.assign({encode:!0,strict:!0,[f]:!0},$);const j=z(A.url).split("?")[0]||"",U=n.extract(A.url),B=n.parse(U,{sort:!1}),W=Object.assign(B,A.query);let J=n.stringify(W,$);J&&(J=`?${J}`);let Oe=T(A.url);return A.fragmentIdentifier&&(Oe=`#${$[f]?_(A.fragmentIdentifier,$):A.fragmentIdentifier}`),`${j}${J}${Oe}`},n.pick=(A,$,j)=>{j=Object.assign({parseFragmentIdentifier:!0,[f]:!1},j);const{url:U,query:B,fragmentIdentifier:W}=n.parseUrl(A,j);return n.stringifyUrl({url:U,query:a(B,$),fragmentIdentifier:W},j)},n.exclude=(A,$,j)=>{const U=Array.isArray($)?B=>!$.includes(B):(B,W)=>!$(B,W);return n.pick(A,U,j)}})(us);const Gw=":";function Jw(n){const[t,r]=n.split(Gw);return{namespace:t,reference:r}}function Qw(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}function kf(n,t){return n.includes(":")?[n]:t.chains||[]}const Hf="base10",er="base16",Lc="base64pad",eu="utf8",Kf=0,Yi=1,Yw=0,wl=1,Uc=12,tu=32;function Xw(){const n=jf.generateKeyPair();return{privateKey:tr(n.secretKey,er),publicKey:tr(n.publicKey,er)}}function qc(){const n=ko.randomBytes(tu);return tr(n,er)}function Zw(n,t){const r=jf.sharedKey(fr(n,er),fr(t,er),!0),s=new Ow(Qc.SHA256,r).expand(tu);return tr(s,er)}function eb(n){const t=Qc.hash(fr(n,er));return tr(t,er)}function Pn(n){const t=Qc.hash(fr(n,eu));return tr(t,er)}function tb(n){return fr(`${n}`,Hf)}function ps(n){return Number(tr(n,Hf))}function rb(n){const t=tb(typeof n.type<"u"?n.type:Kf);if(ps(t)===Yi&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?fr(n.senderPublicKey,er):void 0,s=typeof n.iv<"u"?fr(n.iv,er):ko.randomBytes(Uc),a=new Mf.ChaCha20Poly1305(fr(n.symKey,er)).seal(s,fr(n.message,eu));return nb({type:t,sealed:a,iv:s,senderPublicKey:r})}function ib(n){const t=new Mf.ChaCha20Poly1305(fr(n.symKey,er)),{sealed:r,iv:s}=Mo(n.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return tr(a,eu)}function nb(n){if(ps(n.type)===Yi){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return tr(Mc([n.type,n.senderPublicKey,n.iv,n.sealed]),Lc)}return tr(Mc([n.type,n.iv,n.sealed]),Lc)}function Mo(n){const t=fr(n,Lc),r=t.slice(Yw,wl),s=wl;if(ps(r)===Yi){const g=s+tu,v=g+Uc,y=t.slice(s,g),_=t.slice(g,v),x=t.slice(v);return{type:r,sealed:x,iv:_,senderPublicKey:y}}const a=s+Uc,u=t.slice(s,a),f=t.slice(a);return{type:r,sealed:f,iv:u}}function sb(n,t){const r=Mo(n);return Bf({type:ps(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?tr(r.senderPublicKey,er):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Bf(n){const t=(n==null?void 0:n.type)||Kf;if(t===Yi){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function bl(n){return n.type===Yi&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var ob=Object.defineProperty,_l=Object.getOwnPropertySymbols,ab=Object.prototype.hasOwnProperty,cb=Object.prototype.propertyIsEnumerable,El=(n,t,r)=>t in n?ob(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Il=(n,t)=>{for(var r in t||(t={}))ab.call(t,r)&&El(n,r,t[r]);if(_l)for(var r of _l(t))cb.call(t,r)&&El(n,r,t[r]);return n};const ub="ReactNative",br={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},hb="js";function ru(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function An(){return!Rw()&&!!Df()&&navigator.product===ub}function Tn(){return!ru()&&!!Df()}function gs(){return An()?br.reactNative:ru()?br.node:Tn()?br.browser:br.unknown}function lb(){var n;try{return An()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(n=global.Application)==null?void 0:n.applicationId:void 0}catch{return}}function fb(n,t){let r=us.parse(n);return r=Il(Il({},r),t),n=us.stringify(r),n}function db(){return Pw()||{name:"",description:"",url:"",icons:[""]}}function pb(){if(gs()===br.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const n=kw();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function gb(){var n;const t=gs();return t===br.browser?[t,((n=Aw())==null?void 0:n.host)||"unknown"].join(":"):t}function yb(n,t,r){const s=pb(),a=gb();return[[n,t].join("-"),[hb,r].join("-"),s,a].join("/")}function mb({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:u,useOnCloseEvent:f,bundleId:g}){const v=r.split("?"),y=yb(n,t,s),_={auth:a,ua:y,projectId:u,useOnCloseEvent:f||void 0,origin:g||void 0},x=fb(v[1]||"",_);return v[0]+"?"+x}function Ji(n,t){return n.filter(r=>t.includes(r)).length===n.length}function Ff(n){return Object.fromEntries(n.entries())}function Vf(n){return new Map(Object.entries(n))}function xn(n=oe.FIVE_MINUTES,t){const r=oe.toMiliseconds(n||oe.FIVE_MINUTES);let s,a,u;return{resolve:f=>{u&&s&&(clearTimeout(u),s(f))},reject:f=>{u&&a&&(clearTimeout(u),a(f))},done:()=>new Promise((f,g)=>{u=setTimeout(()=>{g(new Error(t))},r),s=f,a=g})}}function hs(n,t,r){return new Promise(async(s,a)=>{const u=setTimeout(()=>a(new Error(r)),t);try{const f=await n;s(f)}catch(f){a(f)}clearTimeout(u)})}function Wf(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function vb(n){return Wf("topic",n)}function wb(n){return Wf("id",n)}function Gf(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function kr(n,t){return oe.fromMiliseconds(Date.now()+oe.toMiliseconds(n))}function Ai(n){return Date.now()>=oe.toMiliseconds(n)}function Tt(n,t){return`${n}${t?`:${t}`:""}`}function bc(n=[],t=[]){return[...new Set([...n,...t])]}async function bb({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const u=`${a}/wc?requestId=${n}&sessionTopic=${t}`,f=gs();f===br.browser?u.startsWith("https://")?window.open(u,"_blank","noreferrer noopener"):window.open(u,"_self","noreferrer noopener"):f===br.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(u)}catch(s){console.error(s)}}async function _b(n,t){try{return await n.getItem(t)||(Tn()?localStorage.getItem(t):void 0)}catch(r){console.error(r)}}const Eb="irn";function zc(n){return(n==null?void 0:n.relay)||{protocol:Eb}}function Co(n){const t=Ww[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var Ib=Object.defineProperty,xl=Object.getOwnPropertySymbols,xb=Object.prototype.hasOwnProperty,Sb=Object.prototype.propertyIsEnumerable,Sl=(n,t,r)=>t in n?Ib(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Pb=(n,t)=>{for(var r in t||(t={}))xb.call(t,r)&&Sl(n,r,t[r]);if(xl)for(var r of xl(t))Sb.call(t,r)&&Sl(n,r,t[r]);return n};function Ob(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const u=a.replace(s,""),f=n[a];r[u]=f}}),r}function Pl(n){n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),a=n.substring(t+1,r).split("@"),u=typeof r<"u"?n.substring(r):"",f=us.parse(u);return{protocol:s,topic:Rb(a[0]),version:parseInt(a[1],10),symKey:f.symKey,relay:Ob(f)}}function Rb(n){return n.startsWith("//")?n.substring(2):n}function Ab(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const u=r+t+a;n[a]&&(s[u]=n[a])}),s}function Tb(n){return`${n.protocol}:${n.topic}@${n.version}?`+us.stringify(Pb({symKey:n.symKey},Ab(n.relay)))}function Nn(n){const t=[];return n.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function Nb(n){const t=[];return Object.values(n).forEach(r=>{t.push(...Nn(r.accounts))}),t}function Cb(n,t){const r=[];return Object.values(n).forEach(s=>{Nn(s.accounts).includes(t)&&r.push(...s.methods)}),r}function $b(n,t){const r=[];return Object.values(n).forEach(s=>{Nn(s.accounts).includes(t)&&r.push(...s.events)}),r}function Db(n,t){const r=$o(n,t);if(r)throw new Error(r.message);const s={};for(const[a,u]of Object.entries(n))s[a]={methods:u.methods,events:u.events,chains:u.accounts.map(f=>`${f.split(":")[0]}:${f.split(":")[1]}`)};return s}function iu(n){return n.includes(":")}function ss(n){return iu(n)?n.split(":")[0]:n}const jb={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Mb={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function X(n,t){const{message:r,code:s}=Mb[n];return{message:t?`${r} ${t}`:r,code:s}}function bt(n,t){const{message:r,code:s}=jb[n];return{message:t?`${r} ${t}`:r,code:s}}function Xr(n,t){return!!Array.isArray(n)}function On(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function lr(n){return typeof n>"u"}function Ut(n,t){return t&&lr(n)?!0:typeof n=="string"&&!!n.trim().length}function nu(n,t){return typeof n=="number"&&!isNaN(n)}function Lb(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),a=Object.keys(r);let u=!0;return Ji(a,s)?(s.forEach(f=>{const{accounts:g,methods:v,events:y}=n.namespaces[f],_=Nn(g),x=r[f];(!Ji(kf(f,x),_)||!Ji(x.methods,v)||!Ji(x.events,y))&&(u=!1)}),u):!1}function Lo(n){return Ut(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function Ub(n){if(Ut(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Lo(r)}}return!1}function qb(n){if(Ut(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function zb(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function kb(n){return n==null?void 0:n.topic}function Hb(n,t){let r=null;return Ut(n==null?void 0:n.publicKey,!1)||(r=X("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Ol(n){let t=!0;return Xr(n)?n.length&&(t=n.every(r=>Ut(r,!1))):t=!1,t}function Kb(n,t,r){let s=null;return Xr(t)&&t.length?t.forEach(a=>{s||Lo(a)||(s=bt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Lo(n)||(s=bt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function Bb(n,t,r){let s=null;return Object.entries(n).forEach(([a,u])=>{if(s)return;const f=Kb(a,kf(a,u),`${t} ${r}`);f&&(s=f)}),s}function Fb(n,t){let r=null;return Xr(n)?n.forEach(s=>{r||Ub(s)||(r=bt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=bt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Vb(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=Fb(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function Wb(n,t){let r=null;return Ol(n==null?void 0:n.methods)?Ol(n==null?void 0:n.events)||(r=bt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=bt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Jf(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=Wb(s,`${t}, namespace`);a&&(r=a)}),r}function Gb(n,t,r){let s=null;if(n&&On(n)){const a=Jf(n,t);a&&(s=a);const u=Bb(n,t,r);u&&(s=u)}else s=X("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function $o(n,t){let r=null;if(n&&On(n)){const s=Jf(n,t);s&&(r=s);const a=Vb(n,t);a&&(r=a)}else r=X("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Qf(n){return Ut(n.protocol,!0)}function Jb(n,t){let r=!1;return n?n&&Xr(n)&&n.length&&n.forEach(s=>{r=Qf(s)}):r=!0,r}function Qb(n){return typeof n=="number"}function hr(n){return typeof n<"u"&&typeof n!==null}function Yb(n){return!(!n||typeof n!="object"||!n.code||!nu(n.code)||!n.message||!Ut(n.message,!1))}function Xb(n){return!(lr(n)||!Ut(n.method,!1))}function Zb(n){return!(lr(n)||lr(n.result)&&lr(n.error)||!nu(n.id)||!Ut(n.jsonrpc,!1))}function e_(n){return!(lr(n)||!Ut(n.name,!1))}function Rl(n,t){return!(!Lo(t)||!Nb(n).includes(t))}function t_(n,t,r){return Ut(r,!1)?Cb(n,t).includes(r):!1}function r_(n,t,r){return Ut(r,!1)?$b(n,t).includes(r):!1}function Al(n,t,r){let s=null;const a=i_(n),u=n_(t),f=Object.keys(a),g=Object.keys(u),v=Tl(Object.keys(n)),y=Tl(Object.keys(t)),_=v.filter(x=>!y.includes(x));return _.length&&(s=X("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${_.toString()}
      Received: ${Object.keys(t).toString()}`)),Ji(f,g)||(s=X("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${f.toString()}
      Approved: ${g.toString()}`)),Object.keys(t).forEach(x=>{if(!x.includes(":")||s)return;const M=Nn(t[x].accounts);M.includes(x)||(s=X("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${x}
        Required: ${x}
        Approved: ${M.toString()}`))}),f.forEach(x=>{s||(Ji(a[x].methods,u[x].methods)?Ji(a[x].events,u[x].events)||(s=X("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${x}`)):s=X("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${x}`))}),s}function i_(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{t[a]={methods:n[r].methods,events:n[r].events}})}),t}function Tl(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function n_(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=Nn(n[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:n[r].accounts.filter(u=>u.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function s_(n,t){return nu(n)&&n<=t.max&&n>=t.min}function Nl(){const n=gs();return new Promise(t=>{switch(n){case br.browser:t(o_());break;case br.reactNative:t(a_());break;case br.node:t(c_());break;default:t(!0)}})}function o_(){return Tn()&&(navigator==null?void 0:navigator.onLine)}async function a_(){if(An()&&typeof global<"u"&&global!=null&&global.NetInfo){const n=await(global==null?void 0:global.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function c_(){return!0}function u_(n){switch(gs()){case br.browser:h_(n);break;case br.reactNative:l_(n);break}}function h_(n){!An()&&Tn()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function l_(n){An()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>n(t==null?void 0:t.isConnected)))}const _c={};let So=class{static get(t){return _c[t]}static set(t,r){_c[t]=r}static delete(t){delete _c[t]}};const f_=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,d_=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,p_=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function g_(n,t){if(n==="__proto__"||n==="constructor"&&t&&typeof t=="object"&&"prototype"in t){y_(n);return}return t}function y_(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function Po(n,t={}){if(typeof n!="string")return n;const r=n.trim();if(n[0]==='"'&&n.endsWith('"')&&!n.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!p_.test(n)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(f_.test(n)||d_.test(n)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,g_)}return JSON.parse(n)}catch(s){if(t.strict)throw s;return n}}function m_(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function Lt(n,...t){try{return m_(n(...t))}catch(r){return Promise.reject(r)}}function v_(n){const t=typeof n;return n===null||t!=="object"&&t!=="function"}function w_(n){const t=Object.getPrototypeOf(n);return!t||t.isPrototypeOf(Object)}function Do(n){if(v_(n))return String(n);if(w_(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return Do(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Yf(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const kc="base64:";function b_(n){if(typeof n=="string")return n;Yf();const t=Buffer.from(n).toString("base64");return kc+t}function __(n){return typeof n!="string"||!n.startsWith(kc)?n:(Yf(),Buffer.from(n.slice(kc.length),"base64"))}function ur(n){return n?n.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function E_(...n){return ur(n.join(":"))}function Oo(n){return n=ur(n),n?n+":":""}const I_="memory",x_=()=>{const n=new Map;return{name:I_,options:{},hasItem(t){return n.has(t)},getItem(t){return n.get(t)??null},getItemRaw(t){return n.get(t)??null},setItem(t,r){n.set(t,r)},setItemRaw(t,r){n.set(t,r)},removeItem(t){n.delete(t)},getKeys(){return Array.from(n.keys())},clear(){n.clear()},dispose(){n.clear()}}};function S_(n={}){const t={mounts:{"":n.driver||x_()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=y=>{for(const _ of t.mountpoints)if(y.startsWith(_))return{base:_,relativeKey:y.slice(_.length),driver:t.mounts[_]};return{base:"",relativeKey:y,driver:t.mounts[""]}},s=(y,_)=>t.mountpoints.filter(x=>x.startsWith(y)||_&&y.startsWith(x)).map(x=>({relativeBase:y.length>x.length?y.slice(x.length):void 0,mountpoint:x,driver:t.mounts[x]})),a=(y,_)=>{if(t.watching){_=ur(_);for(const x of t.watchListeners)x(y,_)}},u=async()=>{if(!t.watching){t.watching=!0;for(const y in t.mounts)t.unwatch[y]=await Cl(t.mounts[y],a,y)}},f=async()=>{if(t.watching){for(const y in t.unwatch)await t.unwatch[y]();t.unwatch={},t.watching=!1}},g=(y,_,x)=>{const M=new Map,z=T=>{let re=M.get(T.base);return re||(re={driver:T.driver,base:T.base,items:[]},M.set(T.base,re)),re};for(const T of y){const re=typeof T=="string",ae=ur(re?T:T.key),ce=re?void 0:T.value,A=re||!T.options?_:{..._,...T.options},$=r(ae);z($).items.push({key:ae,value:ce,relativeKey:$.relativeKey,options:A})}return Promise.all([...M.values()].map(T=>x(T))).then(T=>T.flat())},v={hasItem(y,_={}){y=ur(y);const{relativeKey:x,driver:M}=r(y);return Lt(M.hasItem,x,_)},getItem(y,_={}){y=ur(y);const{relativeKey:x,driver:M}=r(y);return Lt(M.getItem,x,_).then(z=>Po(z))},getItems(y,_){return g(y,_,x=>x.driver.getItems?Lt(x.driver.getItems,x.items.map(M=>({key:M.relativeKey,options:M.options})),_).then(M=>M.map(z=>({key:E_(x.base,z.key),value:Po(z.value)}))):Promise.all(x.items.map(M=>Lt(x.driver.getItem,M.relativeKey,M.options).then(z=>({key:M.key,value:Po(z)})))))},getItemRaw(y,_={}){y=ur(y);const{relativeKey:x,driver:M}=r(y);return M.getItemRaw?Lt(M.getItemRaw,x,_):Lt(M.getItem,x,_).then(z=>__(z))},async setItem(y,_,x={}){if(_===void 0)return v.removeItem(y);y=ur(y);const{relativeKey:M,driver:z}=r(y);z.setItem&&(await Lt(z.setItem,M,Do(_),x),z.watch||a("update",y))},async setItems(y,_){await g(y,_,async x=>{if(x.driver.setItems)return Lt(x.driver.setItems,x.items.map(M=>({key:M.relativeKey,value:Do(M.value),options:M.options})),_);x.driver.setItem&&await Promise.all(x.items.map(M=>Lt(x.driver.setItem,M.relativeKey,Do(M.value),M.options)))})},async setItemRaw(y,_,x={}){if(_===void 0)return v.removeItem(y,x);y=ur(y);const{relativeKey:M,driver:z}=r(y);if(z.setItemRaw)await Lt(z.setItemRaw,M,_,x);else if(z.setItem)await Lt(z.setItem,M,b_(_),x);else return;z.watch||a("update",y)},async removeItem(y,_={}){typeof _=="boolean"&&(_={removeMeta:_}),y=ur(y);const{relativeKey:x,driver:M}=r(y);M.removeItem&&(await Lt(M.removeItem,x,_),(_.removeMeta||_.removeMata)&&await Lt(M.removeItem,x+"$",_),M.watch||a("remove",y))},async getMeta(y,_={}){typeof _=="boolean"&&(_={nativeOnly:_}),y=ur(y);const{relativeKey:x,driver:M}=r(y),z=Object.create(null);if(M.getMeta&&Object.assign(z,await Lt(M.getMeta,x,_)),!_.nativeOnly){const T=await Lt(M.getItem,x+"$",_).then(re=>Po(re));T&&typeof T=="object"&&(typeof T.atime=="string"&&(T.atime=new Date(T.atime)),typeof T.mtime=="string"&&(T.mtime=new Date(T.mtime)),Object.assign(z,T))}return z},setMeta(y,_,x={}){return this.setItem(y+"$",_,x)},removeMeta(y,_={}){return this.removeItem(y+"$",_)},async getKeys(y,_={}){y=Oo(y);const x=s(y,!0);let M=[];const z=[];for(const T of x){const ae=(await Lt(T.driver.getKeys,T.relativeBase,_)).map(ce=>T.mountpoint+ur(ce)).filter(ce=>!M.some(A=>ce.startsWith(A)));z.push(...ae),M=[T.mountpoint,...M.filter(ce=>!ce.startsWith(T.mountpoint))]}return y?z.filter(T=>T.startsWith(y)&&!T.endsWith("$")):z.filter(T=>!T.endsWith("$"))},async clear(y,_={}){y=Oo(y),await Promise.all(s(y,!1).map(async x=>{if(x.driver.clear)return Lt(x.driver.clear,x.relativeBase,_);if(x.driver.removeItem){const M=await x.driver.getKeys(x.relativeBase||"",_);return Promise.all(M.map(z=>x.driver.removeItem(z,_)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(y=>$l(y)))},async watch(y){return await u(),t.watchListeners.push(y),async()=>{t.watchListeners=t.watchListeners.filter(_=>_!==y),t.watchListeners.length===0&&await f()}},async unwatch(){t.watchListeners=[],await f()},mount(y,_){if(y=Oo(y),y&&t.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(t.mountpoints.push(y),t.mountpoints.sort((x,M)=>M.length-x.length)),t.mounts[y]=_,t.watching&&Promise.resolve(Cl(_,a,y)).then(x=>{t.unwatch[y]=x}).catch(console.error),v},async unmount(y,_=!0){y=Oo(y),!(!y||!t.mounts[y])&&(t.watching&&y in t.unwatch&&(t.unwatch[y](),delete t.unwatch[y]),_&&await $l(t.mounts[y]),t.mountpoints=t.mountpoints.filter(x=>x!==y),delete t.mounts[y])},getMount(y=""){y=ur(y)+":";const _=r(y);return{driver:_.driver,base:_.base}},getMounts(y="",_={}){return y=ur(y),s(y,_.parents).map(M=>({driver:M.driver,base:M.mountpoint}))}};return v}function Cl(n,t,r){return n.watch?n.watch((s,a)=>t(s,r+a)):()=>{}}async function $l(n){typeof n.dispose=="function"&&await Lt(n.dispose)}function Xi(n){return new Promise((t,r)=>{n.oncomplete=n.onsuccess=()=>t(n.result),n.onabort=n.onerror=()=>r(n.error)})}function Xf(n,t){const r=indexedDB.open(n);r.onupgradeneeded=()=>r.result.createObjectStore(t);const s=Xi(r);return(a,u)=>s.then(f=>u(f.transaction(t,a).objectStore(t)))}let Ec;function ys(){return Ec||(Ec=Xf("keyval-store","keyval")),Ec}function Dl(n,t=ys()){return t("readonly",r=>Xi(r.get(n)))}function P_(n,t,r=ys()){return r("readwrite",s=>(s.put(t,n),Xi(s.transaction)))}function O_(n,t=ys()){return t("readwrite",r=>(r.delete(n),Xi(r.transaction)))}function R_(n=ys()){return n("readwrite",t=>(t.clear(),Xi(t.transaction)))}function A_(n,t){return n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Xi(n.transaction)}function T_(n=ys()){return n("readonly",t=>{if(t.getAllKeys)return Xi(t.getAllKeys());const r=[];return A_(t,s=>r.push(s.key)).then(()=>r)})}const N_=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),C_=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function ms(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return C_(n)}catch{return n}}function Qi(n){return typeof n=="string"?n:N_(n)||""}const $_="idb-keyval";var D_=(n={})=>{const t=n.base&&n.base.length>0?`${n.base}:`:"",r=a=>t+a;let s;return n.dbName&&n.storeName&&(s=Xf(n.dbName,n.storeName)),{name:$_,options:n,async hasItem(a){return!(typeof await Dl(r(a),s)>"u")},async getItem(a){return await Dl(r(a),s)??null},setItem(a,u){return P_(r(a),u,s)},removeItem(a){return O_(r(a),s)},getKeys(){return T_(s)},clear(){return R_(s)}}};const j_="WALLET_CONNECT_V2_INDEXED_DB",M_="keyvaluestorage";let L_=class{constructor(){this.indexedDb=S_({driver:D_({dbName:j_,storeName:M_})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Qi(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var Ic=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},jo={exports:{}};(function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ic<"u"&&Ic.localStorage?jo.exports=Ic.localStorage:typeof window<"u"&&window.localStorage?jo.exports=window.localStorage:jo.exports=new t})();function U_(n){var t;return[n[0],ms((t=n[1])!=null?t:"")]}class q_{constructor(){this.localStorage=jo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(U_)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return ms(r)}async setItem(t,r){this.localStorage.setItem(t,Qi(r))}async removeItem(t){this.localStorage.removeItem(t)}}const z_="wc_storage_version",jl=1,k_=async(n,t,r)=>{const s=z_,a=await t.getItem(s);if(a&&a>=jl){r(t);return}const u=await n.getKeys();if(!u.length){r(t);return}const f=[];for(;u.length;){const g=u.shift();if(!g)continue;const v=g.toLowerCase();if(v.includes("wc@")||v.includes("walletconnect")||v.includes("wc_")||v.includes("wallet_connect")){const y=await n.getItem(g);await t.setItem(g,y),f.push(g)}}await t.setItem(s,jl),r(t),H_(n,f)},H_=async(n,t)=>{t.length&&t.forEach(async r=>{await n.removeItem(r)})};let K_=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new q_;this.storage=t;try{const r=new L_;k_(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var Cn={},Xn={},xc={},Zn={};let Zi=class{};const B_=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Zi},Symbol.toStringTag,{value:"Module"})),F_=Tw(B_);var Ml;function V_(){if(Ml)return Zn;Ml=1,Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.IHeartBeat=void 0;const n=F_;class t extends n.IEvents{constructor(s){super()}}return Zn.IHeartBeat=t,Zn}var Ll;function Zf(){return Ll||(Ll=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ds.__exportStar(V_(),n)}(xc)),xc}var Sc={},Gi={},Ul;function W_(){if(Ul)return Gi;Ul=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.HEARTBEAT_EVENTS=Gi.HEARTBEAT_INTERVAL=void 0;const n=oe;return Gi.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Gi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Gi}var ql;function ed(){return ql||(ql=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ds.__exportStar(W_(),n)}(Sc)),Sc}var zl;function G_(){if(zl)return Xn;zl=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.HeartBeat=void 0;const n=ds,t=Cr,r=oe,s=Zf(),a=ed();class u extends s.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||a.HEARTBEAT_INTERVAL}static init(g){return n.__awaiter(this,void 0,void 0,function*(){const v=new u(g);return yield v.init(),v})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,v){this.events.on(g,v)}once(g,v){this.events.once(g,v)}off(g,v){this.events.off(g,v)}removeListener(g,v){this.events.removeListener(g,v)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Xn.HeartBeat=u,Xn}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=ds;t.__exportStar(G_(),n),t.__exportStar(Zf(),n),t.__exportStar(ed(),n)})(Cn);function J_(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}var Q_=Y_;function Y_(n,t,r){var s=r&&r.stringify||J_,a=1;if(typeof n=="object"&&n!==null){var u=t.length+a;if(u===1)return n;var f=new Array(u);f[0]=s(n);for(var g=1;g<u;g++)f[g]=s(t[g]);return f.join(" ")}if(typeof n!="string")return n;var v=t.length;if(v===0)return n;for(var y="",_=1-a,x=-1,M=n&&n.length||0,z=0;z<M;){if(n.charCodeAt(z)===37&&z+1<M){switch(x=x>-1?x:0,n.charCodeAt(z+1)){case 100:case 102:if(_>=v||t[_]==null)break;x<z&&(y+=n.slice(x,z)),y+=Number(t[_]),x=z+2,z++;break;case 105:if(_>=v||t[_]==null)break;x<z&&(y+=n.slice(x,z)),y+=Math.floor(Number(t[_])),x=z+2,z++;break;case 79:case 111:case 106:if(_>=v||t[_]===void 0)break;x<z&&(y+=n.slice(x,z));var T=typeof t[_];if(T==="string"){y+="'"+t[_]+"'",x=z+2,z++;break}if(T==="function"){y+=t[_].name||"<anonymous>",x=z+2,z++;break}y+=s(t[_]),x=z+2,z++;break;case 115:if(_>=v)break;x<z&&(y+=n.slice(x,z)),y+=String(t[_]),x=z+2,z++;break;case 37:x<z&&(y+=n.slice(x,z)),y+="%",x=z+2,z++,_--;break}++_}++z}return x===-1?n:(x<M&&(y+=n.slice(x)),y)}const kl=Q_;var X_=Yr;const ls=c1().console||{},Z_={mapHttpRequest:Ro,mapHttpResponse:Ro,wrapRequestSerializer:Pc,wrapResponseSerializer:Pc,wrapErrorSerializer:Pc,req:Ro,res:Ro,err:n1};function e1(n,t){return Array.isArray(n)?n.filter(function(s){return s!=="!stdSerializers.err"}):n===!0?Object.keys(t):!1}function Yr(n){n=n||{},n.browser=n.browser||{};const t=n.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=n.browser.write||ls;n.browser.write&&(n.browser.asObject=!0);const s=n.serializers||{},a=e1(n.browser.serialize,s);let u=n.browser.serialize;Array.isArray(n.browser.serialize)&&n.browser.serialize.indexOf("!stdSerializers.err")>-1&&(u=!1);const f=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),n.enabled===!1&&(n.level="silent");const g=n.level||"info",v=Object.create(r);v.log||(v.log=fs),Object.defineProperty(v,"levelVal",{get:_}),Object.defineProperty(v,"level",{get:x,set:M});const y={transmit:t,serialize:a,asObject:n.browser.asObject,levels:f,timestamp:s1(n)};v.levels=Yr.levels,v.level=g,v.setMaxListeners=v.getMaxListeners=v.emit=v.addListener=v.on=v.prependListener=v.once=v.prependOnceListener=v.removeListener=v.removeAllListeners=v.listeners=v.listenerCount=v.eventNames=v.write=v.flush=fs,v.serializers=s,v._serialize=a,v._stdErrSerialize=u,v.child=z,t&&(v._logEvent=Hc());function _(){return this.level==="silent"?1/0:this.levels.values[this.level]}function x(){return this._level}function M(T){if(T!=="silent"&&!this.levels.values[T])throw Error("unknown level "+T);this._level=T,En(y,v,"error","log"),En(y,v,"fatal","error"),En(y,v,"warn","error"),En(y,v,"info","log"),En(y,v,"debug","log"),En(y,v,"trace","log")}function z(T,re){if(!T)throw new Error("missing bindings for child Pino");re=re||{},a&&T.serializers&&(re.serializers=T.serializers);const ae=re.serializers;if(a&&ae){var ce=Object.assign({},s,ae),A=n.browser.serialize===!0?Object.keys(ce):a;delete T.serializers,Ho([T],A,ce,this._stdErrSerialize)}function $(j){this._childLevel=(j._childLevel|0)+1,this.error=In(j,T,"error"),this.fatal=In(j,T,"fatal"),this.warn=In(j,T,"warn"),this.info=In(j,T,"info"),this.debug=In(j,T,"debug"),this.trace=In(j,T,"trace"),ce&&(this.serializers=ce,this._serialize=A),t&&(this._logEvent=Hc([].concat(j._logEvent.bindings,T)))}return $.prototype=this,new $(this)}return v}Yr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Yr.stdSerializers=Z_;Yr.stdTimeFunctions=Object.assign({},{nullTime:td,epochTime:rd,unixTime:o1,isoTime:a1});function En(n,t,r,s){const a=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?fs:a[r]?a[r]:ls[r]||ls[s]||fs,t1(n,t,r)}function t1(n,t,r){!n.transmit&&t[r]===fs||(t[r]=function(s){return function(){const u=n.timestamp(),f=new Array(arguments.length),g=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ls?ls:this;for(var v=0;v<f.length;v++)f[v]=arguments[v];if(n.serialize&&!n.asObject&&Ho(f,this._serialize,this.serializers,this._stdErrSerialize),n.asObject?s.call(g,r1(this,r,f,u)):s.apply(g,f),n.transmit){const y=n.transmit.level||t.level,_=Yr.levels.values[y],x=Yr.levels.values[r];if(x<_)return;i1(this,{ts:u,methodLevel:r,methodValue:x,transmitLevel:y,transmitValue:Yr.levels.values[n.transmit.level||t.level],send:n.transmit.send,val:t.levelVal},f)}}}(t[r]))}function r1(n,t,r,s){n._serialize&&Ho(r,n._serialize,n.serializers,n._stdErrSerialize);const a=r.slice();let u=a[0];const f={};s&&(f.time=s),f.level=Yr.levels.values[t];let g=(n._childLevel|0)+1;if(g<1&&(g=1),u!==null&&typeof u=="object"){for(;g--&&typeof a[0]=="object";)Object.assign(f,a.shift());u=a.length?kl(a.shift(),a):void 0}else typeof u=="string"&&(u=kl(a.shift(),a));return u!==void 0&&(f.msg=u),f}function Ho(n,t,r,s){for(const a in n)if(s&&n[a]instanceof Error)n[a]=Yr.stdSerializers.err(n[a]);else if(typeof n[a]=="object"&&!Array.isArray(n[a]))for(const u in n[a])t&&t.indexOf(u)>-1&&u in r&&(n[a][u]=r[u](n[a][u]))}function In(n,t,r){return function(){const s=new Array(1+arguments.length);s[0]=t;for(var a=1;a<s.length;a++)s[a]=arguments[a-1];return n[r].apply(this,s)}}function i1(n,t,r){const s=t.send,a=t.ts,u=t.methodLevel,f=t.methodValue,g=t.val,v=n._logEvent.bindings;Ho(r,n._serialize||Object.keys(n.serializers),n.serializers,n._stdErrSerialize===void 0?!0:n._stdErrSerialize),n._logEvent.ts=a,n._logEvent.messages=r.filter(function(y){return v.indexOf(y)===-1}),n._logEvent.level.label=u,n._logEvent.level.value=f,s(u,n._logEvent,g),n._logEvent=Hc(v)}function Hc(n){return{ts:0,messages:[],bindings:n||[],level:{label:"",value:0}}}function n1(n){const t={type:n.constructor.name,msg:n.message,stack:n.stack};for(const r in n)t[r]===void 0&&(t[r]=n[r]);return t}function s1(n){return typeof n.timestamp=="function"?n.timestamp:n.timestamp===!1?td:rd}function Ro(){return{}}function Pc(n){return n}function fs(){}function td(){return!1}function rd(){return Date.now()}function o1(){return Math.round(Date.now()/1e3)}function a1(){return new Date(Date.now()).toISOString()}function c1(){function n(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return n(self)||n(window)||n(this)||{}}}const Ko=Yc(X_),u1={level:"info"},vs="custom_context";var h1=Object.defineProperty,l1=Object.defineProperties,f1=Object.getOwnPropertyDescriptors,Hl=Object.getOwnPropertySymbols,d1=Object.prototype.hasOwnProperty,p1=Object.prototype.propertyIsEnumerable,Kl=(n,t,r)=>t in n?h1(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,g1=(n,t)=>{for(var r in t||(t={}))d1.call(t,r)&&Kl(n,r,t[r]);if(Hl)for(var r of Hl(t))p1.call(t,r)&&Kl(n,r,t[r]);return n},y1=(n,t)=>l1(n,f1(t));function Bo(n){return y1(g1({},n),{level:(n==null?void 0:n.level)||u1.level})}function m1(n,t=vs){return n[t]||""}function v1(n,t,r=vs){return n[r]=t,n}function dr(n,t=vs){let r="";return typeof n.bindings>"u"?r=m1(n,t):r=n.bindings().context||"",r}function w1(n,t,r=vs){const s=dr(n,r);return s.trim()?`${s}/${t}`:t}function _r(n,t,r=vs){const s=w1(n,t,r),a=n.child({context:s});return v1(a,s,r)}class b1 extends Zi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let _1=class extends Zi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},E1=class{constructor(t,r){this.logger=t,this.core=r}},I1=class extends Zi{constructor(t,r){super(),this.relayer=t,this.logger=r}},x1=class extends Zi{constructor(t){super()}},S1=class{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}};class P1 extends Zi{constructor(t,r){super(),this.relayer=t,this.logger=r}}let O1=class extends Zi{constructor(t,r){super(),this.core=t,this.logger=r}},R1=class{constructor(t,r){this.projectId=t,this.logger=r}},A1=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},T1=class{constructor(t){this.client=t}};var su={},id={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Nw,r=Lf;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function g(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},g.prototype.update=function(v,y){if(y===void 0&&(y=v.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var _=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=v[_++],y--;this._bufferLength===this.blockSize&&(u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(_=u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,v,_,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=v[_++],y--;return this},g.prototype.finish=function(v){if(!this._finished){var y=this._bytesHashed,_=this._bufferLength,x=y/536870912|0,M=y<<3,z=y%128<112?128:256;this._buffer[_]=128;for(var T=_+1;T<z-8;T++)this._buffer[T]=0;t.writeUint32BE(x,this._buffer,z-8),t.writeUint32BE(M,this._buffer,z-4),u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,z),this._finished=!0}for(var T=0;T<this.digestLength/8;T++)t.writeUint32BE(this._stateHi[T],v,T*8),t.writeUint32BE(this._stateLo[T],v,T*8+4);return this},g.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(v){return this._stateHi.set(v.stateHi),this._stateLo.set(v.stateLo),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(v){r.wipe(v.stateHi),r.wipe(v.stateLo),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},g}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function u(g,v,y,_,x,M,z){for(var T=y[0],re=y[1],ae=y[2],ce=y[3],A=y[4],$=y[5],j=y[6],U=y[7],B=_[0],W=_[1],J=_[2],Oe=_[3],Qe=_[4],Be=_[5],qt=_[6],zt=_[7],b,O,ie,de,G,V,Q,Y;z>=128;){for(var tt=0;tt<16;tt++){var ot=8*tt+M;g[tt]=t.readUint32BE(x,ot),v[tt]=t.readUint32BE(x,ot+4)}for(var tt=0;tt<80;tt++){var $i=T,Ee=re,$r=ae,L=ce,D=A,N=$,h=j,I=U,ne=B,fe=W,ve=J,Re=Oe,Te=Qe,Ie=Be,_t=qt,gt=zt;if(b=U,O=zt,G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=(A>>>14|Qe<<18)^(A>>>18|Qe<<14)^(Qe>>>9|A<<23),O=(Qe>>>14|A<<18)^(Qe>>>18|A<<14)^(A>>>9|Qe<<23),G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,b=A&$^~A&j,O=Qe&Be^~Qe&qt,G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,b=a[tt*2],O=a[tt*2+1],G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,b=g[tt%16],O=v[tt%16],G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,ie=Q&65535|Y<<16,de=G&65535|V<<16,b=ie,O=de,G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=(T>>>28|B<<4)^(B>>>2|T<<30)^(B>>>7|T<<25),O=(B>>>28|T<<4)^(T>>>2|B<<30)^(T>>>7|B<<25),G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,b=T&re^T&ae^re&ae,O=B&W^B&J^W&J,G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,I=Q&65535|Y<<16,gt=G&65535|V<<16,b=L,O=Re,G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=ie,O=de,G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,L=Q&65535|Y<<16,Re=G&65535|V<<16,re=$i,ae=Ee,ce=$r,A=L,$=D,j=N,U=h,T=I,W=ne,J=fe,Oe=ve,Qe=Re,Be=Te,qt=Ie,zt=_t,B=gt,tt%16===15)for(var ot=0;ot<16;ot++)b=g[ot],O=v[ot],G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=g[(ot+9)%16],O=v[(ot+9)%16],G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,ie=g[(ot+1)%16],de=v[(ot+1)%16],b=(ie>>>1|de<<31)^(ie>>>8|de<<24)^ie>>>7,O=(de>>>1|ie<<31)^(de>>>8|ie<<24)^(de>>>7|ie<<25),G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,ie=g[(ot+14)%16],de=v[(ot+14)%16],b=(ie>>>19|de<<13)^(de>>>29|ie<<3)^ie>>>6,O=(de>>>19|ie<<13)^(ie>>>29|de<<3)^(de>>>6|ie<<26),G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,g[ot]=Q&65535|Y<<16,v[ot]=G&65535|V<<16}b=T,O=B,G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=y[0],O=_[0],G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,y[0]=T=Q&65535|Y<<16,_[0]=B=G&65535|V<<16,b=re,O=W,G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=y[1],O=_[1],G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,y[1]=re=Q&65535|Y<<16,_[1]=W=G&65535|V<<16,b=ae,O=J,G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=y[2],O=_[2],G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,y[2]=ae=Q&65535|Y<<16,_[2]=J=G&65535|V<<16,b=ce,O=Oe,G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=y[3],O=_[3],G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,y[3]=ce=Q&65535|Y<<16,_[3]=Oe=G&65535|V<<16,b=A,O=Qe,G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=y[4],O=_[4],G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,y[4]=A=Q&65535|Y<<16,_[4]=Qe=G&65535|V<<16,b=$,O=Be,G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=y[5],O=_[5],G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,y[5]=$=Q&65535|Y<<16,_[5]=Be=G&65535|V<<16,b=j,O=qt,G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=y[6],O=_[6],G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,y[6]=j=Q&65535|Y<<16,_[6]=qt=G&65535|V<<16,b=U,O=zt,G=O&65535,V=O>>>16,Q=b&65535,Y=b>>>16,b=y[7],O=_[7],G+=O&65535,V+=O>>>16,Q+=b&65535,Y+=b>>>16,V+=G>>>16,Q+=V>>>16,Y+=Q>>>16,y[7]=U=Q&65535|Y<<16,_[7]=zt=G&65535|V<<16,M+=128,z-=128}return M}function f(g){var v=new s;v.update(g);var y=v.digest();return v.clean(),y}n.hash=f})(id);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=ko,r=id,s=Lf;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(L){const D=new Float64Array(16);if(L)for(let N=0;N<L.length;N++)D[N]=L[N];return D}const u=new Uint8Array(32);u[0]=9;const f=a(),g=a([1]),v=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),_=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),x=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),M=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function z(L,D){for(let N=0;N<16;N++)L[N]=D[N]|0}function T(L){let D=1;for(let N=0;N<16;N++){let h=L[N]+D+65535;D=Math.floor(h/65536),L[N]=h-D*65536}L[0]+=D-1+37*(D-1)}function re(L,D,N){const h=~(N-1);for(let I=0;I<16;I++){const ne=h&(L[I]^D[I]);L[I]^=ne,D[I]^=ne}}function ae(L,D){const N=a(),h=a();for(let I=0;I<16;I++)h[I]=D[I];T(h),T(h),T(h);for(let I=0;I<2;I++){N[0]=h[0]-65517;for(let fe=1;fe<15;fe++)N[fe]=h[fe]-65535-(N[fe-1]>>16&1),N[fe-1]&=65535;N[15]=h[15]-32767-(N[14]>>16&1);const ne=N[15]>>16&1;N[14]&=65535,re(h,N,1-ne)}for(let I=0;I<16;I++)L[2*I]=h[I]&255,L[2*I+1]=h[I]>>8}function ce(L,D){let N=0;for(let h=0;h<32;h++)N|=L[h]^D[h];return(1&N-1>>>8)-1}function A(L,D){const N=new Uint8Array(32),h=new Uint8Array(32);return ae(N,L),ae(h,D),ce(N,h)}function $(L){const D=new Uint8Array(32);return ae(D,L),D[0]&1}function j(L,D){for(let N=0;N<16;N++)L[N]=D[2*N]+(D[2*N+1]<<8);L[15]&=32767}function U(L,D,N){for(let h=0;h<16;h++)L[h]=D[h]+N[h]}function B(L,D,N){for(let h=0;h<16;h++)L[h]=D[h]-N[h]}function W(L,D,N){let h,I,ne=0,fe=0,ve=0,Re=0,Te=0,Ie=0,_t=0,gt=0,rt=0,Ce=0,Fe=0,Ve=0,it=0,Me=0,We=0,Ae=0,Ue=0,at=0,De=0,Et=0,Nt=0,kt=0,Ht=0,Dt=0,Gt=0,rr=0,Br=0,Jt=0,Zr=0,vi=0,Di=0,ct=N[0],Ye=N[1],ut=N[2],ht=N[3],nt=N[4],Xe=N[5],It=N[6],xt=N[7],lt=N[8],St=N[9],ft=N[10],yt=N[11],dt=N[12],Ke=N[13],Pt=N[14],Ot=N[15];h=D[0],ne+=h*ct,fe+=h*Ye,ve+=h*ut,Re+=h*ht,Te+=h*nt,Ie+=h*Xe,_t+=h*It,gt+=h*xt,rt+=h*lt,Ce+=h*St,Fe+=h*ft,Ve+=h*yt,it+=h*dt,Me+=h*Ke,We+=h*Pt,Ae+=h*Ot,h=D[1],fe+=h*ct,ve+=h*Ye,Re+=h*ut,Te+=h*ht,Ie+=h*nt,_t+=h*Xe,gt+=h*It,rt+=h*xt,Ce+=h*lt,Fe+=h*St,Ve+=h*ft,it+=h*yt,Me+=h*dt,We+=h*Ke,Ae+=h*Pt,Ue+=h*Ot,h=D[2],ve+=h*ct,Re+=h*Ye,Te+=h*ut,Ie+=h*ht,_t+=h*nt,gt+=h*Xe,rt+=h*It,Ce+=h*xt,Fe+=h*lt,Ve+=h*St,it+=h*ft,Me+=h*yt,We+=h*dt,Ae+=h*Ke,Ue+=h*Pt,at+=h*Ot,h=D[3],Re+=h*ct,Te+=h*Ye,Ie+=h*ut,_t+=h*ht,gt+=h*nt,rt+=h*Xe,Ce+=h*It,Fe+=h*xt,Ve+=h*lt,it+=h*St,Me+=h*ft,We+=h*yt,Ae+=h*dt,Ue+=h*Ke,at+=h*Pt,De+=h*Ot,h=D[4],Te+=h*ct,Ie+=h*Ye,_t+=h*ut,gt+=h*ht,rt+=h*nt,Ce+=h*Xe,Fe+=h*It,Ve+=h*xt,it+=h*lt,Me+=h*St,We+=h*ft,Ae+=h*yt,Ue+=h*dt,at+=h*Ke,De+=h*Pt,Et+=h*Ot,h=D[5],Ie+=h*ct,_t+=h*Ye,gt+=h*ut,rt+=h*ht,Ce+=h*nt,Fe+=h*Xe,Ve+=h*It,it+=h*xt,Me+=h*lt,We+=h*St,Ae+=h*ft,Ue+=h*yt,at+=h*dt,De+=h*Ke,Et+=h*Pt,Nt+=h*Ot,h=D[6],_t+=h*ct,gt+=h*Ye,rt+=h*ut,Ce+=h*ht,Fe+=h*nt,Ve+=h*Xe,it+=h*It,Me+=h*xt,We+=h*lt,Ae+=h*St,Ue+=h*ft,at+=h*yt,De+=h*dt,Et+=h*Ke,Nt+=h*Pt,kt+=h*Ot,h=D[7],gt+=h*ct,rt+=h*Ye,Ce+=h*ut,Fe+=h*ht,Ve+=h*nt,it+=h*Xe,Me+=h*It,We+=h*xt,Ae+=h*lt,Ue+=h*St,at+=h*ft,De+=h*yt,Et+=h*dt,Nt+=h*Ke,kt+=h*Pt,Ht+=h*Ot,h=D[8],rt+=h*ct,Ce+=h*Ye,Fe+=h*ut,Ve+=h*ht,it+=h*nt,Me+=h*Xe,We+=h*It,Ae+=h*xt,Ue+=h*lt,at+=h*St,De+=h*ft,Et+=h*yt,Nt+=h*dt,kt+=h*Ke,Ht+=h*Pt,Dt+=h*Ot,h=D[9],Ce+=h*ct,Fe+=h*Ye,Ve+=h*ut,it+=h*ht,Me+=h*nt,We+=h*Xe,Ae+=h*It,Ue+=h*xt,at+=h*lt,De+=h*St,Et+=h*ft,Nt+=h*yt,kt+=h*dt,Ht+=h*Ke,Dt+=h*Pt,Gt+=h*Ot,h=D[10],Fe+=h*ct,Ve+=h*Ye,it+=h*ut,Me+=h*ht,We+=h*nt,Ae+=h*Xe,Ue+=h*It,at+=h*xt,De+=h*lt,Et+=h*St,Nt+=h*ft,kt+=h*yt,Ht+=h*dt,Dt+=h*Ke,Gt+=h*Pt,rr+=h*Ot,h=D[11],Ve+=h*ct,it+=h*Ye,Me+=h*ut,We+=h*ht,Ae+=h*nt,Ue+=h*Xe,at+=h*It,De+=h*xt,Et+=h*lt,Nt+=h*St,kt+=h*ft,Ht+=h*yt,Dt+=h*dt,Gt+=h*Ke,rr+=h*Pt,Br+=h*Ot,h=D[12],it+=h*ct,Me+=h*Ye,We+=h*ut,Ae+=h*ht,Ue+=h*nt,at+=h*Xe,De+=h*It,Et+=h*xt,Nt+=h*lt,kt+=h*St,Ht+=h*ft,Dt+=h*yt,Gt+=h*dt,rr+=h*Ke,Br+=h*Pt,Jt+=h*Ot,h=D[13],Me+=h*ct,We+=h*Ye,Ae+=h*ut,Ue+=h*ht,at+=h*nt,De+=h*Xe,Et+=h*It,Nt+=h*xt,kt+=h*lt,Ht+=h*St,Dt+=h*ft,Gt+=h*yt,rr+=h*dt,Br+=h*Ke,Jt+=h*Pt,Zr+=h*Ot,h=D[14],We+=h*ct,Ae+=h*Ye,Ue+=h*ut,at+=h*ht,De+=h*nt,Et+=h*Xe,Nt+=h*It,kt+=h*xt,Ht+=h*lt,Dt+=h*St,Gt+=h*ft,rr+=h*yt,Br+=h*dt,Jt+=h*Ke,Zr+=h*Pt,vi+=h*Ot,h=D[15],Ae+=h*ct,Ue+=h*Ye,at+=h*ut,De+=h*ht,Et+=h*nt,Nt+=h*Xe,kt+=h*It,Ht+=h*xt,Dt+=h*lt,Gt+=h*St,rr+=h*ft,Br+=h*yt,Jt+=h*dt,Zr+=h*Ke,vi+=h*Pt,Di+=h*Ot,ne+=38*Ue,fe+=38*at,ve+=38*De,Re+=38*Et,Te+=38*Nt,Ie+=38*kt,_t+=38*Ht,gt+=38*Dt,rt+=38*Gt,Ce+=38*rr,Fe+=38*Br,Ve+=38*Jt,it+=38*Zr,Me+=38*vi,We+=38*Di,I=1,h=ne+I+65535,I=Math.floor(h/65536),ne=h-I*65536,h=fe+I+65535,I=Math.floor(h/65536),fe=h-I*65536,h=ve+I+65535,I=Math.floor(h/65536),ve=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,h=Te+I+65535,I=Math.floor(h/65536),Te=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=_t+I+65535,I=Math.floor(h/65536),_t=h-I*65536,h=gt+I+65535,I=Math.floor(h/65536),gt=h-I*65536,h=rt+I+65535,I=Math.floor(h/65536),rt=h-I*65536,h=Ce+I+65535,I=Math.floor(h/65536),Ce=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=it+I+65535,I=Math.floor(h/65536),it=h-I*65536,h=Me+I+65535,I=Math.floor(h/65536),Me=h-I*65536,h=We+I+65535,I=Math.floor(h/65536),We=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,ne+=I-1+37*(I-1),I=1,h=ne+I+65535,I=Math.floor(h/65536),ne=h-I*65536,h=fe+I+65535,I=Math.floor(h/65536),fe=h-I*65536,h=ve+I+65535,I=Math.floor(h/65536),ve=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,h=Te+I+65535,I=Math.floor(h/65536),Te=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=_t+I+65535,I=Math.floor(h/65536),_t=h-I*65536,h=gt+I+65535,I=Math.floor(h/65536),gt=h-I*65536,h=rt+I+65535,I=Math.floor(h/65536),rt=h-I*65536,h=Ce+I+65535,I=Math.floor(h/65536),Ce=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=it+I+65535,I=Math.floor(h/65536),it=h-I*65536,h=Me+I+65535,I=Math.floor(h/65536),Me=h-I*65536,h=We+I+65535,I=Math.floor(h/65536),We=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,ne+=I-1+37*(I-1),L[0]=ne,L[1]=fe,L[2]=ve,L[3]=Re,L[4]=Te,L[5]=Ie,L[6]=_t,L[7]=gt,L[8]=rt,L[9]=Ce,L[10]=Fe,L[11]=Ve,L[12]=it,L[13]=Me,L[14]=We,L[15]=Ae}function J(L,D){W(L,D,D)}function Oe(L,D){const N=a();let h;for(h=0;h<16;h++)N[h]=D[h];for(h=253;h>=0;h--)J(N,N),h!==2&&h!==4&&W(N,N,D);for(h=0;h<16;h++)L[h]=N[h]}function Qe(L,D){const N=a();let h;for(h=0;h<16;h++)N[h]=D[h];for(h=250;h>=0;h--)J(N,N),h!==1&&W(N,N,D);for(h=0;h<16;h++)L[h]=N[h]}function Be(L,D){const N=a(),h=a(),I=a(),ne=a(),fe=a(),ve=a(),Re=a(),Te=a(),Ie=a();B(N,L[1],L[0]),B(Ie,D[1],D[0]),W(N,N,Ie),U(h,L[0],L[1]),U(Ie,D[0],D[1]),W(h,h,Ie),W(I,L[3],D[3]),W(I,I,y),W(ne,L[2],D[2]),U(ne,ne,ne),B(fe,h,N),B(ve,ne,I),U(Re,ne,I),U(Te,h,N),W(L[0],fe,ve),W(L[1],Te,Re),W(L[2],Re,ve),W(L[3],fe,Te)}function qt(L,D,N){for(let h=0;h<4;h++)re(L[h],D[h],N)}function zt(L,D){const N=a(),h=a(),I=a();Oe(I,D[2]),W(N,D[0],I),W(h,D[1],I),ae(L,h),L[31]^=$(N)<<7}function b(L,D,N){z(L[0],f),z(L[1],g),z(L[2],g),z(L[3],f);for(let h=255;h>=0;--h){const I=N[h/8|0]>>(h&7)&1;qt(L,D,I),Be(D,L),Be(L,L),qt(L,D,I)}}function O(L,D){const N=[a(),a(),a(),a()];z(N[0],_),z(N[1],x),z(N[2],g),W(N[3],_,x),b(L,N,D)}function ie(L){if(L.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const D=(0,r.hash)(L);D[0]&=248,D[31]&=127,D[31]|=64;const N=new Uint8Array(32),h=[a(),a(),a(),a()];O(h,D),zt(N,h);const I=new Uint8Array(64);return I.set(L),I.set(N,32),{publicKey:N,secretKey:I}}n.generateKeyPairFromSeed=ie;function de(L){const D=(0,t.randomBytes)(32,L),N=ie(D);return(0,s.wipe)(D),N}n.generateKeyPair=de;function G(L){if(L.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(L.subarray(32))}n.extractPublicKeyFromSecretKey=G;const V=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Q(L,D){let N,h,I,ne;for(h=63;h>=32;--h){for(N=0,I=h-32,ne=h-12;I<ne;++I)D[I]+=N-16*D[h]*V[I-(h-32)],N=Math.floor((D[I]+128)/256),D[I]-=N*256;D[I]+=N,D[h]=0}for(N=0,I=0;I<32;I++)D[I]+=N-(D[31]>>4)*V[I],N=D[I]>>8,D[I]&=255;for(I=0;I<32;I++)D[I]-=N*V[I];for(h=0;h<32;h++)D[h+1]+=D[h]>>8,L[h]=D[h]&255}function Y(L){const D=new Float64Array(64);for(let N=0;N<64;N++)D[N]=L[N];for(let N=0;N<64;N++)L[N]=0;Q(L,D)}function tt(L,D){const N=new Float64Array(64),h=[a(),a(),a(),a()],I=(0,r.hash)(L.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const ne=new Uint8Array(64);ne.set(I.subarray(32),32);const fe=new r.SHA512;fe.update(ne.subarray(32)),fe.update(D);const ve=fe.digest();fe.clean(),Y(ve),O(h,ve),zt(ne,h),fe.reset(),fe.update(ne.subarray(0,32)),fe.update(L.subarray(32)),fe.update(D);const Re=fe.digest();Y(Re);for(let Te=0;Te<32;Te++)N[Te]=ve[Te];for(let Te=0;Te<32;Te++)for(let Ie=0;Ie<32;Ie++)N[Te+Ie]+=Re[Te]*I[Ie];return Q(ne.subarray(32),N),ne}n.sign=tt;function ot(L,D){const N=a(),h=a(),I=a(),ne=a(),fe=a(),ve=a(),Re=a();return z(L[2],g),j(L[1],D),J(I,L[1]),W(ne,I,v),B(I,I,L[2]),U(ne,L[2],ne),J(fe,ne),J(ve,fe),W(Re,ve,fe),W(N,Re,I),W(N,N,ne),Qe(N,N),W(N,N,I),W(N,N,ne),W(N,N,ne),W(L[0],N,ne),J(h,L[0]),W(h,h,ne),A(h,I)&&W(L[0],L[0],M),J(h,L[0]),W(h,h,ne),A(h,I)?-1:($(L[0])===D[31]>>7&&B(L[0],f,L[0]),W(L[3],L[0],L[1]),0)}function $i(L,D,N){const h=new Uint8Array(32),I=[a(),a(),a(),a()],ne=[a(),a(),a(),a()];if(N.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ot(ne,L))return!1;const fe=new r.SHA512;fe.update(N.subarray(0,32)),fe.update(L),fe.update(D);const ve=fe.digest();return Y(ve),b(I,ne,ve),O(ne,N.subarray(32)),Be(I,ne),zt(h,I),!ce(N,h)}n.verify=$i;function Ee(L){let D=[a(),a(),a(),a()];if(ot(D,L))throw new Error("Ed25519: invalid public key");let N=a(),h=a(),I=D[1];U(N,g,I),B(h,g,I),Oe(h,h),W(N,N,h);let ne=new Uint8Array(32);return ae(ne,N),ne}n.convertPublicKeyToX25519=Ee;function $r(L){const D=(0,r.hash)(L.subarray(0,32));D[0]&=248,D[31]&=127,D[31]|=64;const N=new Uint8Array(D.subarray(0,32));return(0,s.wipe)(D),N}n.convertSecretKeyToX25519=$r})(su);const N1="EdDSA",C1="JWT",nd=".",sd="base64url",$1="utf8",D1="utf8",j1=":",M1="did",L1="key",Bl="base58btc",U1="z",q1="K36",z1=32;function Uo(n){return tr(fr(Qi(n),$1),sd)}function od(n){const t=fr(q1,Bl),r=U1+tr(Mc([t,n]),Bl);return[M1,L1,r].join(j1)}function k1(n){return tr(n,sd)}function H1(n){return fr([Uo(n.header),Uo(n.payload)].join(nd),D1)}function K1(n){return[Uo(n.header),Uo(n.payload),k1(n.signature)].join(nd)}function Fl(n=ko.randomBytes(z1)){return su.generateKeyPairFromSeed(n)}async function B1(n,t,r,s,a=oe.fromMiliseconds(Date.now())){const u={alg:N1,typ:C1},f=od(s.publicKey),g=a+r,v={iss:f,sub:n,aud:t,iat:a,exp:g},y=H1({header:u,payload:v}),_=su.sign(s.secretKey,y);return K1({header:u,payload:v,signature:_})}const F1="PARSE_ERROR",V1="INVALID_REQUEST",W1="METHOD_NOT_FOUND",G1="INVALID_PARAMS",ad="INTERNAL_ERROR",ou="SERVER_ERROR",J1=[-32700,-32600,-32601,-32602,-32603],cs={[F1]:{code:-32700,message:"Parse error"},[V1]:{code:-32600,message:"Invalid Request"},[W1]:{code:-32601,message:"Method not found"},[G1]:{code:-32602,message:"Invalid params"},[ad]:{code:-32603,message:"Internal error"},[ou]:{code:-32e3,message:"Server error"}},cd=ou;function Q1(n){return J1.includes(n)}function Vl(n){return Object.keys(cs).includes(n)?cs[n]:cs[cd]}function Y1(n){const t=Object.values(cs).find(r=>r.code===n);return t||cs[cd]}function ud(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var hd={},li={},Wl;function X1(){if(Wl)return li;Wl=1,Object.defineProperty(li,"__esModule",{value:!0}),li.isBrowserCryptoAvailable=li.getSubtleCrypto=li.getBrowerCrypto=void 0;function n(){return(Kr===null||Kr===void 0?void 0:Kr.crypto)||(Kr===null||Kr===void 0?void 0:Kr.msCrypto)||{}}li.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}li.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return li.isBrowserCryptoAvailable=r,li}var fi={},Gl;function Z1(){if(Gl)return fi;Gl=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.isBrowser=fi.isNode=fi.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}fi.isReactNative=n;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}fi.isNode=t;function r(){return!n()&&!t()}return fi.isBrowser=r,fi}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=ds;t.__exportStar(X1(),n),t.__exportStar(Z1(),n)})(hd);function au(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function ld(n=6){return BigInt(au(n))}function Rn(n,t,r){return{id:r||au(),jsonrpc:"2.0",method:n,params:t}}function cu(n,t){return{id:n,jsonrpc:"2.0",result:t}}function Fo(n,t,r){return{id:n,jsonrpc:"2.0",error:eE(t)}}function eE(n,t){return typeof n>"u"?Vl(ad):(typeof n=="string"&&(n=Object.assign(Object.assign({},Vl(ou)),{message:n})),Q1(n.code)&&(n=Y1(n.code)),n)}class tE{}class rE extends tE{constructor(){super()}}class iE extends rE{constructor(t){super()}}const nE="^https?:",sE="^wss?:";function oE(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function fd(n,t){const r=oE(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function Jl(n){return fd(n,nE)}function Ql(n){return fd(n,sE)}function aE(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function dd(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function uu(n){return dd(n)&&"method"in n}function Vo(n){return dd(n)&&(gi(n)||Hr(n))}function gi(n){return"result"in n}function Hr(n){return"error"in n}class yi extends iE{constructor(t){super(t),this.events=new Cr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Rn(t.method,t.params||[],t.id||ld().toString()),r)}async requestStrict(t,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(u){a(u)}this.events.on(`${t.id}`,u=>{Hr(u)?a(u.error):s(u.result)});try{await this.connection.send(t,r)}catch(u){a(u)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Vo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const cE=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),uE=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Yl=n=>n.split("?")[0],Xl=10,hE=cE();let lE=class{constructor(t){if(this.url=t,this.events=new Cr.EventEmitter,this.registering=!1,!Ql(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Qi(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!Ql(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),a(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const a=new URLSearchParams(t).get("origin"),u=hd.isReactNative()?{headers:{origin:a}}:{rejectUnauthorized:!aE(t)},f=new hE(t,[],u);uE()?f.onerror=g=>{const v=g;s(this.emitError(v.error))}:f.on("error",g=>{s(this.emitError(g))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ms(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),u=Fo(t,a);this.events.emit("payload",u)}parseError(t,r=this.url){return ud(t,Yl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Xl&&this.events.setMaxListeners(Xl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Yl(this.url)}`));return this.events.emit("register_error",r),r}};var qo={exports:{}};qo.exports;(function(n,t){var r=200,s="__lodash_hash_undefined__",a=1,u=2,f=9007199254740991,g="[object Arguments]",v="[object Array]",y="[object AsyncFunction]",_="[object Boolean]",x="[object Date]",M="[object Error]",z="[object Function]",T="[object GeneratorFunction]",re="[object Map]",ae="[object Number]",ce="[object Null]",A="[object Object]",$="[object Promise]",j="[object Proxy]",U="[object RegExp]",B="[object Set]",W="[object String]",J="[object Symbol]",Oe="[object Undefined]",Qe="[object WeakMap]",Be="[object ArrayBuffer]",qt="[object DataView]",zt="[object Float32Array]",b="[object Float64Array]",O="[object Int8Array]",ie="[object Int16Array]",de="[object Int32Array]",G="[object Uint8Array]",V="[object Uint8ClampedArray]",Q="[object Uint16Array]",Y="[object Uint32Array]",tt=/[\\^$.*+?()[\]{}|]/g,ot=/^\[object .+?Constructor\]$/,$i=/^(?:0|[1-9]\d*)$/,Ee={};Ee[zt]=Ee[b]=Ee[O]=Ee[ie]=Ee[de]=Ee[G]=Ee[V]=Ee[Q]=Ee[Y]=!0,Ee[g]=Ee[v]=Ee[Be]=Ee[_]=Ee[qt]=Ee[x]=Ee[M]=Ee[z]=Ee[re]=Ee[ae]=Ee[A]=Ee[U]=Ee[B]=Ee[W]=Ee[Qe]=!1;var $r=typeof Kr=="object"&&Kr&&Kr.Object===Object&&Kr,L=typeof self=="object"&&self&&self.Object===Object&&self,D=$r||L||Function("return this")(),N=t&&!t.nodeType&&t,h=N&&!0&&n&&!n.nodeType&&n,I=h&&h.exports===N,ne=I&&$r.process,fe=function(){try{return ne&&ne.binding&&ne.binding("util")}catch{}}(),ve=fe&&fe.isTypedArray;function Re(m,S){for(var K=-1,ee=m==null?0:m.length,ze=0,ge=[];++K<ee;){var Ge=m[K];S(Ge,K,m)&&(ge[ze++]=Ge)}return ge}function Te(m,S){for(var K=-1,ee=S.length,ze=m.length;++K<ee;)m[ze+K]=S[K];return m}function Ie(m,S){for(var K=-1,ee=m==null?0:m.length;++K<ee;)if(S(m[K],K,m))return!0;return!1}function _t(m,S){for(var K=-1,ee=Array(m);++K<m;)ee[K]=S(K);return ee}function gt(m){return function(S){return m(S)}}function rt(m,S){return m.has(S)}function Ce(m,S){return m==null?void 0:m[S]}function Fe(m){var S=-1,K=Array(m.size);return m.forEach(function(ee,ze){K[++S]=[ze,ee]}),K}function Ve(m,S){return function(K){return m(S(K))}}function it(m){var S=-1,K=Array(m.size);return m.forEach(function(ee){K[++S]=ee}),K}var Me=Array.prototype,We=Function.prototype,Ae=Object.prototype,Ue=D["__core-js_shared__"],at=We.toString,De=Ae.hasOwnProperty,Et=function(){var m=/[^.]+$/.exec(Ue&&Ue.keys&&Ue.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Nt=Ae.toString,kt=RegExp("^"+at.call(De).replace(tt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=I?D.Buffer:void 0,Dt=D.Symbol,Gt=D.Uint8Array,rr=Ae.propertyIsEnumerable,Br=Me.splice,Jt=Dt?Dt.toStringTag:void 0,Zr=Object.getOwnPropertySymbols,vi=Ht?Ht.isBuffer:void 0,Di=Ve(Object.keys,Object),ct=pr(D,"DataView"),Ye=pr(D,"Map"),ut=pr(D,"Promise"),ht=pr(D,"Set"),nt=pr(D,"WeakMap"),Xe=pr(Object,"create"),It=ti(ct),xt=ti(Ye),lt=ti(ut),St=ti(ht),ft=ti(nt),yt=Dt?Dt.prototype:void 0,dt=yt?yt.valueOf:void 0;function Ke(m){var S=-1,K=m==null?0:m.length;for(this.clear();++S<K;){var ee=m[S];this.set(ee[0],ee[1])}}function Pt(){this.__data__=Xe?Xe(null):{},this.size=0}function Ot(m){var S=this.has(m)&&delete this.__data__[m];return this.size-=S?1:0,S}function Jo(m){var S=this.__data__;if(Xe){var K=S[m];return K===s?void 0:K}return De.call(S,m)?S[m]:void 0}function Qo(m){var S=this.__data__;return Xe?S[m]!==void 0:De.call(S,m)}function Yo(m,S){var K=this.__data__;return this.size+=this.has(m)?0:1,K[m]=Xe&&S===void 0?s:S,this}Ke.prototype.clear=Pt,Ke.prototype.delete=Ot,Ke.prototype.get=Jo,Ke.prototype.has=Qo,Ke.prototype.set=Yo;function Er(m){var S=-1,K=m==null?0:m.length;for(this.clear();++S<K;){var ee=m[S];this.set(ee[0],ee[1])}}function Xo(){this.__data__=[],this.size=0}function Zo(m){var S=this.__data__,K=ji(S,m);if(K<0)return!1;var ee=S.length-1;return K==ee?S.pop():Br.call(S,K,1),--this.size,!0}function ea(m){var S=this.__data__,K=ji(S,m);return K<0?void 0:S[K][1]}function ta(m){return ji(this.__data__,m)>-1}function ra(m,S){var K=this.__data__,ee=ji(K,m);return ee<0?(++this.size,K.push([m,S])):K[ee][1]=S,this}Er.prototype.clear=Xo,Er.prototype.delete=Zo,Er.prototype.get=ea,Er.prototype.has=ta,Er.prototype.set=ra;function ei(m){var S=-1,K=m==null?0:m.length;for(this.clear();++S<K;){var ee=m[S];this.set(ee[0],ee[1])}}function tn(){this.size=0,this.__data__={hash:new Ke,map:new(Ye||Er),string:new Ke}}function ia(m){var S=wi(this,m).delete(m);return this.size-=S?1:0,S}function rn(m){return wi(this,m).get(m)}function na(m){return wi(this,m).has(m)}function sa(m,S){var K=wi(this,m),ee=K.size;return K.set(m,S),this.size+=K.size==ee?0:1,this}ei.prototype.clear=tn,ei.prototype.delete=ia,ei.prototype.get=rn,ei.prototype.has=na,ei.prototype.set=sa;function nn(m){var S=-1,K=m==null?0:m.length;for(this.__data__=new ei;++S<K;)this.add(m[S])}function bs(m){return this.__data__.set(m,s),this}function _s(m){return this.__data__.has(m)}nn.prototype.add=nn.prototype.push=bs,nn.prototype.has=_s;function Dr(m){var S=this.__data__=new Er(m);this.size=S.size}function oa(){this.__data__=new Er,this.size=0}function aa(m){var S=this.__data__,K=S.delete(m);return this.size=S.size,K}function ca(m){return this.__data__.get(m)}function ua(m){return this.__data__.has(m)}function Es(m,S){var K=this.__data__;if(K instanceof Er){var ee=K.__data__;if(!Ye||ee.length<r-1)return ee.push([m,S]),this.size=++K.size,this;K=this.__data__=new ei(ee)}return K.set(m,S),this.size=K.size,this}Dr.prototype.clear=oa,Dr.prototype.delete=aa,Dr.prototype.get=ca,Dr.prototype.has=ua,Dr.prototype.set=Es;function Is(m,S){var K=an(m),ee=!K&&js(m),ze=!K&&!ee&&jn(m),ge=!K&&!ee&&!ze&&Us(m),Ge=K||ee||ze||ge,Rt=Ge?_t(m.length,String):[],Se=Rt.length;for(var ke in m)De.call(m,ke)&&!(Ge&&(ke=="length"||ze&&(ke=="offset"||ke=="parent")||ge&&(ke=="buffer"||ke=="byteLength"||ke=="byteOffset")||Ts(ke,Se)))&&Rt.push(ke);return Rt}function ji(m,S){for(var K=m.length;K--;)if(Ds(m[K][0],S))return K;return-1}function $n(m,S,K){var ee=S(m);return an(m)?ee:Te(ee,K(m))}function Mi(m){return m==null?m===void 0?Oe:ce:Jt&&Jt in Object(m)?Rs(m):fa(m)}function Dn(m){return Ui(m)&&Mi(m)==g}function Li(m,S,K,ee,ze){return m===S?!0:m==null||S==null||!Ui(m)&&!Ui(S)?m!==m&&S!==S:xs(m,S,K,ee,Li,ze)}function xs(m,S,K,ee,ze,ge){var Ge=an(m),Rt=an(S),Se=Ge?v:Fr(m),ke=Rt?v:Fr(S);Se=Se==g?A:Se,ke=ke==g?A:ke;var mt=Se==A,ir=ke==A,At=Se==ke;if(At&&jn(m)){if(!jn(S))return!1;Ge=!0,mt=!1}if(At&&!mt)return ge||(ge=new Dr),Ge||Us(m)?sn(m,S,K,ee,ze,ge):la(m,S,Se,K,ee,ze,ge);if(!(K&a)){var Je=mt&&De.call(m,"__wrapped__"),Qt=ir&&De.call(S,"__wrapped__");if(Je||Qt){var jr=Je?m.value():m,Ir=Qt?S.value():S;return ge||(ge=new Dr),ze(jr,Ir,K,ee,ge)}}return At?(ge||(ge=new Dr),Os(m,S,K,ee,ze,ge)):!1}function ha(m){if(!Ls(m)||Cs(m))return!1;var S=cn(m)?kt:ot;return S.test(ti(m))}function Ss(m){return Ui(m)&&Ms(m.length)&&!!Ee[Mi(m)]}function Ps(m){if(!$s(m))return Di(m);var S=[];for(var K in Object(m))De.call(m,K)&&K!="constructor"&&S.push(K);return S}function sn(m,S,K,ee,ze,ge){var Ge=K&a,Rt=m.length,Se=S.length;if(Rt!=Se&&!(Ge&&Se>Rt))return!1;var ke=ge.get(m);if(ke&&ge.get(S))return ke==S;var mt=-1,ir=!0,At=K&u?new nn:void 0;for(ge.set(m,S),ge.set(S,m);++mt<Rt;){var Je=m[mt],Qt=S[mt];if(ee)var jr=Ge?ee(Qt,Je,mt,S,m,ge):ee(Je,Qt,mt,m,S,ge);if(jr!==void 0){if(jr)continue;ir=!1;break}if(At){if(!Ie(S,function(Ir,Vr){if(!rt(At,Vr)&&(Je===Ir||ze(Je,Ir,K,ee,ge)))return At.push(Vr)})){ir=!1;break}}else if(!(Je===Qt||ze(Je,Qt,K,ee,ge))){ir=!1;break}}return ge.delete(m),ge.delete(S),ir}function la(m,S,K,ee,ze,ge,Ge){switch(K){case qt:if(m.byteLength!=S.byteLength||m.byteOffset!=S.byteOffset)return!1;m=m.buffer,S=S.buffer;case Be:return!(m.byteLength!=S.byteLength||!ge(new Gt(m),new Gt(S)));case _:case x:case ae:return Ds(+m,+S);case M:return m.name==S.name&&m.message==S.message;case U:case W:return m==S+"";case re:var Rt=Fe;case B:var Se=ee&a;if(Rt||(Rt=it),m.size!=S.size&&!Se)return!1;var ke=Ge.get(m);if(ke)return ke==S;ee|=u,Ge.set(m,S);var mt=sn(Rt(m),Rt(S),ee,ze,ge,Ge);return Ge.delete(m),mt;case J:if(dt)return dt.call(m)==dt.call(S)}return!1}function Os(m,S,K,ee,ze,ge){var Ge=K&a,Rt=on(m),Se=Rt.length,ke=on(S),mt=ke.length;if(Se!=mt&&!Ge)return!1;for(var ir=Se;ir--;){var At=Rt[ir];if(!(Ge?At in S:De.call(S,At)))return!1}var Je=ge.get(m);if(Je&&ge.get(S))return Je==S;var Qt=!0;ge.set(m,S),ge.set(S,m);for(var jr=Ge;++ir<Se;){At=Rt[ir];var Ir=m[At],Vr=S[At];if(ee)var Mn=Ge?ee(Vr,Ir,At,S,m,ge):ee(Ir,Vr,At,m,S,ge);if(!(Mn===void 0?Ir===Vr||ze(Ir,Vr,K,ee,ge):Mn)){Qt=!1;break}jr||(jr=At=="constructor")}if(Qt&&!jr){var qi=m.constructor,jt=S.constructor;qi!=jt&&"constructor"in m&&"constructor"in S&&!(typeof qi=="function"&&qi instanceof qi&&typeof jt=="function"&&jt instanceof jt)&&(Qt=!1)}return ge.delete(m),ge.delete(S),Qt}function on(m){return $n(m,ga,As)}function wi(m,S){var K=m.__data__;return Ns(S)?K[typeof S=="string"?"string":"hash"]:K.map}function pr(m,S){var K=Ce(m,S);return ha(K)?K:void 0}function Rs(m){var S=De.call(m,Jt),K=m[Jt];try{m[Jt]=void 0;var ee=!0}catch{}var ze=Nt.call(m);return ee&&(S?m[Jt]=K:delete m[Jt]),ze}var As=Zr?function(m){return m==null?[]:(m=Object(m),Re(Zr(m),function(S){return rr.call(m,S)}))}:qe,Fr=Mi;(ct&&Fr(new ct(new ArrayBuffer(1)))!=qt||Ye&&Fr(new Ye)!=re||ut&&Fr(ut.resolve())!=$||ht&&Fr(new ht)!=B||nt&&Fr(new nt)!=Qe)&&(Fr=function(m){var S=Mi(m),K=S==A?m.constructor:void 0,ee=K?ti(K):"";if(ee)switch(ee){case It:return qt;case xt:return re;case lt:return $;case St:return B;case ft:return Qe}return S});function Ts(m,S){return S=S??f,!!S&&(typeof m=="number"||$i.test(m))&&m>-1&&m%1==0&&m<S}function Ns(m){var S=typeof m;return S=="string"||S=="number"||S=="symbol"||S=="boolean"?m!=="__proto__":m===null}function Cs(m){return!!Et&&Et in m}function $s(m){var S=m&&m.constructor,K=typeof S=="function"&&S.prototype||Ae;return m===K}function fa(m){return Nt.call(m)}function ti(m){if(m!=null){try{return at.call(m)}catch{}try{return m+""}catch{}}return""}function Ds(m,S){return m===S||m!==m&&S!==S}var js=Dn(function(){return arguments}())?Dn:function(m){return Ui(m)&&De.call(m,"callee")&&!rr.call(m,"callee")},an=Array.isArray;function da(m){return m!=null&&Ms(m.length)&&!cn(m)}var jn=vi||Le;function pa(m,S){return Li(m,S)}function cn(m){if(!Ls(m))return!1;var S=Mi(m);return S==z||S==T||S==y||S==j}function Ms(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=f}function Ls(m){var S=typeof m;return m!=null&&(S=="object"||S=="function")}function Ui(m){return m!=null&&typeof m=="object"}var Us=ve?gt(ve):Ss;function ga(m){return da(m)?Is(m):Ps(m)}function qe(){return[]}function Le(){return!1}n.exports=pa})(qo,qo.exports);var fE=qo.exports;const dE=Yc(fE);var pE={};function gE(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var u=n.charAt(a),f=u.charCodeAt(0);if(r[f]!==255)throw new TypeError(u+" is ambiguous");r[f]=a}var g=n.length,v=n.charAt(0),y=Math.log(g)/Math.log(256),_=Math.log(256)/Math.log(g);function x(T){if(T instanceof Uint8Array||(ArrayBuffer.isView(T)?T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength):Array.isArray(T)&&(T=Uint8Array.from(T))),!(T instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(T.length===0)return"";for(var re=0,ae=0,ce=0,A=T.length;ce!==A&&T[ce]===0;)ce++,re++;for(var $=(A-ce)*_+1>>>0,j=new Uint8Array($);ce!==A;){for(var U=T[ce],B=0,W=$-1;(U!==0||B<ae)&&W!==-1;W--,B++)U+=256*j[W]>>>0,j[W]=U%g>>>0,U=U/g>>>0;if(U!==0)throw new Error("Non-zero carry");ae=B,ce++}for(var J=$-ae;J!==$&&j[J]===0;)J++;for(var Oe=v.repeat(re);J<$;++J)Oe+=n.charAt(j[J]);return Oe}function M(T){if(typeof T!="string")throw new TypeError("Expected String");if(T.length===0)return new Uint8Array;var re=0;if(T[re]!==" "){for(var ae=0,ce=0;T[re]===v;)ae++,re++;for(var A=(T.length-re)*y+1>>>0,$=new Uint8Array(A);T[re];){var j=r[T.charCodeAt(re)];if(j===255)return;for(var U=0,B=A-1;(j!==0||U<ce)&&B!==-1;B--,U++)j+=g*$[B]>>>0,$[B]=j%256>>>0,j=j/256>>>0;if(j!==0)throw new Error("Non-zero carry");ce=U,re++}if(T[re]!==" "){for(var W=A-ce;W!==A&&$[W]===0;)W++;for(var J=new Uint8Array(ae+(A-W)),Oe=ae;W!==A;)J[Oe++]=$[W++];return J}}}function z(T){var re=M(T);if(re)return re;throw new Error(`Non-${t} character`)}return{encode:x,decodeUnsafe:M,decode:z}}var yE=gE,mE=yE;const pd=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},vE=n=>new TextEncoder().encode(n),wE=n=>new TextDecoder().decode(n);class bE{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class _E{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return gd(this,t)}}let EE=class{constructor(t){this.decoders=t}or(t){return gd(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const gd=(n,t)=>new EE({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class IE{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new bE(t,r,s),this.decoder=new _E(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Wo=({name:n,prefix:t,encode:r,decode:s})=>new IE(n,t,r,s),ws=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=mE(r,t);return Wo({prefix:n,name:t,encode:s,decode:u=>pd(a(u))})},xE=(n,t,r,s)=>{const a={};for(let _=0;_<t.length;++_)a[t[_]]=_;let u=n.length;for(;n[u-1]==="=";)--u;const f=new Uint8Array(u*r/8|0);let g=0,v=0,y=0;for(let _=0;_<u;++_){const x=a[n[_]];if(x===void 0)throw new SyntaxError(`Non-${s} character`);v=v<<r|x,g+=r,g>=8&&(g-=8,f[y++]=255&v>>g)}if(g>=r||255&v<<8-g)throw new SyntaxError("Unexpected end of data");return f},SE=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let u="",f=0,g=0;for(let v=0;v<n.length;++v)for(g=g<<8|n[v],f+=8;f>r;)f-=r,u+=t[a&g>>f];if(f&&(u+=t[a&g<<r-f]),s)for(;u.length*r&7;)u+="=";return u},Bt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Wo({prefix:t,name:n,encode(a){return SE(a,s,r)},decode(a){return xE(a,s,r,n)}}),PE=Wo({prefix:"\0",name:"identity",encode:n=>wE(n),decode:n=>vE(n)});var OE=Object.freeze({__proto__:null,identity:PE});const RE=Bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var AE=Object.freeze({__proto__:null,base2:RE});const TE=Bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var NE=Object.freeze({__proto__:null,base8:TE});const CE=ws({prefix:"9",name:"base10",alphabet:"0123456789"});var $E=Object.freeze({__proto__:null,base10:CE});const DE=Bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),jE=Bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ME=Object.freeze({__proto__:null,base16:DE,base16upper:jE});const LE=Bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),UE=Bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qE=Bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zE=Bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),kE=Bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),HE=Bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),KE=Bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),BE=Bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),FE=Bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var VE=Object.freeze({__proto__:null,base32:LE,base32upper:UE,base32pad:qE,base32padupper:zE,base32hex:kE,base32hexupper:HE,base32hexpad:KE,base32hexpadupper:BE,base32z:FE});const WE=ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),GE=ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var JE=Object.freeze({__proto__:null,base36:WE,base36upper:GE});const QE=ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),YE=ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var XE=Object.freeze({__proto__:null,base58btc:QE,base58flickr:YE});const ZE=Bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),eI=Bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),tI=Bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),rI=Bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var iI=Object.freeze({__proto__:null,base64:ZE,base64pad:eI,base64url:tI,base64urlpad:rI});const yd=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),nI=yd.reduce((n,t,r)=>(n[r]=t,n),[]),sI=yd.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function oI(n){return n.reduce((t,r)=>(t+=nI[r],t),"")}function aI(n){const t=[];for(const r of n){const s=sI[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const cI=Wo({prefix:"🚀",name:"base256emoji",encode:oI,decode:aI});var uI=Object.freeze({__proto__:null,base256emoji:cI}),hI=md,Zl=128,lI=127,fI=~lI,dI=Math.pow(2,31);function md(n,t,r){t=t||[],r=r||0;for(var s=r;n>=dI;)t[r++]=n&255|Zl,n/=128;for(;n&fI;)t[r++]=n&255|Zl,n>>>=7;return t[r]=n|0,md.bytes=r-s+1,t}var pI=Kc,gI=128,ef=127;function Kc(n,s){var r=0,s=s||0,a=0,u=s,f,g=n.length;do{if(u>=g)throw Kc.bytes=0,new RangeError("Could not decode varint");f=n[u++],r+=a<28?(f&ef)<<a:(f&ef)*Math.pow(2,a),a+=7}while(f>=gI);return Kc.bytes=u-s,r}var yI=Math.pow(2,7),mI=Math.pow(2,14),vI=Math.pow(2,21),wI=Math.pow(2,28),bI=Math.pow(2,35),_I=Math.pow(2,42),EI=Math.pow(2,49),II=Math.pow(2,56),xI=Math.pow(2,63),SI=function(n){return n<yI?1:n<mI?2:n<vI?3:n<wI?4:n<bI?5:n<_I?6:n<EI?7:n<II?8:n<xI?9:10},PI={encode:hI,decode:pI,encodingLength:SI},vd=PI;const tf=(n,t,r=0)=>(vd.encode(n,t,r),t),rf=n=>vd.encodingLength(n),Bc=(n,t)=>{const r=t.byteLength,s=rf(n),a=s+rf(r),u=new Uint8Array(a+r);return tf(n,u,0),tf(r,u,s),u.set(t,a),new OI(n,r,t,u)};class OI{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const wd=({name:n,code:t,encode:r})=>new RI(n,t,r);class RI{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Bc(this.code,r):r.then(s=>Bc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const bd=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),AI=wd({name:"sha2-256",code:18,encode:bd("SHA-256")}),TI=wd({name:"sha2-512",code:19,encode:bd("SHA-512")});var NI=Object.freeze({__proto__:null,sha256:AI,sha512:TI});const _d=0,CI="identity",Ed=pd,$I=n=>Bc(_d,Ed(n)),DI={code:_d,name:CI,encode:Ed,digest:$I};var jI=Object.freeze({__proto__:null,identity:DI});new TextEncoder,new TextDecoder;const nf={...OE,...AE,...NE,...$E,...ME,...VE,...JE,...XE,...iI,...uI};({...NI,...jI});function Id(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function MI(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Id(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function xd(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const sf=xd("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Oc=xd("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=MI(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),LI={utf8:sf,"utf-8":sf,hex:nf.base16,latin1:Oc,ascii:Oc,binary:Oc,...nf};function UI(n,t="utf8"){const r=LI[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Id(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const Sd="wc",qI=2,hu="core",Ti=`${Sd}@2:${hu}:`,zI={name:hu,logger:"error"},kI={database:":memory:"},HI="crypto",of="client_ed25519_seed",KI=oe.ONE_DAY,BI="keychain",FI="0.3",VI="messages",WI="0.3",GI=oe.SIX_HOURS,JI="publisher",Pd="irn",QI="error",Od="wss://relay.walletconnect.com",af="wss://relay.walletconnect.org",YI="relayer",Wt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},XI="_subscription",di={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ZI=oe.ONE_SECOND,ex="2.10.6",tx=1e4,rx="0.3",ix="WALLETCONNECT_CLIENT_ID",zr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},nx="subscription",sx="0.3",ox=oe.FIVE_SECONDS*1e3,ax="pairing",cx="0.3",es={wc_pairingDelete:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:0},res:{ttl:oe.ONE_DAY,prompt:!1,tag:0}}},os={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Qr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ux="history",hx="0.3",lx="expirer",Nr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},fx="0.3",Rc="verify-api",Sn="https://verify.walletconnect.com",Fc="https://verify.walletconnect.org",dx=[Sn,Fc];class px{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=BI,this.version=FI,this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:u}=X("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(u)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=_r(r,this.name)}get context(){return dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Ff(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Vf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=X("NOT_INITIALIZED",this.name);throw new Error(t)}}}class gx{constructor(t,r,s){this.core=t,this.logger=r,this.name=HI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),u=Fl(a);return od(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=Xw();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const u=await this.getClientSeed(),f=Fl(u),g=qc();return await B1(g,a,KI,f)},this.generateSharedKey=(a,u,f)=>{this.isInitialized();const g=this.getPrivateKey(a),v=Zw(g,u);return this.setSymKey(v,f)},this.setSymKey=async(a,u)=>{this.isInitialized();const f=u||eb(a);return await this.keychain.set(f,a),f},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,u,f)=>{this.isInitialized();const g=Bf(f),v=Qi(u);if(bl(g)){const M=g.senderPublicKey,z=g.receiverPublicKey;a=await this.generateSharedKey(M,z)}const y=this.getSymKey(a),{type:_,senderPublicKey:x}=g;return rb({type:_,symKey:y,message:v,senderPublicKey:x})},this.decode=async(a,u,f)=>{this.isInitialized();const g=sb(u,f);if(bl(g)){const v=g.receiverPublicKey,y=g.senderPublicKey;a=await this.generateSharedKey(v,y)}try{const v=this.getSymKey(a),y=ib({symKey:v,encoded:u});return ms(y)}catch(v){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(v)}},this.getPayloadType=a=>{const u=Mo(a);return ps(u.type)},this.getPayloadSenderPublicKey=a=>{const u=Mo(a);return u.senderPublicKey?tr(u.senderPublicKey,er):void 0},this.core=t,this.logger=_r(r,this.name),this.keychain=s||new px(this.core,this.logger)}get context(){return dr(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(of)}catch{t=qc(),await this.keychain.set(of,t)}return UI(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=X("NOT_INITIALIZED",this.name);throw new Error(t)}}}class yx extends E1{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=VI,this.version=WI,this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const u=Pn(a);let f=this.messages.get(s);return typeof f>"u"&&(f={}),typeof f[u]<"u"||(f[u]=a,this.messages.set(s,f),await this.persist()),u},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const u=this.get(s),f=Pn(a);return typeof u[f]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=_r(t,this.name),this.core=r}get context(){return dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Ff(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Vf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=X("NOT_INITIALIZED",this.name);throw new Error(t)}}}class mx extends I1{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Cr.EventEmitter,this.name=JI,this.queue=new Map,this.publishTimeout=oe.toMiliseconds(oe.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,u)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:u}});try{const g=(u==null?void 0:u.ttl)||GI,v=zc(u),y=(u==null?void 0:u.prompt)||!1,_=(u==null?void 0:u.tag)||0,x=(u==null?void 0:u.id)||ld().toString(),M={topic:s,message:a,opts:{ttl:g,relay:v,prompt:y,tag:_,id:x}},z=setTimeout(()=>this.queue.set(x,M),this.publishTimeout);try{await await hs(this.rpcPublish(s,a,g,v,y,_,x),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(x),this.relayer.events.emit(Wt.publish,M)}catch(T){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=u==null?void 0:u.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(x),T;return}finally{clearTimeout(z)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:u}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=_r(r,this.name),this.registerEventListeners()}get context(){return dr(this.logger)}rpcPublish(t,r,s,a,u,f,g){var v,y,_,x;const M={method:Co(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:u,tag:f},id:g};return lr((v=M.params)==null?void 0:v.prompt)&&((y=M.params)==null||delete y.prompt),lr((_=M.params)==null?void 0:_.tag)&&((x=M.params)==null||delete x.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:M}),this.relayer.request(M)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Wt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Wt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class vx{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(u=>u!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var wx=Object.defineProperty,bx=Object.defineProperties,_x=Object.getOwnPropertyDescriptors,cf=Object.getOwnPropertySymbols,Ex=Object.prototype.hasOwnProperty,Ix=Object.prototype.propertyIsEnumerable,uf=(n,t,r)=>t in n?wx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,ts=(n,t)=>{for(var r in t||(t={}))Ex.call(t,r)&&uf(n,r,t[r]);if(cf)for(var r of cf(t))Ix.call(t,r)&&uf(n,r,t[r]);return n},Ac=(n,t)=>bx(n,_x(t));class xx extends P1{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new vx,this.events=new Cr.EventEmitter,this.name=nx,this.version=sx,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ti,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const u=zc(a),f={topic:s,relay:u};this.pending.set(s,f);const g=await this.rpcSubscribe(s,u);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),g}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,u)=>{const f=new oe.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),a(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=ox&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=_r(r,this.name),this.clientId=""}get context(){return dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=zc(s);await this.rpcUnsubscribe(t,r,a);const u=bt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:Co(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await hs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}return Pn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Co(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await hs(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Wt.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:Co(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,Ac(ts({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,ts({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,ts({},r)),this.topicMap.set(r.topic,t),this.events.emit(zr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=X("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(zr.deleted,Ac(ts({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(zr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(zr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);Xr(r)&&this.onBatchSubscribe(r.map((s,a)=>Ac(ts({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Wt.connect,async()=>{await this.onConnect()}),this.relayer.on(Wt.disconnect,()=>{this.onDisconnect()}),this.events.on(zr.created,async t=>{const r=zr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(zr.deleted,async t=>{const r=zr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=X("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var Sx=Object.defineProperty,hf=Object.getOwnPropertySymbols,Px=Object.prototype.hasOwnProperty,Ox=Object.prototype.propertyIsEnumerable,lf=(n,t,r)=>t in n?Sx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Rx=(n,t)=>{for(var r in t||(t={}))Px.call(t,r)&&lf(n,r,t[r]);if(hf)for(var r of hf(t))Ox.call(t,r)&&lf(n,r,t[r]);return n};class Ax extends x1{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Cr.EventEmitter,this.name=YI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Wt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Wt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(di.payload,this.onPayloadHandler),this.provider.on(di.connect,this.onConnectHandler),this.provider.on(di.disconnect,this.onDisconnectHandler),this.provider.on(di.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?_r(t.logger,this.name):Ko(Bo({level:t.logger||QI})),this.messages=new yx(this.logger,t.core),this.subscriber=new xx(this,this.logger),this.publisher=new mx(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Od,this.projectId=t.projectId,this.bundleId=lb(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${af}...`),await this.restartTransport(af)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},tx)}get context(){return dr(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(a)return a;let u;const f=g=>{g.topic===t&&(this.subscriber.off(zr.created,f),u())};return await Promise.all([new Promise(g=>{u=g,this.subscriber.on(zr.created,f)}),new Promise(async g=>{a=await this.subscriber.subscribe(t,r),g()})]),a}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await hs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(zr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await hs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(di.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Nl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new yi(new lE(mb({sdkVersion:ex,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),uu(t)){if(!t.method.endsWith(XI))return;const r=t.params,{topic:s,message:a,publishedAt:u}=r.data,f={topic:s,message:a,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Rx({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(t),await this.onMessageEvent(f)}else Vo(t)&&this.events.emit(Wt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Wt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=cu(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(di.payload,this.onPayloadHandler),this.provider.off(di.connect,this.onConnectHandler),this.provider.off(di.disconnect,this.onDisconnectHandler),this.provider.off(di.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Wt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Nl();u_(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Wt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},oe.toMiliseconds(ZI)))}isInitialized(){if(!this.initialized){const{message:t}=X("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Tx=Object.defineProperty,ff=Object.getOwnPropertySymbols,Nx=Object.prototype.hasOwnProperty,Cx=Object.prototype.propertyIsEnumerable,df=(n,t,r)=>t in n?Tx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,pf=(n,t)=>{for(var r in t||(t={}))Nx.call(t,r)&&df(n,r,t[r]);if(ff)for(var r of ff(t))Cx.call(t,r)&&df(n,r,t[r]);return n};class Go extends S1{constructor(t,r,s,a=Ti,u=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=rx,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!lr(f)?this.map.set(this.getKey(f),f):zb(f)?this.map.set(f.id,f):kb(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(v=>dE(g[v],f[v]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const v=pf(pf({},this.getData(f)),g);this.map.set(f,v),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=_r(r,this.name),this.storagePrefix=a,this.getKey=u}get context(){return dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=X("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=X("NOT_INITIALIZED",this.name);throw new Error(t)}}}class $x{constructor(t,r){this.core=t,this.logger=r,this.name=ax,this.version=cx,this.events=new Xc,this.initialized=!1,this.storagePrefix=Ti,this.ignoredPayloadTypes=[Yi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=qc(),a=await this.core.crypto.setSymKey(s),u=kr(oe.FIVE_MINUTES),f={protocol:Pd},g={topic:a,expiry:u,relay:f,active:!1},v=Tb({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:f});return await this.pairings.set(a,g),await this.core.relayer.subscribe(a),this.core.expirer.set(a,u),{topic:a,uri:v}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:u,relay:f}=Pl(s.uri);let g;if(this.pairings.keys.includes(a)&&(g=this.pairings.get(a),g.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const v=kr(oe.FIVE_MINUTES),y={topic:a,relay:f,expiry:v,active:!1};return await this.pairings.set(a,y),this.core.expirer.set(a,v),s.activatePairing&&await this.activate({topic:a}),this.events.emit(os.create,y),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(u,a),await this.core.relayer.subscribe(a,{relay:f})),y},this.activate=async({topic:s})=>{this.isInitialized();const a=kr(oe.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const u=await this.sendRequest(a,"wc_pairingPing",{}),{done:f,resolve:g,reject:v}=xn();this.events.once(Tt("pairing_ping",u),({error:y})=>{y?v(y):g()}),await f()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",bt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,u)=>{const f=Rn(a,u),g=await this.core.crypto.encode(s,f),v=es[a].req;return this.core.history.set(s,f),this.core.relayer.publish(s,g,v),f.id},this.sendResult=async(s,a,u)=>{const f=cu(s,u),g=await this.core.crypto.encode(a,f),v=await this.core.history.get(a,s),y=es[v.request.method].res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.sendError=async(s,a,u)=>{const f=Fo(s,u),g=await this.core.crypto.encode(a,f),v=await this.core.history.get(a,s),y=es[v.request.method]?es[v.request.method].res:es.unregistered_method.res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,bt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Ai(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:u}=s;switch(u.method){case"wc_pairingPing":return this.onPairingPingRequest(a,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,u);default:return this.onUnknownRpcMethodRequest(a,u)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:u}=s,f=(await this.core.history.get(a,u.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(a,u);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(s,a)=>{const{id:u}=a;try{this.isValidPing({topic:s}),await this.sendResult(u,s,!0),this.events.emit(os.ping,{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onPairingPingResponse=(s,a)=>{const{id:u}=a;setTimeout(()=>{gi(a)?this.events.emit(Tt("pairing_ping",u),{}):Hr(a)&&this.events.emit(Tt("pairing_ping",u),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:u}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(os.delete,{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:u,method:f}=a;try{if(this.registeredMethods.includes(f))return;const g=bt("WC_METHOD_UNSUPPORTED",f);await this.sendError(u,s,g),this.logger.error(g)}catch(g){await this.sendError(u,s,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(bt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var a;if(!hr(s)){const{message:f}=X("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(f)}if(!qb(s.uri)){const{message:f}=X("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(f)}const u=Pl(s.uri);if(!((a=u==null?void 0:u.relay)!=null&&a.protocol)){const{message:f}=X("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(u!=null&&u.symKey)){const{message:f}=X("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async s=>{if(!hr(s)){const{message:u}=X("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!hr(s)){const{message:u}=X("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!Ut(s,!1)){const{message:a}=X("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=X("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Ai(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=X("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=_r(r,this.name),this.pairings=new Go(this.core,this.logger,this.name,this.storagePrefix)}get context(){return dr(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=X("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Wt.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{uu(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Vo(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on(Nr.expired,async t=>{const{topic:r}=Gf(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(os.expire,{topic:r}))})}}class Dx extends _1{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Cr.EventEmitter,this.name=ux,this.version=hx,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:u}),this.records.has(a.id))return;const f={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:u,expiry:kr(oe.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Qr.created,f)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Hr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Qr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(u=>{if(u.topic===s){if(typeof a<"u"&&u.id!==a)return;this.records.delete(u.id),this.events.emit(Qr.deleted,u)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=_r(r,this.name)}get context(){return dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Rn(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=X("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Qr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Qr.created,t=>{const r=Qr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.updated,t=>{const r=Qr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Qr.deleted,t=>{const r=Qr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{oe.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=X("NOT_INITIALIZED",this.name);throw new Error(t)}}}class jx extends O1{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Cr.EventEmitter,this.name=lx,this.version=fx,this.cached=[],this.initialized=!1,this.storagePrefix=Ti,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const u=this.formatTarget(s),f={target:u,expiry:a};this.expirations.set(u,f),this.checkExpiry(u,f),this.events.emit(Nr.created,{target:u,expiration:f})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),u=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Nr.deleted,{target:a,expiration:u})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=_r(r,this.name)}get context(){return dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return vb(t);if(typeof t=="number")return wb(t);const{message:r}=X("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Nr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=X("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;oe.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Nr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Cn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Nr.created,t=>{const r=Nr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Nr.expired,t=>{const r=Nr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Nr.deleted,t=>{const r=Nr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=X("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Mx extends R1{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Rc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||An()||!Tn())return;const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Fc;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let u;try{u=await this.fetchAttestation(s.attestationId,a)}catch(f){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.info(f),u=await this.fetchAttestation(s.attestationId,Fc)}return u},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const u=this.startAbortTimer(oe.ONE_SECOND*2),f=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(u),f.status===200?await f.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=u=>{u.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(u=>{if(document.getElementById(Rc))return u();window.addEventListener("message",a);const f=document.createElement("iframe");f.id=Rc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,s=u}),new Promise((u,f)=>setTimeout(()=>{window.removeEventListener("message",a),f("verify iframe load timeout")},oe.toMiliseconds(oe.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let a=s||Sn;return dx.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${Sn}`),a=Sn),a},this.logger=_r(r,this.name),this.verifyUrl=Sn,this.abortController=new AbortController,this.isDevEnv=ru()&&pE.IS_VITEST}get context(){return dr(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),oe.toMiliseconds(t))}}var Lx=Object.defineProperty,gf=Object.getOwnPropertySymbols,Ux=Object.prototype.hasOwnProperty,qx=Object.prototype.propertyIsEnumerable,yf=(n,t,r)=>t in n?Lx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,mf=(n,t)=>{for(var r in t||(t={}))Ux.call(t,r)&&yf(n,r,t[r]);if(gf)for(var r of gf(t))qx.call(t,r)&&yf(n,r,t[r]);return n};class lu extends b1{constructor(t){super(t),this.protocol=Sd,this.version=qI,this.name=hu,this.events=new Cr.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Od,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ko(Bo({level:(t==null?void 0:t.logger)||zI.logger}));this.logger=_r(r,this.name),this.heartbeat=new Cn.HeartBeat,this.crypto=new gx(this,this.logger,t==null?void 0:t.keychain),this.history=new Dx(this,this.logger),this.expirer=new jx(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new K_(mf(mf({},kI),t==null?void 0:t.storageOptions)),this.relayer=new Ax({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new $x(this,this.logger),this.verify=new Mx(this.projectId||"",this.logger)}static async init(t){const r=new lu(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(ix,s),r}get context(){return dr(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const zx=lu,Rd="wc",Ad=2,Td="client",fu=`${Rd}@${Ad}:${Td}:`,Tc={name:Td,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},vf="WALLETCONNECT_DEEPLINK_CHOICE",kx="proposal",Nd="Proposal expired",Hx="session",Ao=oe.SEVEN_DAYS,Kx="engine",rs={wc_sessionPropose:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1104},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1106},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:oe.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:oe.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:oe.ONE_DAY,prompt:!1,tag:1112},res:{ttl:oe.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:oe.THIRTY_SECONDS,prompt:!1,tag:1115}}},Nc={min:oe.FIVE_MINUTES,max:oe.SEVEN_DAYS},pi={idle:"IDLE",active:"ACTIVE"},Bx="request",Fx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Vx=Object.defineProperty,Wx=Object.defineProperties,Gx=Object.getOwnPropertyDescriptors,wf=Object.getOwnPropertySymbols,Jx=Object.prototype.hasOwnProperty,Qx=Object.prototype.propertyIsEnumerable,bf=(n,t,r)=>t in n?Vx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,cr=(n,t)=>{for(var r in t||(t={}))Jx.call(t,r)&&bf(n,r,t[r]);if(wf)for(var r of wf(t))Qx.call(t,r)&&bf(n,r,t[r]);return n},is=(n,t)=>Wx(n,Gx(t));class Yx extends T1{constructor(t){super(t),this.name=Kx,this.events=new Xc,this.initialized=!1,this.ignoredPayloadTypes=[Yi],this.requestQueue={state:pi.idle,queue:[]},this.sessionRequestQueue={state:pi.idle,queue:[]},this.requestQueueDelay=oe.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(rs)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},oe.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=is(cr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:u,optionalNamespaces:f,sessionProperties:g,relays:v}=s;let y=a,_,x=!1;if(y&&(x=this.client.core.pairing.pairings.get(y).active),!y||!x){const{topic:$,uri:j}=await this.client.core.pairing.create();y=$,_=j}const M=await this.client.core.crypto.generateKeyPair(),z=cr({requiredNamespaces:u,optionalNamespaces:f,relays:v??[{protocol:Pd}],proposer:{publicKey:M,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:T,resolve:re,done:ae}=xn(oe.FIVE_MINUTES,Nd);if(this.events.once(Tt("session_connect"),async({error:$,session:j})=>{if($)T($);else if(j){j.self.publicKey=M;const U=is(cr({},j),{requiredNamespaces:j.requiredNamespaces,optionalNamespaces:j.optionalNamespaces});await this.client.session.set(j.topic,U),await this.setExpiry(j.topic,j.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:j.peer.metadata}),re(U)}}),!y){const{message:$}=X("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error($)}const ce=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:z}),A=kr(oe.FIVE_MINUTES);return await this.setProposal(ce,cr({id:ce,expiry:A},z)),{uri:_,approval:ae}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:u,sessionProperties:f}=r,g=this.client.proposal.get(s);let{pairingTopic:v,proposer:y,requiredNamespaces:_,optionalNamespaces:x}=g;v=v||"",On(_)||(_=Db(u,"approve()"));const M=await this.client.core.crypto.generateKeyPair(),z=y.publicKey,T=await this.client.core.crypto.generateSharedKey(M,z);v&&s&&(await this.client.core.pairing.updateMetadata({topic:v,metadata:y.metadata}),await this.sendResult({id:s,topic:v,result:{relay:{protocol:a??"irn"},responderPublicKey:M}}),await this.client.proposal.delete(s,bt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:v}));const re=cr({relay:{protocol:a??"irn"},namespaces:u,requiredNamespaces:_,optionalNamespaces:x,pairingTopic:v,controller:{publicKey:M,metadata:this.client.metadata},expiry:kr(Ao)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(T),await this.sendRequest({topic:T,method:"wc_sessionSettle",params:re,throwOnFailedPublish:!0});const ae=is(cr({},re),{topic:T,pairingTopic:v,acknowledged:!1,self:re.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:M});return await this.client.session.set(T,ae),await this.setExpiry(T,kr(Ao)),{topic:T,acknowledged:()=>new Promise(ce=>setTimeout(()=>ce(this.client.session.get(T)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:u}=this.client.proposal.get(s);u&&(await this.sendError(s,u,a),await this.client.proposal.delete(s,bt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,u=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:f,resolve:g,reject:v}=xn();return this.events.once(Tt("session_update",u),({error:y})=>{y?v(y):g()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:u,resolve:f,reject:g}=xn();return this.events.once(Tt("session_extend",a),({error:v})=>{v?g(v):f()}),await this.setExpiry(s,kr(Ao)),{acknowledged:u}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:u,expiry:f}=r,g=au(),{done:v,resolve:y,reject:_}=xn(f,"Request expired. Please try again.");return this.events.once(Tt("session_request",g),({error:x,result:M})=>{x?_(x):y(M)}),await Promise.all([new Promise(async x=>{await this.sendRequest({clientRpcId:g,topic:u,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:f,throwOnFailedPublish:!0}).catch(M=>_(M)),this.client.events.emit("session_request_sent",{topic:u,request:a,chainId:s,id:g}),x()}),new Promise(async x=>{const M=await _b(this.client.core.storage,vf);bb({id:g,topic:u,wcDeepLink:M}),x()}),v()]).then(x=>x[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:u}=a;gi(a)?await this.sendResult({id:u,topic:s,result:a.result,throwOnFailedPublish:!0}):Hr(a)&&await this.sendError(u,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:u,resolve:f,reject:g}=xn();this.events.once(Tt("session_ping",a),({error:v})=>{v?g(v):f()}),await u()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:u}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:u}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:bt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>Lb(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(u=>{var f,g;return((f=u.peerMetadata)==null?void 0:f.url)&&((g=u.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&u.topic&&u.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,bt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(vf).catch(u=>this.client.logger.warn(u))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,bt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(u=>u.id!==r),a&&(this.sessionRequestQueue.state=pi.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=rs.wc_sessionRequest.req.ttl,{id:a,topic:u,params:f,verifyContext:g}=r;await this.client.pendingRequest.set(a,{id:a,topic:u,params:f,verifyContext:g}),s&&this.client.core.expirer.set(a,kr(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:u,expiry:f,relayRpcId:g,clientRpcId:v,throwOnFailedPublish:y}=r,_=Rn(a,u,v);if(Tn()&&Fx.includes(a)){const z=Pn(JSON.stringify(_));this.client.core.verify.register({attestationId:z})}const x=await this.client.core.crypto.encode(s,_),M=rs[a].req;return f&&(M.ttl=f),g&&(M.id=g),this.client.core.history.set(s,_),y?(M.internal=is(cr({},M.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,x,M)):this.client.core.relayer.publish(s,x,M).catch(z=>this.client.logger.error(z)),_.id},this.sendResult=async r=>{const{id:s,topic:a,result:u,throwOnFailedPublish:f}=r,g=cu(s,u),v=await this.client.core.crypto.encode(a,g),y=await this.client.core.history.get(a,s),_=rs[y.request.method].res;f?(_.internal=is(cr({},_.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,v,_)):this.client.core.relayer.publish(a,v,_).catch(x=>this.client.logger.error(x)),await this.client.core.history.resolve(g)},this.sendError=async(r,s,a)=>{const u=Fo(r,a),f=await this.client.core.crypto.encode(s,u),g=await this.client.core.history.get(s,r),v=rs[g.request.method].res;this.client.core.relayer.publish(s,f,v),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Ai(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Ai(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===pi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=pi.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=pi.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,u=a.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,u=(await this.client.core.history.get(s,a.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=X("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:u}=s;try{this.isValidConnect(cr({},s.params));const f=kr(oe.FIVE_MINUTES),g=cr({id:u,pairingTopic:r,expiry:f},a);await this.setProposal(u,g);const v=Pn(JSON.stringify(s)),y=await this.getVerifyContext(v,g.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:g,verifyContext:y})}catch(f){await this.sendError(u,r,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(gi(s)){const{result:u}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const f=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const v=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});const y=await this.client.core.crypto.generateSharedKey(g,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const _=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:_}),await this.client.core.pairing.activate({topic:r})}else Hr(s)&&(await this.client.proposal.delete(a,bt("USER_DISCONNECTED")),this.events.emit(Tt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:u}=s;try{this.isValidSessionSettleRequest(u);const{relay:f,controller:g,expiry:v,namespaces:y,requiredNamespaces:_,optionalNamespaces:x,sessionProperties:M,pairingTopic:z}=s.params,T=cr({topic:r,relay:f,expiry:v,namespaces:y,acknowledged:!0,pairingTopic:z,requiredNamespaces:_,optionalNamespaces:x,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},M&&{sessionProperties:M});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Tt("session_connect"),{session:T}),this.cleanupDuplicatePairings(T)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;gi(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Tt("session_approve",a),{})):Hr(s)&&(await this.client.session.delete(r,bt("USER_DISCONNECTED")),this.events.emit(Tt("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:u}=s;try{const f=`${r}_session_update`,g=So.get(f);if(g&&this.isRequestOutOfSync(g,u)){this.client.logger.info(`Discarding out of sync request - ${u}`);return}this.isValidUpdate(cr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:u,topic:r,result:!0}),this.client.events.emit("session_update",{id:u,topic:r,params:a}),So.set(f,u)}catch(f){await this.sendError(u,r,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;gi(s)?this.events.emit(Tt("session_update",a),{}):Hr(s)&&this.events.emit(Tt("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,kr(Ao)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;gi(s)?this.events.emit(Tt("session_extend",a),{}):Hr(s)&&this.events.emit(Tt("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{gi(s)?this.events.emit(Tt("session_ping",a),{}):Hr(s)&&this.events.emit(Tt("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(u=>{this.client.core.relayer.once(Wt.publish,async()=>{u(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(u){this.client.logger.error(u)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:u}=s;try{this.isValidRequest(cr({topic:r},u));const f=Pn(JSON.stringify(Rn("wc_sessionRequest",u,a))),g=this.client.session.get(r),v=await this.getVerifyContext(f,g.peer.metadata),y={id:a,topic:r,params:u,verifyContext:v};await this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;gi(s)?this.events.emit(Tt("session_request",a),{result:s.result}):Hr(s)&&this.events.emit(Tt("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:u}=s;try{const f=`${r}_session_event_${u.event.name}`,g=So.get(f);if(g&&this.isRequestOutOfSync(g,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(cr({topic:r},u)),this.client.events.emit("session_event",{id:a,topic:r,params:u}),So.set(f,a)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=pi.idle,this.processSessionRequestQueue()},oe.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===pi.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=pi.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,Rn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!hr(r)){const{message:v}=X("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(v)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:u,sessionProperties:f,relays:g}=r;if(lr(s)||await this.isValidPairingTopic(s),!Jb(g)){const{message:v}=X("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(v)}!lr(a)&&On(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!lr(u)&&On(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),lr(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=Gb(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!hr(r))throw new Error(X("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:u,sessionProperties:f}=r;await this.isValidProposalId(s);const g=this.client.proposal.get(s),v=$o(a,"approve()");if(v)throw new Error(v.message);const y=Al(g.requiredNamespaces,a,"approve()");if(y)throw new Error(y.message);if(!Ut(u,!0)){const{message:_}=X("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(_)}lr(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async r=>{if(!hr(r)){const{message:u}=X("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(u)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!Yb(a)){const{message:u}=X("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidSessionSettleRequest=r=>{if(!hr(r)){const{message:y}=X("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(y)}const{relay:s,controller:a,namespaces:u,expiry:f}=r;if(!Qf(s)){const{message:y}=X("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const g=Hb(a,"onSessionSettleRequest()");if(g)throw new Error(g.message);const v=$o(u,"onSessionSettleRequest()");if(v)throw new Error(v.message);if(Ai(f)){const{message:y}=X("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async r=>{if(!hr(r)){const{message:v}=X("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(v)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const u=this.client.session.get(s),f=$o(a,"update()");if(f)throw new Error(f.message);const g=Al(u.requiredNamespaces,a,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!hr(r)){const{message:a}=X("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!hr(r)){const{message:v}=X("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(v)}const{topic:s,request:a,chainId:u,expiry:f}=r;await this.isValidSessionTopic(s);const{namespaces:g}=this.client.session.get(s);if(!Rl(g,u)){const{message:v}=X("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(v)}if(!Xb(a)){const{message:v}=X("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(v)}if(!t_(g,u,a.method)){const{message:v}=X("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(v)}if(f&&!s_(f,Nc)){const{message:v}=X("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${Nc.min} and ${Nc.max}`);throw new Error(v)}},this.isValidRespond=async r=>{if(!hr(r)){const{message:u}=X("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(u)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!Zb(a)){const{message:u}=X("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidPing=async r=>{if(!hr(r)){const{message:a}=X("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!hr(r)){const{message:g}=X("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:s,event:a,chainId:u}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Rl(f,u)){const{message:g}=X("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(g)}if(!e_(a)){const{message:g}=X("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}if(!r_(f,u,a.name)){const{message:g}=X("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!hr(r)){const{message:a}=X("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||Sn,validation:"UNKNOWN",origin:s.url||""}};try{const u=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});u&&(a.verified.origin=u.origin,a.verified.isScam=u.isScam,a.verified.validation=u.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.info(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!Ut(a,!1)){const{message:u}=X("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(u)}})}}async isInitialized(){if(!this.initialized){const{message:t}=X("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Wt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{uu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Vo(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(u){this.client.logger.error(u)}})}registerExpirerEvents(){this.client.core.expirer.on(Nr.expired,async t=>{const{topic:r,id:s}=Gf(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,X("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(os.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Ut(t,!1)){const{message:r}=X("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=X("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ai(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=X("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Ut(t,!1)){const{message:r}=X("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=X("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ai(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=X("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Ut(t,!1)){const{message:r}=X("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=X("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!Qb(t)){const{message:r}=X("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=X("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ai(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=X("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class Xx extends Go{constructor(t,r){super(t,r,kx,fu),this.core=t,this.logger=r}}class Zx extends Go{constructor(t,r){super(t,r,Hx,fu),this.core=t,this.logger=r}}class eS extends Go{constructor(t,r){super(t,r,Bx,fu,s=>s.id),this.core=t,this.logger=r}}let tS=class Cd extends A1{constructor(t){super(t),this.protocol=Rd,this.version=Ad,this.name=Tc.name,this.events=new Cr.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Tc.name,this.metadata=(t==null?void 0:t.metadata)||db();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ko(Bo({level:(t==null?void 0:t.logger)||Tc.logger}));this.core=(t==null?void 0:t.core)||new zx(t),this.logger=_r(r,this.name),this.session=new Zx(this.core,this.logger),this.proposal=new Xx(this.core,this.logger),this.pendingRequest=new eS(this.core,this.logger),this.engine=new Yx(this)}static async init(t){const r=new Cd(t);return await r.initialize(),r}get context(){return dr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Vc={exports:{}};(function(n,t){var r=typeof self<"u"?self:Kr,s=function(){function u(){this.fetch=!1,this.DOMException=r.DOMException}return u.prototype=r,new u}();(function(u){(function(f){var g={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function v(b){return b&&DataView.prototype.isPrototypeOf(b)}if(g.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(b){return b&&y.indexOf(Object.prototype.toString.call(b))>-1};function x(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(b))throw new TypeError("Invalid character in header field name");return b.toLowerCase()}function M(b){return typeof b!="string"&&(b=String(b)),b}function z(b){var O={next:function(){var ie=b.shift();return{done:ie===void 0,value:ie}}};return g.iterable&&(O[Symbol.iterator]=function(){return O}),O}function T(b){this.map={},b instanceof T?b.forEach(function(O,ie){this.append(ie,O)},this):Array.isArray(b)?b.forEach(function(O){this.append(O[0],O[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(O){this.append(O,b[O])},this)}T.prototype.append=function(b,O){b=x(b),O=M(O);var ie=this.map[b];this.map[b]=ie?ie+", "+O:O},T.prototype.delete=function(b){delete this.map[x(b)]},T.prototype.get=function(b){return b=x(b),this.has(b)?this.map[b]:null},T.prototype.has=function(b){return this.map.hasOwnProperty(x(b))},T.prototype.set=function(b,O){this.map[x(b)]=M(O)},T.prototype.forEach=function(b,O){for(var ie in this.map)this.map.hasOwnProperty(ie)&&b.call(O,this.map[ie],ie,this)},T.prototype.keys=function(){var b=[];return this.forEach(function(O,ie){b.push(ie)}),z(b)},T.prototype.values=function(){var b=[];return this.forEach(function(O){b.push(O)}),z(b)},T.prototype.entries=function(){var b=[];return this.forEach(function(O,ie){b.push([ie,O])}),z(b)},g.iterable&&(T.prototype[Symbol.iterator]=T.prototype.entries);function re(b){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}function ae(b){return new Promise(function(O,ie){b.onload=function(){O(b.result)},b.onerror=function(){ie(b.error)}})}function ce(b){var O=new FileReader,ie=ae(O);return O.readAsArrayBuffer(b),ie}function A(b){var O=new FileReader,ie=ae(O);return O.readAsText(b),ie}function $(b){for(var O=new Uint8Array(b),ie=new Array(O.length),de=0;de<O.length;de++)ie[de]=String.fromCharCode(O[de]);return ie.join("")}function j(b){if(b.slice)return b.slice(0);var O=new Uint8Array(b.byteLength);return O.set(new Uint8Array(b)),O.buffer}function U(){return this.bodyUsed=!1,this._initBody=function(b){this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:g.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:g.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():g.arrayBuffer&&g.blob&&v(b)?(this._bodyArrayBuffer=j(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||_(b))?this._bodyArrayBuffer=j(b):this._bodyText=b=Object.prototype.toString.call(b):this._bodyText="",this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var b=re(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?re(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(ce)}),this.text=function(){var b=re(this);if(b)return b;if(this._bodyBlob)return A(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve($(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(Oe)}),this.json=function(){return this.text().then(JSON.parse)},this}var B=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function W(b){var O=b.toUpperCase();return B.indexOf(O)>-1?O:b}function J(b,O){O=O||{};var ie=O.body;if(b instanceof J){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,O.headers||(this.headers=new T(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!ie&&b._bodyInit!=null&&(ie=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=O.credentials||this.credentials||"same-origin",(O.headers||!this.headers)&&(this.headers=new T(O.headers)),this.method=W(O.method||this.method||"GET"),this.mode=O.mode||this.mode||null,this.signal=O.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ie)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ie)}J.prototype.clone=function(){return new J(this,{body:this._bodyInit})};function Oe(b){var O=new FormData;return b.trim().split("&").forEach(function(ie){if(ie){var de=ie.split("="),G=de.shift().replace(/\+/g," "),V=de.join("=").replace(/\+/g," ");O.append(decodeURIComponent(G),decodeURIComponent(V))}}),O}function Qe(b){var O=new T,ie=b.replace(/\r?\n[\t ]+/g," ");return ie.split(/\r?\n/).forEach(function(de){var G=de.split(":"),V=G.shift().trim();if(V){var Q=G.join(":").trim();O.append(V,Q)}}),O}U.call(J.prototype);function Be(b,O){O||(O={}),this.type="default",this.status=O.status===void 0?200:O.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in O?O.statusText:"OK",this.headers=new T(O.headers),this.url=O.url||"",this._initBody(b)}U.call(Be.prototype),Be.prototype.clone=function(){return new Be(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new T(this.headers),url:this.url})},Be.error=function(){var b=new Be(null,{status:0,statusText:""});return b.type="error",b};var qt=[301,302,303,307,308];Be.redirect=function(b,O){if(qt.indexOf(O)===-1)throw new RangeError("Invalid status code");return new Be(null,{status:O,headers:{location:b}})},f.DOMException=u.DOMException;try{new f.DOMException}catch{f.DOMException=function(O,ie){this.message=O,this.name=ie;var de=Error(O);this.stack=de.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function zt(b,O){return new Promise(function(ie,de){var G=new J(b,O);if(G.signal&&G.signal.aborted)return de(new f.DOMException("Aborted","AbortError"));var V=new XMLHttpRequest;function Q(){V.abort()}V.onload=function(){var Y={status:V.status,statusText:V.statusText,headers:Qe(V.getAllResponseHeaders()||"")};Y.url="responseURL"in V?V.responseURL:Y.headers.get("X-Request-URL");var tt="response"in V?V.response:V.responseText;ie(new Be(tt,Y))},V.onerror=function(){de(new TypeError("Network request failed"))},V.ontimeout=function(){de(new TypeError("Network request failed"))},V.onabort=function(){de(new f.DOMException("Aborted","AbortError"))},V.open(G.method,G.url,!0),G.credentials==="include"?V.withCredentials=!0:G.credentials==="omit"&&(V.withCredentials=!1),"responseType"in V&&g.blob&&(V.responseType="blob"),G.headers.forEach(function(Y,tt){V.setRequestHeader(tt,Y)}),G.signal&&(G.signal.addEventListener("abort",Q),V.onreadystatechange=function(){V.readyState===4&&G.signal.removeEventListener("abort",Q)}),V.send(typeof G._bodyInit>"u"?null:G._bodyInit)})}return zt.polyfill=!0,u.fetch||(u.fetch=zt,u.Headers=T,u.Request=J,u.Response=Be),f.Headers=T,f.Request=J,f.Response=Be,f.fetch=zt,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var a=s;t=a.fetch,t.default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,n.exports=t})(Vc,Vc.exports);var rS=Vc.exports;const _f=Yc(rS),iS={Accept:"application/json","Content-Type":"application/json"},nS="POST",Ef={headers:iS,method:nS},If=10;class Ci{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Cr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Jl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,r){this.isAvailable||await this.register();try{const s=Qi(t),u=await(await _f(this.url,Object.assign(Object.assign({},Ef),{body:s}))).json();this.onPayload({data:u})}catch(s){this.onError(t.id,s)}}async register(t=this.url){if(!Jl(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),a(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Qi({id:1,jsonrpc:"2.0",method:"test",params:[]});await _f(t,Object.assign(Object.assign({},Ef),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ms(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),u=Fo(t,a);this.events.emit("payload",u)}parseError(t,r=this.url){return ud(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>If&&this.events.setMaxListeners(If)}}const xf="error",sS="wss://relay.walletconnect.com",oS="wc",aS="universal_provider",Sf=`${oS}@2:${aS}:`,cS="https://rpc.walletconnect.com/v1/",mi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ns=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Wc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",a=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",y=500,_="__lodash_placeholder__",x=1,M=2,z=4,T=1,re=2,ae=1,ce=2,A=4,$=8,j=16,U=32,B=64,W=128,J=256,Oe=512,Qe=30,Be="...",qt=800,zt=16,b=1,O=2,ie=3,de=1/0,G=9007199254740991,V=17976931348623157e292,Q=NaN,Y=4294967295,tt=Y-1,ot=Y>>>1,$i=[["ary",W],["bind",ae],["bindKey",ce],["curry",$],["curryRight",j],["flip",Oe],["partial",U],["partialRight",B],["rearg",J]],Ee="[object Arguments]",$r="[object Array]",L="[object AsyncFunction]",D="[object Boolean]",N="[object Date]",h="[object DOMException]",I="[object Error]",ne="[object Function]",fe="[object GeneratorFunction]",ve="[object Map]",Re="[object Number]",Te="[object Null]",Ie="[object Object]",_t="[object Promise]",gt="[object Proxy]",rt="[object RegExp]",Ce="[object Set]",Fe="[object String]",Ve="[object Symbol]",it="[object Undefined]",Me="[object WeakMap]",We="[object WeakSet]",Ae="[object ArrayBuffer]",Ue="[object DataView]",at="[object Float32Array]",De="[object Float64Array]",Et="[object Int8Array]",Nt="[object Int16Array]",kt="[object Int32Array]",Ht="[object Uint8Array]",Dt="[object Uint8ClampedArray]",Gt="[object Uint16Array]",rr="[object Uint32Array]",Br=/\b__p \+= '';/g,Jt=/\b(__p \+=) '' \+/g,Zr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,vi=/&(?:amp|lt|gt|quot|#39);/g,Di=/[&<>"']/g,ct=RegExp(vi.source),Ye=RegExp(Di.source),ut=/<%-([\s\S]+?)%>/g,ht=/<%([\s\S]+?)%>/g,nt=/<%=([\s\S]+?)%>/g,Xe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,It=/^\w*$/,xt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lt=/[\\^$.*+?()[\]{}|]/g,St=RegExp(lt.source),ft=/^\s+/,yt=/\s/,dt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ke=/\{\n\/\* \[wrapped with (.+)\] \*/,Pt=/,? & /,Ot=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Jo=/[()=,{}\[\]\/\s]/,Qo=/\\(\\)?/g,Yo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Er=/\w*$/,Xo=/^[-+]0x[0-9a-f]+$/i,Zo=/^0b[01]+$/i,ea=/^\[object .+?Constructor\]$/,ta=/^0o[0-7]+$/i,ra=/^(?:0|[1-9]\d*)$/,ei=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,tn=/($^)/,ia=/['\n\r\u2028\u2029\\]/g,rn="\\ud800-\\udfff",na="\\u0300-\\u036f",sa="\\ufe20-\\ufe2f",nn="\\u20d0-\\u20ff",bs=na+sa+nn,_s="\\u2700-\\u27bf",Dr="a-z\\xdf-\\xf6\\xf8-\\xff",oa="\\xac\\xb1\\xd7\\xf7",aa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ca="\\u2000-\\u206f",ua=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Es="A-Z\\xc0-\\xd6\\xd8-\\xde",Is="\\ufe0e\\ufe0f",ji=oa+aa+ca+ua,$n="['’]",Mi="["+rn+"]",Dn="["+ji+"]",Li="["+bs+"]",xs="\\d+",ha="["+_s+"]",Ss="["+Dr+"]",Ps="[^"+rn+ji+xs+_s+Dr+Es+"]",sn="\\ud83c[\\udffb-\\udfff]",la="(?:"+Li+"|"+sn+")",Os="[^"+rn+"]",on="(?:\\ud83c[\\udde6-\\uddff]){2}",wi="[\\ud800-\\udbff][\\udc00-\\udfff]",pr="["+Es+"]",Rs="\\u200d",As="(?:"+Ss+"|"+Ps+")",Fr="(?:"+pr+"|"+Ps+")",Ts="(?:"+$n+"(?:d|ll|m|re|s|t|ve))?",Ns="(?:"+$n+"(?:D|LL|M|RE|S|T|VE))?",Cs=la+"?",$s="["+Is+"]?",fa="(?:"+Rs+"(?:"+[Os,on,wi].join("|")+")"+$s+Cs+")*",ti="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ds="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",js=$s+Cs+fa,an="(?:"+[ha,on,wi].join("|")+")"+js,da="(?:"+[Os+Li+"?",Li,on,wi,Mi].join("|")+")",jn=RegExp($n,"g"),pa=RegExp(Li,"g"),cn=RegExp(sn+"(?="+sn+")|"+da+js,"g"),Ms=RegExp([pr+"?"+Ss+"+"+Ts+"(?="+[Dn,pr,"$"].join("|")+")",Fr+"+"+Ns+"(?="+[Dn,pr+As,"$"].join("|")+")",pr+"?"+As+"+"+Ts,pr+"+"+Ns,Ds,ti,xs,an].join("|"),"g"),Ls=RegExp("["+Rs+rn+bs+Is+"]"),Ui=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Us=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ga=-1,qe={};qe[at]=qe[De]=qe[Et]=qe[Nt]=qe[kt]=qe[Ht]=qe[Dt]=qe[Gt]=qe[rr]=!0,qe[Ee]=qe[$r]=qe[Ae]=qe[D]=qe[Ue]=qe[N]=qe[I]=qe[ne]=qe[ve]=qe[Re]=qe[Ie]=qe[rt]=qe[Ce]=qe[Fe]=qe[Me]=!1;var Le={};Le[Ee]=Le[$r]=Le[Ae]=Le[Ue]=Le[D]=Le[N]=Le[at]=Le[De]=Le[Et]=Le[Nt]=Le[kt]=Le[ve]=Le[Re]=Le[Ie]=Le[rt]=Le[Ce]=Le[Fe]=Le[Ve]=Le[Ht]=Le[Dt]=Le[Gt]=Le[rr]=!0,Le[I]=Le[ne]=Le[Me]=!1;var m={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},K={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},ee={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ze=parseFloat,ge=parseInt,Ge=typeof ns=="object"&&ns&&ns.Object===Object&&ns,Rt=typeof self=="object"&&self&&self.Object===Object&&self,Se=Ge||Rt||Function("return this")(),ke=t&&!t.nodeType&&t,mt=ke&&!0&&n&&!n.nodeType&&n,ir=mt&&mt.exports===ke,At=ir&&Ge.process,Je=function(){try{var P=mt&&mt.require&&mt.require("util").types;return P||At&&At.binding&&At.binding("util")}catch{}}(),Qt=Je&&Je.isArrayBuffer,jr=Je&&Je.isDate,Ir=Je&&Je.isMap,Vr=Je&&Je.isRegExp,Mn=Je&&Je.isSet,qi=Je&&Je.isTypedArray;function jt(P,q,C){switch(C.length){case 0:return P.call(q);case 1:return P.call(q,C[0]);case 2:return P.call(q,C[0],C[1]);case 3:return P.call(q,C[0],C[1],C[2])}return P.apply(q,C)}function jd(P,q,C,te){for(var pe=-1,Ne=P==null?0:P.length;++pe<Ne;){var Ct=P[pe];q(te,Ct,C(Ct),P)}return te}function xr(P,q){for(var C=-1,te=P==null?0:P.length;++C<te&&q(P[C],C,P)!==!1;);return P}function Md(P,q){for(var C=P==null?0:P.length;C--&&q(P[C],C,P)!==!1;);return P}function gu(P,q){for(var C=-1,te=P==null?0:P.length;++C<te;)if(!q(P[C],C,P))return!1;return!0}function bi(P,q){for(var C=-1,te=P==null?0:P.length,pe=0,Ne=[];++C<te;){var Ct=P[C];q(Ct,C,P)&&(Ne[pe++]=Ct)}return Ne}function qs(P,q){var C=P==null?0:P.length;return!!C&&un(P,q,0)>-1}function ya(P,q,C){for(var te=-1,pe=P==null?0:P.length;++te<pe;)if(C(q,P[te]))return!0;return!1}function Ze(P,q){for(var C=-1,te=P==null?0:P.length,pe=Array(te);++C<te;)pe[C]=q(P[C],C,P);return pe}function _i(P,q){for(var C=-1,te=q.length,pe=P.length;++C<te;)P[pe+C]=q[C];return P}function ma(P,q,C,te){var pe=-1,Ne=P==null?0:P.length;for(te&&Ne&&(C=P[++pe]);++pe<Ne;)C=q(C,P[pe],pe,P);return C}function Ld(P,q,C,te){var pe=P==null?0:P.length;for(te&&pe&&(C=P[--pe]);pe--;)C=q(C,P[pe],pe,P);return C}function va(P,q){for(var C=-1,te=P==null?0:P.length;++C<te;)if(q(P[C],C,P))return!0;return!1}var Ud=wa("length");function qd(P){return P.split("")}function zd(P){return P.match(Ot)||[]}function yu(P,q,C){var te;return C(P,function(pe,Ne,Ct){if(q(pe,Ne,Ct))return te=Ne,!1}),te}function zs(P,q,C,te){for(var pe=P.length,Ne=C+(te?1:-1);te?Ne--:++Ne<pe;)if(q(P[Ne],Ne,P))return Ne;return-1}function un(P,q,C){return q===q?Xd(P,q,C):zs(P,mu,C)}function kd(P,q,C,te){for(var pe=C-1,Ne=P.length;++pe<Ne;)if(te(P[pe],q))return pe;return-1}function mu(P){return P!==P}function vu(P,q){var C=P==null?0:P.length;return C?_a(P,q)/C:Q}function wa(P){return function(q){return q==null?r:q[P]}}function ba(P){return function(q){return P==null?r:P[q]}}function wu(P,q,C,te,pe){return pe(P,function(Ne,Ct,He){C=te?(te=!1,Ne):q(C,Ne,Ct,He)}),C}function Hd(P,q){var C=P.length;for(P.sort(q);C--;)P[C]=P[C].value;return P}function _a(P,q){for(var C,te=-1,pe=P.length;++te<pe;){var Ne=q(P[te]);Ne!==r&&(C=C===r?Ne:C+Ne)}return C}function Ea(P,q){for(var C=-1,te=Array(P);++C<P;)te[C]=q(C);return te}function Kd(P,q){return Ze(q,function(C){return[C,P[C]]})}function bu(P){return P&&P.slice(0,xu(P)+1).replace(ft,"")}function gr(P){return function(q){return P(q)}}function Ia(P,q){return Ze(q,function(C){return P[C]})}function Ln(P,q){return P.has(q)}function _u(P,q){for(var C=-1,te=P.length;++C<te&&un(q,P[C],0)>-1;);return C}function Eu(P,q){for(var C=P.length;C--&&un(q,P[C],0)>-1;);return C}function Bd(P,q){for(var C=P.length,te=0;C--;)P[C]===q&&++te;return te}var Fd=ba(m),Vd=ba(S);function Wd(P){return"\\"+ee[P]}function Gd(P,q){return P==null?r:P[q]}function hn(P){return Ls.test(P)}function Jd(P){return Ui.test(P)}function Qd(P){for(var q,C=[];!(q=P.next()).done;)C.push(q.value);return C}function xa(P){var q=-1,C=Array(P.size);return P.forEach(function(te,pe){C[++q]=[pe,te]}),C}function Iu(P,q){return function(C){return P(q(C))}}function Ei(P,q){for(var C=-1,te=P.length,pe=0,Ne=[];++C<te;){var Ct=P[C];(Ct===q||Ct===_)&&(P[C]=_,Ne[pe++]=C)}return Ne}function ks(P){var q=-1,C=Array(P.size);return P.forEach(function(te){C[++q]=te}),C}function Yd(P){var q=-1,C=Array(P.size);return P.forEach(function(te){C[++q]=[te,te]}),C}function Xd(P,q,C){for(var te=C-1,pe=P.length;++te<pe;)if(P[te]===q)return te;return-1}function Zd(P,q,C){for(var te=C+1;te--;)if(P[te]===q)return te;return te}function ln(P){return hn(P)?tp(P):Ud(P)}function Mr(P){return hn(P)?rp(P):qd(P)}function xu(P){for(var q=P.length;q--&&yt.test(P.charAt(q)););return q}var ep=ba(K);function tp(P){for(var q=cn.lastIndex=0;cn.test(P);)++q;return q}function rp(P){return P.match(cn)||[]}function ip(P){return P.match(Ms)||[]}var np=function P(q){q=q==null?Se:fn.defaults(Se.Object(),q,fn.pick(Se,Us));var C=q.Array,te=q.Date,pe=q.Error,Ne=q.Function,Ct=q.Math,He=q.Object,Sa=q.RegExp,sp=q.String,Sr=q.TypeError,Hs=C.prototype,op=Ne.prototype,dn=He.prototype,Ks=q["__core-js_shared__"],Bs=op.toString,je=dn.hasOwnProperty,ap=0,Su=function(){var e=/[^.]+$/.exec(Ks&&Ks.keys&&Ks.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Fs=dn.toString,cp=Bs.call(He),up=Se._,hp=Sa("^"+Bs.call(je).replace(lt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Vs=ir?q.Buffer:r,Ii=q.Symbol,Ws=q.Uint8Array,Pu=Vs?Vs.allocUnsafe:r,Gs=Iu(He.getPrototypeOf,He),Ou=He.create,Ru=dn.propertyIsEnumerable,Js=Hs.splice,Au=Ii?Ii.isConcatSpreadable:r,Un=Ii?Ii.iterator:r,zi=Ii?Ii.toStringTag:r,Qs=function(){try{var e=Fi(He,"defineProperty");return e({},"",{}),e}catch{}}(),lp=q.clearTimeout!==Se.clearTimeout&&q.clearTimeout,fp=te&&te.now!==Se.Date.now&&te.now,dp=q.setTimeout!==Se.setTimeout&&q.setTimeout,Ys=Ct.ceil,Xs=Ct.floor,Pa=He.getOwnPropertySymbols,pp=Vs?Vs.isBuffer:r,Tu=q.isFinite,gp=Hs.join,yp=Iu(He.keys,He),$t=Ct.max,Ft=Ct.min,mp=te.now,vp=q.parseInt,Nu=Ct.random,wp=Hs.reverse,Oa=Fi(q,"DataView"),qn=Fi(q,"Map"),Ra=Fi(q,"Promise"),pn=Fi(q,"Set"),zn=Fi(q,"WeakMap"),kn=Fi(He,"create"),Zs=zn&&new zn,gn={},bp=Vi(Oa),_p=Vi(qn),Ep=Vi(Ra),Ip=Vi(pn),xp=Vi(zn),eo=Ii?Ii.prototype:r,Hn=eo?eo.valueOf:r,Cu=eo?eo.toString:r;function d(e){if(pt(e)&&!ye(e)&&!(e instanceof xe)){if(e instanceof Pr)return e;if(je.call(e,"__wrapped__"))return $h(e)}return new Pr(e)}var yn=function(){function e(){}return function(i){if(!st(i))return{};if(Ou)return Ou(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function to(){}function Pr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}d.templateSettings={escape:ut,evaluate:ht,interpolate:nt,variable:"",imports:{_:d}},d.prototype=to.prototype,d.prototype.constructor=d,Pr.prototype=yn(to.prototype),Pr.prototype.constructor=Pr;function xe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Y,this.__views__=[]}function Sp(){var e=new xe(this.__wrapped__);return e.__actions__=nr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=nr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=nr(this.__views__),e}function Pp(){if(this.__filtered__){var e=new xe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Op(){var e=this.__wrapped__.value(),i=this.__dir__,o=ye(e),c=i<0,l=o?e.length:0,p=qg(0,l,this.__views__),w=p.start,E=p.end,R=E-w,k=c?E:w-1,H=this.__iteratees__,F=H.length,Z=0,se=Ft(R,this.__takeCount__);if(!o||!c&&l==R&&se==R)return rh(e,this.__actions__);var he=[];e:for(;R--&&Z<se;){k+=i;for(var we=-1,le=e[k];++we<F;){var _e=H[we],Pe=_e.iteratee,vr=_e.type,Zt=Pe(le);if(vr==O)le=Zt;else if(!Zt){if(vr==b)continue e;break e}}he[Z++]=le}return he}xe.prototype=yn(to.prototype),xe.prototype.constructor=xe;function ki(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Rp(){this.__data__=kn?kn(null):{},this.size=0}function Ap(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Tp(e){var i=this.__data__;if(kn){var o=i[e];return o===v?r:o}return je.call(i,e)?i[e]:r}function Np(e){var i=this.__data__;return kn?i[e]!==r:je.call(i,e)}function Cp(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=kn&&i===r?v:i,this}ki.prototype.clear=Rp,ki.prototype.delete=Ap,ki.prototype.get=Tp,ki.prototype.has=Np,ki.prototype.set=Cp;function ri(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function $p(){this.__data__=[],this.size=0}function Dp(e){var i=this.__data__,o=ro(i,e);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():Js.call(i,o,1),--this.size,!0}function jp(e){var i=this.__data__,o=ro(i,e);return o<0?r:i[o][1]}function Mp(e){return ro(this.__data__,e)>-1}function Lp(e,i){var o=this.__data__,c=ro(o,e);return c<0?(++this.size,o.push([e,i])):o[c][1]=i,this}ri.prototype.clear=$p,ri.prototype.delete=Dp,ri.prototype.get=jp,ri.prototype.has=Mp,ri.prototype.set=Lp;function ii(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Up(){this.size=0,this.__data__={hash:new ki,map:new(qn||ri),string:new ki}}function qp(e){var i=go(this,e).delete(e);return this.size-=i?1:0,i}function zp(e){return go(this,e).get(e)}function kp(e){return go(this,e).has(e)}function Hp(e,i){var o=go(this,e),c=o.size;return o.set(e,i),this.size+=o.size==c?0:1,this}ii.prototype.clear=Up,ii.prototype.delete=qp,ii.prototype.get=zp,ii.prototype.has=kp,ii.prototype.set=Hp;function Hi(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new ii;++i<o;)this.add(e[i])}function Kp(e){return this.__data__.set(e,v),this}function Bp(e){return this.__data__.has(e)}Hi.prototype.add=Hi.prototype.push=Kp,Hi.prototype.has=Bp;function Lr(e){var i=this.__data__=new ri(e);this.size=i.size}function Fp(){this.__data__=new ri,this.size=0}function Vp(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function Wp(e){return this.__data__.get(e)}function Gp(e){return this.__data__.has(e)}function Jp(e,i){var o=this.__data__;if(o instanceof ri){var c=o.__data__;if(!qn||c.length<a-1)return c.push([e,i]),this.size=++o.size,this;o=this.__data__=new ii(c)}return o.set(e,i),this.size=o.size,this}Lr.prototype.clear=Fp,Lr.prototype.delete=Vp,Lr.prototype.get=Wp,Lr.prototype.has=Gp,Lr.prototype.set=Jp;function $u(e,i){var o=ye(e),c=!o&&Wi(e),l=!o&&!c&&Ri(e),p=!o&&!c&&!l&&bn(e),w=o||c||l||p,E=w?Ea(e.length,sp):[],R=E.length;for(var k in e)(i||je.call(e,k))&&!(w&&(k=="length"||l&&(k=="offset"||k=="parent")||p&&(k=="buffer"||k=="byteLength"||k=="byteOffset")||ai(k,R)))&&E.push(k);return E}function Du(e){var i=e.length;return i?e[qa(0,i-1)]:r}function Qp(e,i){return yo(nr(e),Ki(i,0,e.length))}function Yp(e){return yo(nr(e))}function Aa(e,i,o){(o!==r&&!Ur(e[i],o)||o===r&&!(i in e))&&ni(e,i,o)}function Kn(e,i,o){var c=e[i];(!(je.call(e,i)&&Ur(c,o))||o===r&&!(i in e))&&ni(e,i,o)}function ro(e,i){for(var o=e.length;o--;)if(Ur(e[o][0],i))return o;return-1}function Xp(e,i,o,c){return xi(e,function(l,p,w){i(c,l,o(l),w)}),c}function ju(e,i){return e&&Gr(i,Mt(i),e)}function Zp(e,i){return e&&Gr(i,or(i),e)}function ni(e,i,o){i=="__proto__"&&Qs?Qs(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function Ta(e,i){for(var o=-1,c=i.length,l=C(c),p=e==null;++o<c;)l[o]=p?r:hc(e,i[o]);return l}function Ki(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Or(e,i,o,c,l,p){var w,E=i&x,R=i&M,k=i&z;if(o&&(w=l?o(e,c,l,p):o(e)),w!==r)return w;if(!st(e))return e;var H=ye(e);if(H){if(w=kg(e),!E)return nr(e,w)}else{var F=Vt(e),Z=F==ne||F==fe;if(Ri(e))return sh(e,E);if(F==Ie||F==Ee||Z&&!l){if(w=R||Z?{}:xh(e),!E)return R?Tg(e,Zp(w,e)):Ag(e,ju(w,e))}else{if(!Le[F])return l?e:{};w=Hg(e,F,E)}}p||(p=new Lr);var se=p.get(e);if(se)return se;p.set(e,w),Zh(e)?e.forEach(function(le){w.add(Or(le,i,o,le,e,p))}):Yh(e)&&e.forEach(function(le,_e){w.set(_e,Or(le,i,o,_e,e,p))});var he=k?R?Qa:Ja:R?or:Mt,we=H?r:he(e);return xr(we||e,function(le,_e){we&&(_e=le,le=e[_e]),Kn(w,_e,Or(le,i,o,_e,e,p))}),w}function eg(e){var i=Mt(e);return function(o){return Mu(o,e,i)}}function Mu(e,i,o){var c=o.length;if(e==null)return!c;for(e=He(e);c--;){var l=o[c],p=i[l],w=e[l];if(w===r&&!(l in e)||!p(w))return!1}return!0}function Lu(e,i,o){if(typeof e!="function")throw new Sr(f);return Qn(function(){e.apply(r,o)},i)}function Bn(e,i,o,c){var l=-1,p=qs,w=!0,E=e.length,R=[],k=i.length;if(!E)return R;o&&(i=Ze(i,gr(o))),c?(p=ya,w=!1):i.length>=a&&(p=Ln,w=!1,i=new Hi(i));e:for(;++l<E;){var H=e[l],F=o==null?H:o(H);if(H=c||H!==0?H:0,w&&F===F){for(var Z=k;Z--;)if(i[Z]===F)continue e;R.push(H)}else p(i,F,c)||R.push(H)}return R}var xi=hh(Wr),Uu=hh(Ca,!0);function tg(e,i){var o=!0;return xi(e,function(c,l,p){return o=!!i(c,l,p),o}),o}function io(e,i,o){for(var c=-1,l=e.length;++c<l;){var p=e[c],w=i(p);if(w!=null&&(E===r?w===w&&!mr(w):o(w,E)))var E=w,R=p}return R}function rg(e,i,o,c){var l=e.length;for(o=me(o),o<0&&(o=-o>l?0:l+o),c=c===r||c>l?l:me(c),c<0&&(c+=l),c=o>c?0:tl(c);o<c;)e[o++]=i;return e}function qu(e,i){var o=[];return xi(e,function(c,l,p){i(c,l,p)&&o.push(c)}),o}function Kt(e,i,o,c,l){var p=-1,w=e.length;for(o||(o=Bg),l||(l=[]);++p<w;){var E=e[p];i>0&&o(E)?i>1?Kt(E,i-1,o,c,l):_i(l,E):c||(l[l.length]=E)}return l}var Na=lh(),zu=lh(!0);function Wr(e,i){return e&&Na(e,i,Mt)}function Ca(e,i){return e&&zu(e,i,Mt)}function no(e,i){return bi(i,function(o){return ci(e[o])})}function Bi(e,i){i=Pi(i,e);for(var o=0,c=i.length;e!=null&&o<c;)e=e[Jr(i[o++])];return o&&o==c?e:r}function ku(e,i,o){var c=i(e);return ye(e)?c:_i(c,o(e))}function Yt(e){return e==null?e===r?it:Te:zi&&zi in He(e)?Ug(e):Yg(e)}function $a(e,i){return e>i}function ig(e,i){return e!=null&&je.call(e,i)}function ng(e,i){return e!=null&&i in He(e)}function sg(e,i,o){return e>=Ft(i,o)&&e<$t(i,o)}function Da(e,i,o){for(var c=o?ya:qs,l=e[0].length,p=e.length,w=p,E=C(p),R=1/0,k=[];w--;){var H=e[w];w&&i&&(H=Ze(H,gr(i))),R=Ft(H.length,R),E[w]=!o&&(i||l>=120&&H.length>=120)?new Hi(w&&H):r}H=e[0];var F=-1,Z=E[0];e:for(;++F<l&&k.length<R;){var se=H[F],he=i?i(se):se;if(se=o||se!==0?se:0,!(Z?Ln(Z,he):c(k,he,o))){for(w=p;--w;){var we=E[w];if(!(we?Ln(we,he):c(e[w],he,o)))continue e}Z&&Z.push(he),k.push(se)}}return k}function og(e,i,o,c){return Wr(e,function(l,p,w){i(c,o(l),p,w)}),c}function Fn(e,i,o){i=Pi(i,e),e=Rh(e,i);var c=e==null?e:e[Jr(Ar(i))];return c==null?r:jt(c,e,o)}function Hu(e){return pt(e)&&Yt(e)==Ee}function ag(e){return pt(e)&&Yt(e)==Ae}function cg(e){return pt(e)&&Yt(e)==N}function Vn(e,i,o,c,l){return e===i?!0:e==null||i==null||!pt(e)&&!pt(i)?e!==e&&i!==i:ug(e,i,o,c,Vn,l)}function ug(e,i,o,c,l,p){var w=ye(e),E=ye(i),R=w?$r:Vt(e),k=E?$r:Vt(i);R=R==Ee?Ie:R,k=k==Ee?Ie:k;var H=R==Ie,F=k==Ie,Z=R==k;if(Z&&Ri(e)){if(!Ri(i))return!1;w=!0,H=!1}if(Z&&!H)return p||(p=new Lr),w||bn(e)?_h(e,i,o,c,l,p):Mg(e,i,R,o,c,l,p);if(!(o&T)){var se=H&&je.call(e,"__wrapped__"),he=F&&je.call(i,"__wrapped__");if(se||he){var we=se?e.value():e,le=he?i.value():i;return p||(p=new Lr),l(we,le,o,c,p)}}return Z?(p||(p=new Lr),Lg(e,i,o,c,l,p)):!1}function hg(e){return pt(e)&&Vt(e)==ve}function ja(e,i,o,c){var l=o.length,p=l,w=!c;if(e==null)return!p;for(e=He(e);l--;){var E=o[l];if(w&&E[2]?E[1]!==e[E[0]]:!(E[0]in e))return!1}for(;++l<p;){E=o[l];var R=E[0],k=e[R],H=E[1];if(w&&E[2]){if(k===r&&!(R in e))return!1}else{var F=new Lr;if(c)var Z=c(k,H,R,e,i,F);if(!(Z===r?Vn(H,k,T|re,c,F):Z))return!1}}return!0}function Ku(e){if(!st(e)||Vg(e))return!1;var i=ci(e)?hp:ea;return i.test(Vi(e))}function lg(e){return pt(e)&&Yt(e)==rt}function fg(e){return pt(e)&&Vt(e)==Ce}function dg(e){return pt(e)&&Eo(e.length)&&!!qe[Yt(e)]}function Bu(e){return typeof e=="function"?e:e==null?ar:typeof e=="object"?ye(e)?Wu(e[0],e[1]):Vu(e):fl(e)}function Ma(e){if(!Jn(e))return yp(e);var i=[];for(var o in He(e))je.call(e,o)&&o!="constructor"&&i.push(o);return i}function pg(e){if(!st(e))return Qg(e);var i=Jn(e),o=[];for(var c in e)c=="constructor"&&(i||!je.call(e,c))||o.push(c);return o}function La(e,i){return e<i}function Fu(e,i){var o=-1,c=sr(e)?C(e.length):[];return xi(e,function(l,p,w){c[++o]=i(l,p,w)}),c}function Vu(e){var i=Xa(e);return i.length==1&&i[0][2]?Ph(i[0][0],i[0][1]):function(o){return o===e||ja(o,e,i)}}function Wu(e,i){return ec(e)&&Sh(i)?Ph(Jr(e),i):function(o){var c=hc(o,e);return c===r&&c===i?lc(o,e):Vn(i,c,T|re)}}function so(e,i,o,c,l){e!==i&&Na(i,function(p,w){if(l||(l=new Lr),st(p))gg(e,i,w,o,so,c,l);else{var E=c?c(rc(e,w),p,w+"",e,i,l):r;E===r&&(E=p),Aa(e,w,E)}},or)}function gg(e,i,o,c,l,p,w){var E=rc(e,o),R=rc(i,o),k=w.get(R);if(k){Aa(e,o,k);return}var H=p?p(E,R,o+"",e,i,w):r,F=H===r;if(F){var Z=ye(R),se=!Z&&Ri(R),he=!Z&&!se&&bn(R);H=R,Z||se||he?ye(E)?H=E:vt(E)?H=nr(E):se?(F=!1,H=sh(R,!0)):he?(F=!1,H=oh(R,!0)):H=[]:Yn(R)||Wi(R)?(H=E,Wi(E)?H=rl(E):(!st(E)||ci(E))&&(H=xh(R))):F=!1}F&&(w.set(R,H),l(H,R,c,p,w),w.delete(R)),Aa(e,o,H)}function Gu(e,i){var o=e.length;if(o)return i+=i<0?o:0,ai(i,o)?e[i]:r}function Ju(e,i,o){i.length?i=Ze(i,function(p){return ye(p)?function(w){return Bi(w,p.length===1?p[0]:p)}:p}):i=[ar];var c=-1;i=Ze(i,gr(ue()));var l=Fu(e,function(p,w,E){var R=Ze(i,function(k){return k(p)});return{criteria:R,index:++c,value:p}});return Hd(l,function(p,w){return Rg(p,w,o)})}function yg(e,i){return Qu(e,i,function(o,c){return lc(e,c)})}function Qu(e,i,o){for(var c=-1,l=i.length,p={};++c<l;){var w=i[c],E=Bi(e,w);o(E,w)&&Wn(p,Pi(w,e),E)}return p}function mg(e){return function(i){return Bi(i,e)}}function Ua(e,i,o,c){var l=c?kd:un,p=-1,w=i.length,E=e;for(e===i&&(i=nr(i)),o&&(E=Ze(e,gr(o)));++p<w;)for(var R=0,k=i[p],H=o?o(k):k;(R=l(E,H,R,c))>-1;)E!==e&&Js.call(E,R,1),Js.call(e,R,1);return e}function Yu(e,i){for(var o=e?i.length:0,c=o-1;o--;){var l=i[o];if(o==c||l!==p){var p=l;ai(l)?Js.call(e,l,1):Ha(e,l)}}return e}function qa(e,i){return e+Xs(Nu()*(i-e+1))}function vg(e,i,o,c){for(var l=-1,p=$t(Ys((i-e)/(o||1)),0),w=C(p);p--;)w[c?p:++l]=e,e+=o;return w}function za(e,i){var o="";if(!e||i<1||i>G)return o;do i%2&&(o+=e),i=Xs(i/2),i&&(e+=e);while(i);return o}function be(e,i){return ic(Oh(e,i,ar),e+"")}function wg(e){return Du(_n(e))}function bg(e,i){var o=_n(e);return yo(o,Ki(i,0,o.length))}function Wn(e,i,o,c){if(!st(e))return e;i=Pi(i,e);for(var l=-1,p=i.length,w=p-1,E=e;E!=null&&++l<p;){var R=Jr(i[l]),k=o;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(l!=w){var H=E[R];k=c?c(H,R,E):r,k===r&&(k=st(H)?H:ai(i[l+1])?[]:{})}Kn(E,R,k),E=E[R]}return e}var Xu=Zs?function(e,i){return Zs.set(e,i),e}:ar,_g=Qs?function(e,i){return Qs(e,"toString",{configurable:!0,enumerable:!1,value:dc(i),writable:!0})}:ar;function Eg(e){return yo(_n(e))}function Rr(e,i,o){var c=-1,l=e.length;i<0&&(i=-i>l?0:l+i),o=o>l?l:o,o<0&&(o+=l),l=i>o?0:o-i>>>0,i>>>=0;for(var p=C(l);++c<l;)p[c]=e[c+i];return p}function Ig(e,i){var o;return xi(e,function(c,l,p){return o=i(c,l,p),!o}),!!o}function oo(e,i,o){var c=0,l=e==null?c:e.length;if(typeof i=="number"&&i===i&&l<=ot){for(;c<l;){var p=c+l>>>1,w=e[p];w!==null&&!mr(w)&&(o?w<=i:w<i)?c=p+1:l=p}return l}return ka(e,i,ar,o)}function ka(e,i,o,c){var l=0,p=e==null?0:e.length;if(p===0)return 0;i=o(i);for(var w=i!==i,E=i===null,R=mr(i),k=i===r;l<p;){var H=Xs((l+p)/2),F=o(e[H]),Z=F!==r,se=F===null,he=F===F,we=mr(F);if(w)var le=c||he;else k?le=he&&(c||Z):E?le=he&&Z&&(c||!se):R?le=he&&Z&&!se&&(c||!we):se||we?le=!1:le=c?F<=i:F<i;le?l=H+1:p=H}return Ft(p,tt)}function Zu(e,i){for(var o=-1,c=e.length,l=0,p=[];++o<c;){var w=e[o],E=i?i(w):w;if(!o||!Ur(E,R)){var R=E;p[l++]=w===0?0:w}}return p}function eh(e){return typeof e=="number"?e:mr(e)?Q:+e}function yr(e){if(typeof e=="string")return e;if(ye(e))return Ze(e,yr)+"";if(mr(e))return Cu?Cu.call(e):"";var i=e+"";return i=="0"&&1/e==-de?"-0":i}function Si(e,i,o){var c=-1,l=qs,p=e.length,w=!0,E=[],R=E;if(o)w=!1,l=ya;else if(p>=a){var k=i?null:Dg(e);if(k)return ks(k);w=!1,l=Ln,R=new Hi}else R=i?[]:E;e:for(;++c<p;){var H=e[c],F=i?i(H):H;if(H=o||H!==0?H:0,w&&F===F){for(var Z=R.length;Z--;)if(R[Z]===F)continue e;i&&R.push(F),E.push(H)}else l(R,F,o)||(R!==E&&R.push(F),E.push(H))}return E}function Ha(e,i){return i=Pi(i,e),e=Rh(e,i),e==null||delete e[Jr(Ar(i))]}function th(e,i,o,c){return Wn(e,i,o(Bi(e,i)),c)}function ao(e,i,o,c){for(var l=e.length,p=c?l:-1;(c?p--:++p<l)&&i(e[p],p,e););return o?Rr(e,c?0:p,c?p+1:l):Rr(e,c?p+1:0,c?l:p)}function rh(e,i){var o=e;return o instanceof xe&&(o=o.value()),ma(i,function(c,l){return l.func.apply(l.thisArg,_i([c],l.args))},o)}function Ka(e,i,o){var c=e.length;if(c<2)return c?Si(e[0]):[];for(var l=-1,p=C(c);++l<c;)for(var w=e[l],E=-1;++E<c;)E!=l&&(p[l]=Bn(p[l]||w,e[E],i,o));return Si(Kt(p,1),i,o)}function ih(e,i,o){for(var c=-1,l=e.length,p=i.length,w={};++c<l;){var E=c<p?i[c]:r;o(w,e[c],E)}return w}function Ba(e){return vt(e)?e:[]}function Fa(e){return typeof e=="function"?e:ar}function Pi(e,i){return ye(e)?e:ec(e,i)?[e]:Ch($e(e))}var xg=be;function Oi(e,i,o){var c=e.length;return o=o===r?c:o,!i&&o>=c?e:Rr(e,i,o)}var nh=lp||function(e){return Se.clearTimeout(e)};function sh(e,i){if(i)return e.slice();var o=e.length,c=Pu?Pu(o):new e.constructor(o);return e.copy(c),c}function Va(e){var i=new e.constructor(e.byteLength);return new Ws(i).set(new Ws(e)),i}function Sg(e,i){var o=i?Va(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function Pg(e){var i=new e.constructor(e.source,Er.exec(e));return i.lastIndex=e.lastIndex,i}function Og(e){return Hn?He(Hn.call(e)):{}}function oh(e,i){var o=i?Va(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function ah(e,i){if(e!==i){var o=e!==r,c=e===null,l=e===e,p=mr(e),w=i!==r,E=i===null,R=i===i,k=mr(i);if(!E&&!k&&!p&&e>i||p&&w&&R&&!E&&!k||c&&w&&R||!o&&R||!l)return 1;if(!c&&!p&&!k&&e<i||k&&o&&l&&!c&&!p||E&&o&&l||!w&&l||!R)return-1}return 0}function Rg(e,i,o){for(var c=-1,l=e.criteria,p=i.criteria,w=l.length,E=o.length;++c<w;){var R=ah(l[c],p[c]);if(R){if(c>=E)return R;var k=o[c];return R*(k=="desc"?-1:1)}}return e.index-i.index}function ch(e,i,o,c){for(var l=-1,p=e.length,w=o.length,E=-1,R=i.length,k=$t(p-w,0),H=C(R+k),F=!c;++E<R;)H[E]=i[E];for(;++l<w;)(F||l<p)&&(H[o[l]]=e[l]);for(;k--;)H[E++]=e[l++];return H}function uh(e,i,o,c){for(var l=-1,p=e.length,w=-1,E=o.length,R=-1,k=i.length,H=$t(p-E,0),F=C(H+k),Z=!c;++l<H;)F[l]=e[l];for(var se=l;++R<k;)F[se+R]=i[R];for(;++w<E;)(Z||l<p)&&(F[se+o[w]]=e[l++]);return F}function nr(e,i){var o=-1,c=e.length;for(i||(i=C(c));++o<c;)i[o]=e[o];return i}function Gr(e,i,o,c){var l=!o;o||(o={});for(var p=-1,w=i.length;++p<w;){var E=i[p],R=c?c(o[E],e[E],E,o,e):r;R===r&&(R=e[E]),l?ni(o,E,R):Kn(o,E,R)}return o}function Ag(e,i){return Gr(e,Za(e),i)}function Tg(e,i){return Gr(e,Eh(e),i)}function co(e,i){return function(o,c){var l=ye(o)?jd:Xp,p=i?i():{};return l(o,e,ue(c,2),p)}}function mn(e){return be(function(i,o){var c=-1,l=o.length,p=l>1?o[l-1]:r,w=l>2?o[2]:r;for(p=e.length>3&&typeof p=="function"?(l--,p):r,w&&Xt(o[0],o[1],w)&&(p=l<3?r:p,l=1),i=He(i);++c<l;){var E=o[c];E&&e(i,E,c,p)}return i})}function hh(e,i){return function(o,c){if(o==null)return o;if(!sr(o))return e(o,c);for(var l=o.length,p=i?l:-1,w=He(o);(i?p--:++p<l)&&c(w[p],p,w)!==!1;);return o}}function lh(e){return function(i,o,c){for(var l=-1,p=He(i),w=c(i),E=w.length;E--;){var R=w[e?E:++l];if(o(p[R],R,p)===!1)break}return i}}function Ng(e,i,o){var c=i&ae,l=Gn(e);function p(){var w=this&&this!==Se&&this instanceof p?l:e;return w.apply(c?o:this,arguments)}return p}function fh(e){return function(i){i=$e(i);var o=hn(i)?Mr(i):r,c=o?o[0]:i.charAt(0),l=o?Oi(o,1).join(""):i.slice(1);return c[e]()+l}}function vn(e){return function(i){return ma(hl(ul(i).replace(jn,"")),e,"")}}function Gn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=yn(e.prototype),c=e.apply(o,i);return st(c)?c:o}}function Cg(e,i,o){var c=Gn(e);function l(){for(var p=arguments.length,w=C(p),E=p,R=wn(l);E--;)w[E]=arguments[E];var k=p<3&&w[0]!==R&&w[p-1]!==R?[]:Ei(w,R);if(p-=k.length,p<o)return mh(e,i,uo,l.placeholder,r,w,k,r,r,o-p);var H=this&&this!==Se&&this instanceof l?c:e;return jt(H,this,w)}return l}function dh(e){return function(i,o,c){var l=He(i);if(!sr(i)){var p=ue(o,3);i=Mt(i),o=function(E){return p(l[E],E,l)}}var w=e(i,o,c);return w>-1?l[p?i[w]:w]:r}}function ph(e){return oi(function(i){var o=i.length,c=o,l=Pr.prototype.thru;for(e&&i.reverse();c--;){var p=i[c];if(typeof p!="function")throw new Sr(f);if(l&&!w&&po(p)=="wrapper")var w=new Pr([],!0)}for(c=w?c:o;++c<o;){p=i[c];var E=po(p),R=E=="wrapper"?Ya(p):r;R&&tc(R[0])&&R[1]==(W|$|U|J)&&!R[4].length&&R[9]==1?w=w[po(R[0])].apply(w,R[3]):w=p.length==1&&tc(p)?w[E]():w.thru(p)}return function(){var k=arguments,H=k[0];if(w&&k.length==1&&ye(H))return w.plant(H).value();for(var F=0,Z=o?i[F].apply(this,k):H;++F<o;)Z=i[F].call(this,Z);return Z}})}function uo(e,i,o,c,l,p,w,E,R,k){var H=i&W,F=i&ae,Z=i&ce,se=i&($|j),he=i&Oe,we=Z?r:Gn(e);function le(){for(var _e=arguments.length,Pe=C(_e),vr=_e;vr--;)Pe[vr]=arguments[vr];if(se)var Zt=wn(le),wr=Bd(Pe,Zt);if(c&&(Pe=ch(Pe,c,l,se)),p&&(Pe=uh(Pe,p,w,se)),_e-=wr,se&&_e<k){var wt=Ei(Pe,Zt);return mh(e,i,uo,le.placeholder,o,Pe,wt,E,R,k-_e)}var qr=F?o:this,hi=Z?qr[e]:e;return _e=Pe.length,E?Pe=Xg(Pe,E):he&&_e>1&&Pe.reverse(),H&&R<_e&&(Pe.length=R),this&&this!==Se&&this instanceof le&&(hi=we||Gn(hi)),hi.apply(qr,Pe)}return le}function gh(e,i){return function(o,c){return og(o,e,i(c),{})}}function ho(e,i){return function(o,c){var l;if(o===r&&c===r)return i;if(o!==r&&(l=o),c!==r){if(l===r)return c;typeof o=="string"||typeof c=="string"?(o=yr(o),c=yr(c)):(o=eh(o),c=eh(c)),l=e(o,c)}return l}}function Wa(e){return oi(function(i){return i=Ze(i,gr(ue())),be(function(o){var c=this;return e(i,function(l){return jt(l,c,o)})})})}function lo(e,i){i=i===r?" ":yr(i);var o=i.length;if(o<2)return o?za(i,e):i;var c=za(i,Ys(e/ln(i)));return hn(i)?Oi(Mr(c),0,e).join(""):c.slice(0,e)}function $g(e,i,o,c){var l=i&ae,p=Gn(e);function w(){for(var E=-1,R=arguments.length,k=-1,H=c.length,F=C(H+R),Z=this&&this!==Se&&this instanceof w?p:e;++k<H;)F[k]=c[k];for(;R--;)F[k++]=arguments[++E];return jt(Z,l?o:this,F)}return w}function yh(e){return function(i,o,c){return c&&typeof c!="number"&&Xt(i,o,c)&&(o=c=r),i=ui(i),o===r?(o=i,i=0):o=ui(o),c=c===r?i<o?1:-1:ui(c),vg(i,o,c,e)}}function fo(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Tr(i),o=Tr(o)),e(i,o)}}function mh(e,i,o,c,l,p,w,E,R,k){var H=i&$,F=H?w:r,Z=H?r:w,se=H?p:r,he=H?r:p;i|=H?U:B,i&=~(H?B:U),i&A||(i&=~(ae|ce));var we=[e,i,l,se,F,he,Z,E,R,k],le=o.apply(r,we);return tc(e)&&Ah(le,we),le.placeholder=c,Th(le,e,i)}function Ga(e){var i=Ct[e];return function(o,c){if(o=Tr(o),c=c==null?0:Ft(me(c),292),c&&Tu(o)){var l=($e(o)+"e").split("e"),p=i(l[0]+"e"+(+l[1]+c));return l=($e(p)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return i(o)}}var Dg=pn&&1/ks(new pn([,-0]))[1]==de?function(e){return new pn(e)}:yc;function vh(e){return function(i){var o=Vt(i);return o==ve?xa(i):o==Ce?Yd(i):Kd(i,e(i))}}function si(e,i,o,c,l,p,w,E){var R=i&ce;if(!R&&typeof e!="function")throw new Sr(f);var k=c?c.length:0;if(k||(i&=~(U|B),c=l=r),w=w===r?w:$t(me(w),0),E=E===r?E:me(E),k-=l?l.length:0,i&B){var H=c,F=l;c=l=r}var Z=R?r:Ya(e),se=[e,i,o,c,l,H,F,p,w,E];if(Z&&Jg(se,Z),e=se[0],i=se[1],o=se[2],c=se[3],l=se[4],E=se[9]=se[9]===r?R?0:e.length:$t(se[9]-k,0),!E&&i&($|j)&&(i&=~($|j)),!i||i==ae)var he=Ng(e,i,o);else i==$||i==j?he=Cg(e,i,E):(i==U||i==(ae|U))&&!l.length?he=$g(e,i,o,c):he=uo.apply(r,se);var we=Z?Xu:Ah;return Th(we(he,se),e,i)}function wh(e,i,o,c){return e===r||Ur(e,dn[o])&&!je.call(c,o)?i:e}function bh(e,i,o,c,l,p){return st(e)&&st(i)&&(p.set(i,e),so(e,i,r,bh,p),p.delete(i)),e}function jg(e){return Yn(e)?r:e}function _h(e,i,o,c,l,p){var w=o&T,E=e.length,R=i.length;if(E!=R&&!(w&&R>E))return!1;var k=p.get(e),H=p.get(i);if(k&&H)return k==i&&H==e;var F=-1,Z=!0,se=o&re?new Hi:r;for(p.set(e,i),p.set(i,e);++F<E;){var he=e[F],we=i[F];if(c)var le=w?c(we,he,F,i,e,p):c(he,we,F,e,i,p);if(le!==r){if(le)continue;Z=!1;break}if(se){if(!va(i,function(_e,Pe){if(!Ln(se,Pe)&&(he===_e||l(he,_e,o,c,p)))return se.push(Pe)})){Z=!1;break}}else if(!(he===we||l(he,we,o,c,p))){Z=!1;break}}return p.delete(e),p.delete(i),Z}function Mg(e,i,o,c,l,p,w){switch(o){case Ue:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ae:return!(e.byteLength!=i.byteLength||!p(new Ws(e),new Ws(i)));case D:case N:case Re:return Ur(+e,+i);case I:return e.name==i.name&&e.message==i.message;case rt:case Fe:return e==i+"";case ve:var E=xa;case Ce:var R=c&T;if(E||(E=ks),e.size!=i.size&&!R)return!1;var k=w.get(e);if(k)return k==i;c|=re,w.set(e,i);var H=_h(E(e),E(i),c,l,p,w);return w.delete(e),H;case Ve:if(Hn)return Hn.call(e)==Hn.call(i)}return!1}function Lg(e,i,o,c,l,p){var w=o&T,E=Ja(e),R=E.length,k=Ja(i),H=k.length;if(R!=H&&!w)return!1;for(var F=R;F--;){var Z=E[F];if(!(w?Z in i:je.call(i,Z)))return!1}var se=p.get(e),he=p.get(i);if(se&&he)return se==i&&he==e;var we=!0;p.set(e,i),p.set(i,e);for(var le=w;++F<R;){Z=E[F];var _e=e[Z],Pe=i[Z];if(c)var vr=w?c(Pe,_e,Z,i,e,p):c(_e,Pe,Z,e,i,p);if(!(vr===r?_e===Pe||l(_e,Pe,o,c,p):vr)){we=!1;break}le||(le=Z=="constructor")}if(we&&!le){var Zt=e.constructor,wr=i.constructor;Zt!=wr&&"constructor"in e&&"constructor"in i&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof wr=="function"&&wr instanceof wr)&&(we=!1)}return p.delete(e),p.delete(i),we}function oi(e){return ic(Oh(e,r,Mh),e+"")}function Ja(e){return ku(e,Mt,Za)}function Qa(e){return ku(e,or,Eh)}var Ya=Zs?function(e){return Zs.get(e)}:yc;function po(e){for(var i=e.name+"",o=gn[i],c=je.call(gn,i)?o.length:0;c--;){var l=o[c],p=l.func;if(p==null||p==e)return l.name}return i}function wn(e){var i=je.call(d,"placeholder")?d:e;return i.placeholder}function ue(){var e=d.iteratee||pc;return e=e===pc?Bu:e,arguments.length?e(arguments[0],arguments[1]):e}function go(e,i){var o=e.__data__;return Fg(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Xa(e){for(var i=Mt(e),o=i.length;o--;){var c=i[o],l=e[c];i[o]=[c,l,Sh(l)]}return i}function Fi(e,i){var o=Gd(e,i);return Ku(o)?o:r}function Ug(e){var i=je.call(e,zi),o=e[zi];try{e[zi]=r;var c=!0}catch{}var l=Fs.call(e);return c&&(i?e[zi]=o:delete e[zi]),l}var Za=Pa?function(e){return e==null?[]:(e=He(e),bi(Pa(e),function(i){return Ru.call(e,i)}))}:mc,Eh=Pa?function(e){for(var i=[];e;)_i(i,Za(e)),e=Gs(e);return i}:mc,Vt=Yt;(Oa&&Vt(new Oa(new ArrayBuffer(1)))!=Ue||qn&&Vt(new qn)!=ve||Ra&&Vt(Ra.resolve())!=_t||pn&&Vt(new pn)!=Ce||zn&&Vt(new zn)!=Me)&&(Vt=function(e){var i=Yt(e),o=i==Ie?e.constructor:r,c=o?Vi(o):"";if(c)switch(c){case bp:return Ue;case _p:return ve;case Ep:return _t;case Ip:return Ce;case xp:return Me}return i});function qg(e,i,o){for(var c=-1,l=o.length;++c<l;){var p=o[c],w=p.size;switch(p.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=Ft(i,e+w);break;case"takeRight":e=$t(e,i-w);break}}return{start:e,end:i}}function zg(e){var i=e.match(Ke);return i?i[1].split(Pt):[]}function Ih(e,i,o){i=Pi(i,e);for(var c=-1,l=i.length,p=!1;++c<l;){var w=Jr(i[c]);if(!(p=e!=null&&o(e,w)))break;e=e[w]}return p||++c!=l?p:(l=e==null?0:e.length,!!l&&Eo(l)&&ai(w,l)&&(ye(e)||Wi(e)))}function kg(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&je.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function xh(e){return typeof e.constructor=="function"&&!Jn(e)?yn(Gs(e)):{}}function Hg(e,i,o){var c=e.constructor;switch(i){case Ae:return Va(e);case D:case N:return new c(+e);case Ue:return Sg(e,o);case at:case De:case Et:case Nt:case kt:case Ht:case Dt:case Gt:case rr:return oh(e,o);case ve:return new c;case Re:case Fe:return new c(e);case rt:return Pg(e);case Ce:return new c;case Ve:return Og(e)}}function Kg(e,i){var o=i.length;if(!o)return e;var c=o-1;return i[c]=(o>1?"& ":"")+i[c],i=i.join(o>2?", ":" "),e.replace(dt,`{
/* [wrapped with `+i+`] */
`)}function Bg(e){return ye(e)||Wi(e)||!!(Au&&e&&e[Au])}function ai(e,i){var o=typeof e;return i=i??G,!!i&&(o=="number"||o!="symbol"&&ra.test(e))&&e>-1&&e%1==0&&e<i}function Xt(e,i,o){if(!st(o))return!1;var c=typeof i;return(c=="number"?sr(o)&&ai(i,o.length):c=="string"&&i in o)?Ur(o[i],e):!1}function ec(e,i){if(ye(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||mr(e)?!0:It.test(e)||!Xe.test(e)||i!=null&&e in He(i)}function Fg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function tc(e){var i=po(e),o=d[i];if(typeof o!="function"||!(i in xe.prototype))return!1;if(e===o)return!0;var c=Ya(o);return!!c&&e===c[0]}function Vg(e){return!!Su&&Su in e}var Wg=Ks?ci:vc;function Jn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||dn;return e===o}function Sh(e){return e===e&&!st(e)}function Ph(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in He(o))}}function Gg(e){var i=bo(e,function(c){return o.size===y&&o.clear(),c}),o=i.cache;return i}function Jg(e,i){var o=e[1],c=i[1],l=o|c,p=l<(ae|ce|W),w=c==W&&o==$||c==W&&o==J&&e[7].length<=i[8]||c==(W|J)&&i[7].length<=i[8]&&o==$;if(!(p||w))return e;c&ae&&(e[2]=i[2],l|=o&ae?0:A);var E=i[3];if(E){var R=e[3];e[3]=R?ch(R,E,i[4]):E,e[4]=R?Ei(e[3],_):i[4]}return E=i[5],E&&(R=e[5],e[5]=R?uh(R,E,i[6]):E,e[6]=R?Ei(e[5],_):i[6]),E=i[7],E&&(e[7]=E),c&W&&(e[8]=e[8]==null?i[8]:Ft(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function Qg(e){var i=[];if(e!=null)for(var o in He(e))i.push(o);return i}function Yg(e){return Fs.call(e)}function Oh(e,i,o){return i=$t(i===r?e.length-1:i,0),function(){for(var c=arguments,l=-1,p=$t(c.length-i,0),w=C(p);++l<p;)w[l]=c[i+l];l=-1;for(var E=C(i+1);++l<i;)E[l]=c[l];return E[i]=o(w),jt(e,this,E)}}function Rh(e,i){return i.length<2?e:Bi(e,Rr(i,0,-1))}function Xg(e,i){for(var o=e.length,c=Ft(i.length,o),l=nr(e);c--;){var p=i[c];e[c]=ai(p,o)?l[p]:r}return e}function rc(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Ah=Nh(Xu),Qn=dp||function(e,i){return Se.setTimeout(e,i)},ic=Nh(_g);function Th(e,i,o){var c=i+"";return ic(e,Kg(c,Zg(zg(c),o)))}function Nh(e){var i=0,o=0;return function(){var c=mp(),l=zt-(c-o);if(o=c,l>0){if(++i>=qt)return arguments[0]}else i=0;return e.apply(r,arguments)}}function yo(e,i){var o=-1,c=e.length,l=c-1;for(i=i===r?c:i;++o<i;){var p=qa(o,l),w=e[p];e[p]=e[o],e[o]=w}return e.length=i,e}var Ch=Gg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(xt,function(o,c,l,p){i.push(l?p.replace(Qo,"$1"):c||o)}),i});function Jr(e){if(typeof e=="string"||mr(e))return e;var i=e+"";return i=="0"&&1/e==-de?"-0":i}function Vi(e){if(e!=null){try{return Bs.call(e)}catch{}try{return e+""}catch{}}return""}function Zg(e,i){return xr($i,function(o){var c="_."+o[0];i&o[1]&&!qs(e,c)&&e.push(c)}),e.sort()}function $h(e){if(e instanceof xe)return e.clone();var i=new Pr(e.__wrapped__,e.__chain__);return i.__actions__=nr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function ey(e,i,o){(o?Xt(e,i,o):i===r)?i=1:i=$t(me(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var l=0,p=0,w=C(Ys(c/i));l<c;)w[p++]=Rr(e,l,l+=i);return w}function ty(e){for(var i=-1,o=e==null?0:e.length,c=0,l=[];++i<o;){var p=e[i];p&&(l[c++]=p)}return l}function ry(){var e=arguments.length;if(!e)return[];for(var i=C(e-1),o=arguments[0],c=e;c--;)i[c-1]=arguments[c];return _i(ye(o)?nr(o):[o],Kt(i,1))}var iy=be(function(e,i){return vt(e)?Bn(e,Kt(i,1,vt,!0)):[]}),ny=be(function(e,i){var o=Ar(i);return vt(o)&&(o=r),vt(e)?Bn(e,Kt(i,1,vt,!0),ue(o,2)):[]}),sy=be(function(e,i){var o=Ar(i);return vt(o)&&(o=r),vt(e)?Bn(e,Kt(i,1,vt,!0),r,o):[]});function oy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:me(i),Rr(e,i<0?0:i,c)):[]}function ay(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:me(i),i=c-i,Rr(e,0,i<0?0:i)):[]}function cy(e,i){return e&&e.length?ao(e,ue(i,3),!0,!0):[]}function uy(e,i){return e&&e.length?ao(e,ue(i,3),!0):[]}function hy(e,i,o,c){var l=e==null?0:e.length;return l?(o&&typeof o!="number"&&Xt(e,i,o)&&(o=0,c=l),rg(e,i,o,c)):[]}function Dh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:me(o);return l<0&&(l=$t(c+l,0)),zs(e,ue(i,3),l)}function jh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return o!==r&&(l=me(o),l=o<0?$t(c+l,0):Ft(l,c-1)),zs(e,ue(i,3),l,!0)}function Mh(e){var i=e==null?0:e.length;return i?Kt(e,1):[]}function ly(e){var i=e==null?0:e.length;return i?Kt(e,de):[]}function fy(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:me(i),Kt(e,i)):[]}function dy(e){for(var i=-1,o=e==null?0:e.length,c={};++i<o;){var l=e[i];c[l[0]]=l[1]}return c}function Lh(e){return e&&e.length?e[0]:r}function py(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:me(o);return l<0&&(l=$t(c+l,0)),un(e,i,l)}function gy(e){var i=e==null?0:e.length;return i?Rr(e,0,-1):[]}var yy=be(function(e){var i=Ze(e,Ba);return i.length&&i[0]===e[0]?Da(i):[]}),my=be(function(e){var i=Ar(e),o=Ze(e,Ba);return i===Ar(o)?i=r:o.pop(),o.length&&o[0]===e[0]?Da(o,ue(i,2)):[]}),vy=be(function(e){var i=Ar(e),o=Ze(e,Ba);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?Da(o,r,i):[]});function wy(e,i){return e==null?"":gp.call(e,i)}function Ar(e){var i=e==null?0:e.length;return i?e[i-1]:r}function by(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c;return o!==r&&(l=me(o),l=l<0?$t(c+l,0):Ft(l,c-1)),i===i?Zd(e,i,l):zs(e,mu,l,!0)}function _y(e,i){return e&&e.length?Gu(e,me(i)):r}var Ey=be(Uh);function Uh(e,i){return e&&e.length&&i&&i.length?Ua(e,i):e}function Iy(e,i,o){return e&&e.length&&i&&i.length?Ua(e,i,ue(o,2)):e}function xy(e,i,o){return e&&e.length&&i&&i.length?Ua(e,i,r,o):e}var Sy=oi(function(e,i){var o=e==null?0:e.length,c=Ta(e,i);return Yu(e,Ze(i,function(l){return ai(l,o)?+l:l}).sort(ah)),c});function Py(e,i){var o=[];if(!(e&&e.length))return o;var c=-1,l=[],p=e.length;for(i=ue(i,3);++c<p;){var w=e[c];i(w,c,e)&&(o.push(w),l.push(c))}return Yu(e,l),o}function nc(e){return e==null?e:wp.call(e)}function Oy(e,i,o){var c=e==null?0:e.length;return c?(o&&typeof o!="number"&&Xt(e,i,o)?(i=0,o=c):(i=i==null?0:me(i),o=o===r?c:me(o)),Rr(e,i,o)):[]}function Ry(e,i){return oo(e,i)}function Ay(e,i,o){return ka(e,i,ue(o,2))}function Ty(e,i){var o=e==null?0:e.length;if(o){var c=oo(e,i);if(c<o&&Ur(e[c],i))return c}return-1}function Ny(e,i){return oo(e,i,!0)}function Cy(e,i,o){return ka(e,i,ue(o,2),!0)}function $y(e,i){var o=e==null?0:e.length;if(o){var c=oo(e,i,!0)-1;if(Ur(e[c],i))return c}return-1}function Dy(e){return e&&e.length?Zu(e):[]}function jy(e,i){return e&&e.length?Zu(e,ue(i,2)):[]}function My(e){var i=e==null?0:e.length;return i?Rr(e,1,i):[]}function Ly(e,i,o){return e&&e.length?(i=o||i===r?1:me(i),Rr(e,0,i<0?0:i)):[]}function Uy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:me(i),i=c-i,Rr(e,i<0?0:i,c)):[]}function qy(e,i){return e&&e.length?ao(e,ue(i,3),!1,!0):[]}function zy(e,i){return e&&e.length?ao(e,ue(i,3)):[]}var ky=be(function(e){return Si(Kt(e,1,vt,!0))}),Hy=be(function(e){var i=Ar(e);return vt(i)&&(i=r),Si(Kt(e,1,vt,!0),ue(i,2))}),Ky=be(function(e){var i=Ar(e);return i=typeof i=="function"?i:r,Si(Kt(e,1,vt,!0),r,i)});function By(e){return e&&e.length?Si(e):[]}function Fy(e,i){return e&&e.length?Si(e,ue(i,2)):[]}function Vy(e,i){return i=typeof i=="function"?i:r,e&&e.length?Si(e,r,i):[]}function sc(e){if(!(e&&e.length))return[];var i=0;return e=bi(e,function(o){if(vt(o))return i=$t(o.length,i),!0}),Ea(i,function(o){return Ze(e,wa(o))})}function qh(e,i){if(!(e&&e.length))return[];var o=sc(e);return i==null?o:Ze(o,function(c){return jt(i,r,c)})}var Wy=be(function(e,i){return vt(e)?Bn(e,i):[]}),Gy=be(function(e){return Ka(bi(e,vt))}),Jy=be(function(e){var i=Ar(e);return vt(i)&&(i=r),Ka(bi(e,vt),ue(i,2))}),Qy=be(function(e){var i=Ar(e);return i=typeof i=="function"?i:r,Ka(bi(e,vt),r,i)}),Yy=be(sc);function Xy(e,i){return ih(e||[],i||[],Kn)}function Zy(e,i){return ih(e||[],i||[],Wn)}var em=be(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,qh(e,o)});function zh(e){var i=d(e);return i.__chain__=!0,i}function tm(e,i){return i(e),e}function mo(e,i){return i(e)}var rm=oi(function(e){var i=e.length,o=i?e[0]:0,c=this.__wrapped__,l=function(p){return Ta(p,e)};return i>1||this.__actions__.length||!(c instanceof xe)||!ai(o)?this.thru(l):(c=c.slice(o,+o+(i?1:0)),c.__actions__.push({func:mo,args:[l],thisArg:r}),new Pr(c,this.__chain__).thru(function(p){return i&&!p.length&&p.push(r),p}))});function im(){return zh(this)}function nm(){return new Pr(this.value(),this.__chain__)}function sm(){this.__values__===r&&(this.__values__=el(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function om(){return this}function am(e){for(var i,o=this;o instanceof to;){var c=$h(o);c.__index__=0,c.__values__=r,i?l.__wrapped__=c:i=c;var l=c;o=o.__wrapped__}return l.__wrapped__=e,i}function cm(){var e=this.__wrapped__;if(e instanceof xe){var i=e;return this.__actions__.length&&(i=new xe(this)),i=i.reverse(),i.__actions__.push({func:mo,args:[nc],thisArg:r}),new Pr(i,this.__chain__)}return this.thru(nc)}function um(){return rh(this.__wrapped__,this.__actions__)}var hm=co(function(e,i,o){je.call(e,o)?++e[o]:ni(e,o,1)});function lm(e,i,o){var c=ye(e)?gu:tg;return o&&Xt(e,i,o)&&(i=r),c(e,ue(i,3))}function fm(e,i){var o=ye(e)?bi:qu;return o(e,ue(i,3))}var dm=dh(Dh),pm=dh(jh);function gm(e,i){return Kt(vo(e,i),1)}function ym(e,i){return Kt(vo(e,i),de)}function mm(e,i,o){return o=o===r?1:me(o),Kt(vo(e,i),o)}function kh(e,i){var o=ye(e)?xr:xi;return o(e,ue(i,3))}function Hh(e,i){var o=ye(e)?Md:Uu;return o(e,ue(i,3))}var vm=co(function(e,i,o){je.call(e,o)?e[o].push(i):ni(e,o,[i])});function wm(e,i,o,c){e=sr(e)?e:_n(e),o=o&&!c?me(o):0;var l=e.length;return o<0&&(o=$t(l+o,0)),Io(e)?o<=l&&e.indexOf(i,o)>-1:!!l&&un(e,i,o)>-1}var bm=be(function(e,i,o){var c=-1,l=typeof i=="function",p=sr(e)?C(e.length):[];return xi(e,function(w){p[++c]=l?jt(i,w,o):Fn(w,i,o)}),p}),_m=co(function(e,i,o){ni(e,o,i)});function vo(e,i){var o=ye(e)?Ze:Fu;return o(e,ue(i,3))}function Em(e,i,o,c){return e==null?[]:(ye(i)||(i=i==null?[]:[i]),o=c?r:o,ye(o)||(o=o==null?[]:[o]),Ju(e,i,o))}var Im=co(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function xm(e,i,o){var c=ye(e)?ma:wu,l=arguments.length<3;return c(e,ue(i,4),o,l,xi)}function Sm(e,i,o){var c=ye(e)?Ld:wu,l=arguments.length<3;return c(e,ue(i,4),o,l,Uu)}function Pm(e,i){var o=ye(e)?bi:qu;return o(e,_o(ue(i,3)))}function Om(e){var i=ye(e)?Du:wg;return i(e)}function Rm(e,i,o){(o?Xt(e,i,o):i===r)?i=1:i=me(i);var c=ye(e)?Qp:bg;return c(e,i)}function Am(e){var i=ye(e)?Yp:Eg;return i(e)}function Tm(e){if(e==null)return 0;if(sr(e))return Io(e)?ln(e):e.length;var i=Vt(e);return i==ve||i==Ce?e.size:Ma(e).length}function Nm(e,i,o){var c=ye(e)?va:Ig;return o&&Xt(e,i,o)&&(i=r),c(e,ue(i,3))}var Cm=be(function(e,i){if(e==null)return[];var o=i.length;return o>1&&Xt(e,i[0],i[1])?i=[]:o>2&&Xt(i[0],i[1],i[2])&&(i=[i[0]]),Ju(e,Kt(i,1),[])}),wo=fp||function(){return Se.Date.now()};function $m(e,i){if(typeof i!="function")throw new Sr(f);return e=me(e),function(){if(--e<1)return i.apply(this,arguments)}}function Kh(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,si(e,W,r,r,r,r,i)}function Bh(e,i){var o;if(typeof i!="function")throw new Sr(f);return e=me(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var oc=be(function(e,i,o){var c=ae;if(o.length){var l=Ei(o,wn(oc));c|=U}return si(e,c,i,o,l)}),Fh=be(function(e,i,o){var c=ae|ce;if(o.length){var l=Ei(o,wn(Fh));c|=U}return si(i,c,e,o,l)});function Vh(e,i,o){i=o?r:i;var c=si(e,$,r,r,r,r,r,i);return c.placeholder=Vh.placeholder,c}function Wh(e,i,o){i=o?r:i;var c=si(e,j,r,r,r,r,r,i);return c.placeholder=Wh.placeholder,c}function Gh(e,i,o){var c,l,p,w,E,R,k=0,H=!1,F=!1,Z=!0;if(typeof e!="function")throw new Sr(f);i=Tr(i)||0,st(o)&&(H=!!o.leading,F="maxWait"in o,p=F?$t(Tr(o.maxWait)||0,i):p,Z="trailing"in o?!!o.trailing:Z);function se(wt){var qr=c,hi=l;return c=l=r,k=wt,w=e.apply(hi,qr),w}function he(wt){return k=wt,E=Qn(_e,i),H?se(wt):w}function we(wt){var qr=wt-R,hi=wt-k,dl=i-qr;return F?Ft(dl,p-hi):dl}function le(wt){var qr=wt-R,hi=wt-k;return R===r||qr>=i||qr<0||F&&hi>=p}function _e(){var wt=wo();if(le(wt))return Pe(wt);E=Qn(_e,we(wt))}function Pe(wt){return E=r,Z&&c?se(wt):(c=l=r,w)}function vr(){E!==r&&nh(E),k=0,c=R=l=E=r}function Zt(){return E===r?w:Pe(wo())}function wr(){var wt=wo(),qr=le(wt);if(c=arguments,l=this,R=wt,qr){if(E===r)return he(R);if(F)return nh(E),E=Qn(_e,i),se(R)}return E===r&&(E=Qn(_e,i)),w}return wr.cancel=vr,wr.flush=Zt,wr}var Dm=be(function(e,i){return Lu(e,1,i)}),jm=be(function(e,i,o){return Lu(e,Tr(i)||0,o)});function Mm(e){return si(e,Oe)}function bo(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Sr(f);var o=function(){var c=arguments,l=i?i.apply(this,c):c[0],p=o.cache;if(p.has(l))return p.get(l);var w=e.apply(this,c);return o.cache=p.set(l,w)||p,w};return o.cache=new(bo.Cache||ii),o}bo.Cache=ii;function _o(e){if(typeof e!="function")throw new Sr(f);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Lm(e){return Bh(2,e)}var Um=xg(function(e,i){i=i.length==1&&ye(i[0])?Ze(i[0],gr(ue())):Ze(Kt(i,1),gr(ue()));var o=i.length;return be(function(c){for(var l=-1,p=Ft(c.length,o);++l<p;)c[l]=i[l].call(this,c[l]);return jt(e,this,c)})}),ac=be(function(e,i){var o=Ei(i,wn(ac));return si(e,U,r,i,o)}),Jh=be(function(e,i){var o=Ei(i,wn(Jh));return si(e,B,r,i,o)}),qm=oi(function(e,i){return si(e,J,r,r,r,i)});function zm(e,i){if(typeof e!="function")throw new Sr(f);return i=i===r?i:me(i),be(e,i)}function km(e,i){if(typeof e!="function")throw new Sr(f);return i=i==null?0:$t(me(i),0),be(function(o){var c=o[i],l=Oi(o,0,i);return c&&_i(l,c),jt(e,this,l)})}function Hm(e,i,o){var c=!0,l=!0;if(typeof e!="function")throw new Sr(f);return st(o)&&(c="leading"in o?!!o.leading:c,l="trailing"in o?!!o.trailing:l),Gh(e,i,{leading:c,maxWait:i,trailing:l})}function Km(e){return Kh(e,1)}function Bm(e,i){return ac(Fa(i),e)}function Fm(){if(!arguments.length)return[];var e=arguments[0];return ye(e)?e:[e]}function Vm(e){return Or(e,z)}function Wm(e,i){return i=typeof i=="function"?i:r,Or(e,z,i)}function Gm(e){return Or(e,x|z)}function Jm(e,i){return i=typeof i=="function"?i:r,Or(e,x|z,i)}function Qm(e,i){return i==null||Mu(e,i,Mt(i))}function Ur(e,i){return e===i||e!==e&&i!==i}var Ym=fo($a),Xm=fo(function(e,i){return e>=i}),Wi=Hu(function(){return arguments}())?Hu:function(e){return pt(e)&&je.call(e,"callee")&&!Ru.call(e,"callee")},ye=C.isArray,Zm=Qt?gr(Qt):ag;function sr(e){return e!=null&&Eo(e.length)&&!ci(e)}function vt(e){return pt(e)&&sr(e)}function ev(e){return e===!0||e===!1||pt(e)&&Yt(e)==D}var Ri=pp||vc,tv=jr?gr(jr):cg;function rv(e){return pt(e)&&e.nodeType===1&&!Yn(e)}function iv(e){if(e==null)return!0;if(sr(e)&&(ye(e)||typeof e=="string"||typeof e.splice=="function"||Ri(e)||bn(e)||Wi(e)))return!e.length;var i=Vt(e);if(i==ve||i==Ce)return!e.size;if(Jn(e))return!Ma(e).length;for(var o in e)if(je.call(e,o))return!1;return!0}function nv(e,i){return Vn(e,i)}function sv(e,i,o){o=typeof o=="function"?o:r;var c=o?o(e,i):r;return c===r?Vn(e,i,r,o):!!c}function cc(e){if(!pt(e))return!1;var i=Yt(e);return i==I||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Yn(e)}function ov(e){return typeof e=="number"&&Tu(e)}function ci(e){if(!st(e))return!1;var i=Yt(e);return i==ne||i==fe||i==L||i==gt}function Qh(e){return typeof e=="number"&&e==me(e)}function Eo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=G}function st(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function pt(e){return e!=null&&typeof e=="object"}var Yh=Ir?gr(Ir):hg;function av(e,i){return e===i||ja(e,i,Xa(i))}function cv(e,i,o){return o=typeof o=="function"?o:r,ja(e,i,Xa(i),o)}function uv(e){return Xh(e)&&e!=+e}function hv(e){if(Wg(e))throw new pe(u);return Ku(e)}function lv(e){return e===null}function fv(e){return e==null}function Xh(e){return typeof e=="number"||pt(e)&&Yt(e)==Re}function Yn(e){if(!pt(e)||Yt(e)!=Ie)return!1;var i=Gs(e);if(i===null)return!0;var o=je.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Bs.call(o)==cp}var uc=Vr?gr(Vr):lg;function dv(e){return Qh(e)&&e>=-G&&e<=G}var Zh=Mn?gr(Mn):fg;function Io(e){return typeof e=="string"||!ye(e)&&pt(e)&&Yt(e)==Fe}function mr(e){return typeof e=="symbol"||pt(e)&&Yt(e)==Ve}var bn=qi?gr(qi):dg;function pv(e){return e===r}function gv(e){return pt(e)&&Vt(e)==Me}function yv(e){return pt(e)&&Yt(e)==We}var mv=fo(La),vv=fo(function(e,i){return e<=i});function el(e){if(!e)return[];if(sr(e))return Io(e)?Mr(e):nr(e);if(Un&&e[Un])return Qd(e[Un]());var i=Vt(e),o=i==ve?xa:i==Ce?ks:_n;return o(e)}function ui(e){if(!e)return e===0?e:0;if(e=Tr(e),e===de||e===-de){var i=e<0?-1:1;return i*V}return e===e?e:0}function me(e){var i=ui(e),o=i%1;return i===i?o?i-o:i:0}function tl(e){return e?Ki(me(e),0,Y):0}function Tr(e){if(typeof e=="number")return e;if(mr(e))return Q;if(st(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=st(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=bu(e);var o=Zo.test(e);return o||ta.test(e)?ge(e.slice(2),o?2:8):Xo.test(e)?Q:+e}function rl(e){return Gr(e,or(e))}function wv(e){return e?Ki(me(e),-G,G):e===0?e:0}function $e(e){return e==null?"":yr(e)}var bv=mn(function(e,i){if(Jn(i)||sr(i)){Gr(i,Mt(i),e);return}for(var o in i)je.call(i,o)&&Kn(e,o,i[o])}),il=mn(function(e,i){Gr(i,or(i),e)}),xo=mn(function(e,i,o,c){Gr(i,or(i),e,c)}),_v=mn(function(e,i,o,c){Gr(i,Mt(i),e,c)}),Ev=oi(Ta);function Iv(e,i){var o=yn(e);return i==null?o:ju(o,i)}var xv=be(function(e,i){e=He(e);var o=-1,c=i.length,l=c>2?i[2]:r;for(l&&Xt(i[0],i[1],l)&&(c=1);++o<c;)for(var p=i[o],w=or(p),E=-1,R=w.length;++E<R;){var k=w[E],H=e[k];(H===r||Ur(H,dn[k])&&!je.call(e,k))&&(e[k]=p[k])}return e}),Sv=be(function(e){return e.push(r,bh),jt(nl,r,e)});function Pv(e,i){return yu(e,ue(i,3),Wr)}function Ov(e,i){return yu(e,ue(i,3),Ca)}function Rv(e,i){return e==null?e:Na(e,ue(i,3),or)}function Av(e,i){return e==null?e:zu(e,ue(i,3),or)}function Tv(e,i){return e&&Wr(e,ue(i,3))}function Nv(e,i){return e&&Ca(e,ue(i,3))}function Cv(e){return e==null?[]:no(e,Mt(e))}function $v(e){return e==null?[]:no(e,or(e))}function hc(e,i,o){var c=e==null?r:Bi(e,i);return c===r?o:c}function Dv(e,i){return e!=null&&Ih(e,i,ig)}function lc(e,i){return e!=null&&Ih(e,i,ng)}var jv=gh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Fs.call(i)),e[i]=o},dc(ar)),Mv=gh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Fs.call(i)),je.call(e,i)?e[i].push(o):e[i]=[o]},ue),Lv=be(Fn);function Mt(e){return sr(e)?$u(e):Ma(e)}function or(e){return sr(e)?$u(e,!0):pg(e)}function Uv(e,i){var o={};return i=ue(i,3),Wr(e,function(c,l,p){ni(o,i(c,l,p),c)}),o}function qv(e,i){var o={};return i=ue(i,3),Wr(e,function(c,l,p){ni(o,l,i(c,l,p))}),o}var zv=mn(function(e,i,o){so(e,i,o)}),nl=mn(function(e,i,o,c){so(e,i,o,c)}),kv=oi(function(e,i){var o={};if(e==null)return o;var c=!1;i=Ze(i,function(p){return p=Pi(p,e),c||(c=p.length>1),p}),Gr(e,Qa(e),o),c&&(o=Or(o,x|M|z,jg));for(var l=i.length;l--;)Ha(o,i[l]);return o});function Hv(e,i){return sl(e,_o(ue(i)))}var Kv=oi(function(e,i){return e==null?{}:yg(e,i)});function sl(e,i){if(e==null)return{};var o=Ze(Qa(e),function(c){return[c]});return i=ue(i),Qu(e,o,function(c,l){return i(c,l[0])})}function Bv(e,i,o){i=Pi(i,e);var c=-1,l=i.length;for(l||(l=1,e=r);++c<l;){var p=e==null?r:e[Jr(i[c])];p===r&&(c=l,p=o),e=ci(p)?p.call(e):p}return e}function Fv(e,i,o){return e==null?e:Wn(e,i,o)}function Vv(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:Wn(e,i,o,c)}var ol=vh(Mt),al=vh(or);function Wv(e,i,o){var c=ye(e),l=c||Ri(e)||bn(e);if(i=ue(i,4),o==null){var p=e&&e.constructor;l?o=c?new p:[]:st(e)?o=ci(p)?yn(Gs(e)):{}:o={}}return(l?xr:Wr)(e,function(w,E,R){return i(o,w,E,R)}),o}function Gv(e,i){return e==null?!0:Ha(e,i)}function Jv(e,i,o){return e==null?e:th(e,i,Fa(o))}function Qv(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:th(e,i,Fa(o),c)}function _n(e){return e==null?[]:Ia(e,Mt(e))}function Yv(e){return e==null?[]:Ia(e,or(e))}function Xv(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Tr(o),o=o===o?o:0),i!==r&&(i=Tr(i),i=i===i?i:0),Ki(Tr(e),i,o)}function Zv(e,i,o){return i=ui(i),o===r?(o=i,i=0):o=ui(o),e=Tr(e),sg(e,i,o)}function e0(e,i,o){if(o&&typeof o!="boolean"&&Xt(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ui(e),i===r?(i=e,e=0):i=ui(i)),e>i){var c=e;e=i,i=c}if(o||e%1||i%1){var l=Nu();return Ft(e+l*(i-e+ze("1e-"+((l+"").length-1))),i)}return qa(e,i)}var t0=vn(function(e,i,o){return i=i.toLowerCase(),e+(o?cl(i):i)});function cl(e){return fc($e(e).toLowerCase())}function ul(e){return e=$e(e),e&&e.replace(ei,Fd).replace(pa,"")}function r0(e,i,o){e=$e(e),i=yr(i);var c=e.length;o=o===r?c:Ki(me(o),0,c);var l=o;return o-=i.length,o>=0&&e.slice(o,l)==i}function i0(e){return e=$e(e),e&&Ye.test(e)?e.replace(Di,Vd):e}function n0(e){return e=$e(e),e&&St.test(e)?e.replace(lt,"\\$&"):e}var s0=vn(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),o0=vn(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),a0=fh("toLowerCase");function c0(e,i,o){e=$e(e),i=me(i);var c=i?ln(e):0;if(!i||c>=i)return e;var l=(i-c)/2;return lo(Xs(l),o)+e+lo(Ys(l),o)}function u0(e,i,o){e=$e(e),i=me(i);var c=i?ln(e):0;return i&&c<i?e+lo(i-c,o):e}function h0(e,i,o){e=$e(e),i=me(i);var c=i?ln(e):0;return i&&c<i?lo(i-c,o)+e:e}function l0(e,i,o){return o||i==null?i=0:i&&(i=+i),vp($e(e).replace(ft,""),i||0)}function f0(e,i,o){return(o?Xt(e,i,o):i===r)?i=1:i=me(i),za($e(e),i)}function d0(){var e=arguments,i=$e(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var p0=vn(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function g0(e,i,o){return o&&typeof o!="number"&&Xt(e,i,o)&&(i=o=r),o=o===r?Y:o>>>0,o?(e=$e(e),e&&(typeof i=="string"||i!=null&&!uc(i))&&(i=yr(i),!i&&hn(e))?Oi(Mr(e),0,o):e.split(i,o)):[]}var y0=vn(function(e,i,o){return e+(o?" ":"")+fc(i)});function m0(e,i,o){return e=$e(e),o=o==null?0:Ki(me(o),0,e.length),i=yr(i),e.slice(o,o+i.length)==i}function v0(e,i,o){var c=d.templateSettings;o&&Xt(e,i,o)&&(i=r),e=$e(e),i=xo({},i,c,wh);var l=xo({},i.imports,c.imports,wh),p=Mt(l),w=Ia(l,p),E,R,k=0,H=i.interpolate||tn,F="__p += '",Z=Sa((i.escape||tn).source+"|"+H.source+"|"+(H===nt?Yo:tn).source+"|"+(i.evaluate||tn).source+"|$","g"),se="//# sourceURL="+(je.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ga+"]")+`
`;e.replace(Z,function(le,_e,Pe,vr,Zt,wr){return Pe||(Pe=vr),F+=e.slice(k,wr).replace(ia,Wd),_e&&(E=!0,F+=`' +
__e(`+_e+`) +
'`),Zt&&(R=!0,F+=`';
`+Zt+`;
__p += '`),Pe&&(F+=`' +
((__t = (`+Pe+`)) == null ? '' : __t) +
'`),k=wr+le.length,le}),F+=`';
`;var he=je.call(i,"variable")&&i.variable;if(!he)F=`with (obj) {
`+F+`
}
`;else if(Jo.test(he))throw new pe(g);F=(R?F.replace(Br,""):F).replace(Jt,"$1").replace(Zr,"$1;"),F="function("+(he||"obj")+`) {
`+(he?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(E?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+F+`return __p
}`;var we=ll(function(){return Ne(p,se+"return "+F).apply(r,w)});if(we.source=F,cc(we))throw we;return we}function w0(e){return $e(e).toLowerCase()}function b0(e){return $e(e).toUpperCase()}function _0(e,i,o){if(e=$e(e),e&&(o||i===r))return bu(e);if(!e||!(i=yr(i)))return e;var c=Mr(e),l=Mr(i),p=_u(c,l),w=Eu(c,l)+1;return Oi(c,p,w).join("")}function E0(e,i,o){if(e=$e(e),e&&(o||i===r))return e.slice(0,xu(e)+1);if(!e||!(i=yr(i)))return e;var c=Mr(e),l=Eu(c,Mr(i))+1;return Oi(c,0,l).join("")}function I0(e,i,o){if(e=$e(e),e&&(o||i===r))return e.replace(ft,"");if(!e||!(i=yr(i)))return e;var c=Mr(e),l=_u(c,Mr(i));return Oi(c,l).join("")}function x0(e,i){var o=Qe,c=Be;if(st(i)){var l="separator"in i?i.separator:l;o="length"in i?me(i.length):o,c="omission"in i?yr(i.omission):c}e=$e(e);var p=e.length;if(hn(e)){var w=Mr(e);p=w.length}if(o>=p)return e;var E=o-ln(c);if(E<1)return c;var R=w?Oi(w,0,E).join(""):e.slice(0,E);if(l===r)return R+c;if(w&&(E+=R.length-E),uc(l)){if(e.slice(E).search(l)){var k,H=R;for(l.global||(l=Sa(l.source,$e(Er.exec(l))+"g")),l.lastIndex=0;k=l.exec(H);)var F=k.index;R=R.slice(0,F===r?E:F)}}else if(e.indexOf(yr(l),E)!=E){var Z=R.lastIndexOf(l);Z>-1&&(R=R.slice(0,Z))}return R+c}function S0(e){return e=$e(e),e&&ct.test(e)?e.replace(vi,ep):e}var P0=vn(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),fc=fh("toUpperCase");function hl(e,i,o){return e=$e(e),i=o?r:i,i===r?Jd(e)?ip(e):zd(e):e.match(i)||[]}var ll=be(function(e,i){try{return jt(e,r,i)}catch(o){return cc(o)?o:new pe(o)}}),O0=oi(function(e,i){return xr(i,function(o){o=Jr(o),ni(e,o,oc(e[o],e))}),e});function R0(e){var i=e==null?0:e.length,o=ue();return e=i?Ze(e,function(c){if(typeof c[1]!="function")throw new Sr(f);return[o(c[0]),c[1]]}):[],be(function(c){for(var l=-1;++l<i;){var p=e[l];if(jt(p[0],this,c))return jt(p[1],this,c)}})}function A0(e){return eg(Or(e,x))}function dc(e){return function(){return e}}function T0(e,i){return e==null||e!==e?i:e}var N0=ph(),C0=ph(!0);function ar(e){return e}function pc(e){return Bu(typeof e=="function"?e:Or(e,x))}function $0(e){return Vu(Or(e,x))}function D0(e,i){return Wu(e,Or(i,x))}var j0=be(function(e,i){return function(o){return Fn(o,e,i)}}),M0=be(function(e,i){return function(o){return Fn(e,o,i)}});function gc(e,i,o){var c=Mt(i),l=no(i,c);o==null&&!(st(i)&&(l.length||!c.length))&&(o=i,i=e,e=this,l=no(i,Mt(i)));var p=!(st(o)&&"chain"in o)||!!o.chain,w=ci(e);return xr(l,function(E){var R=i[E];e[E]=R,w&&(e.prototype[E]=function(){var k=this.__chain__;if(p||k){var H=e(this.__wrapped__),F=H.__actions__=nr(this.__actions__);return F.push({func:R,args:arguments,thisArg:e}),H.__chain__=k,H}return R.apply(e,_i([this.value()],arguments))})}),e}function L0(){return Se._===this&&(Se._=up),this}function yc(){}function U0(e){return e=me(e),be(function(i){return Gu(i,e)})}var q0=Wa(Ze),z0=Wa(gu),k0=Wa(va);function fl(e){return ec(e)?wa(Jr(e)):mg(e)}function H0(e){return function(i){return e==null?r:Bi(e,i)}}var K0=yh(),B0=yh(!0);function mc(){return[]}function vc(){return!1}function F0(){return{}}function V0(){return""}function W0(){return!0}function G0(e,i){if(e=me(e),e<1||e>G)return[];var o=Y,c=Ft(e,Y);i=ue(i),e-=Y;for(var l=Ea(c,i);++o<e;)i(o);return l}function J0(e){return ye(e)?Ze(e,Jr):mr(e)?[e]:nr(Ch($e(e)))}function Q0(e){var i=++ap;return $e(e)+i}var Y0=ho(function(e,i){return e+i},0),X0=Ga("ceil"),Z0=ho(function(e,i){return e/i},1),ew=Ga("floor");function tw(e){return e&&e.length?io(e,ar,$a):r}function rw(e,i){return e&&e.length?io(e,ue(i,2),$a):r}function iw(e){return vu(e,ar)}function nw(e,i){return vu(e,ue(i,2))}function sw(e){return e&&e.length?io(e,ar,La):r}function ow(e,i){return e&&e.length?io(e,ue(i,2),La):r}var aw=ho(function(e,i){return e*i},1),cw=Ga("round"),uw=ho(function(e,i){return e-i},0);function hw(e){return e&&e.length?_a(e,ar):0}function lw(e,i){return e&&e.length?_a(e,ue(i,2)):0}return d.after=$m,d.ary=Kh,d.assign=bv,d.assignIn=il,d.assignInWith=xo,d.assignWith=_v,d.at=Ev,d.before=Bh,d.bind=oc,d.bindAll=O0,d.bindKey=Fh,d.castArray=Fm,d.chain=zh,d.chunk=ey,d.compact=ty,d.concat=ry,d.cond=R0,d.conforms=A0,d.constant=dc,d.countBy=hm,d.create=Iv,d.curry=Vh,d.curryRight=Wh,d.debounce=Gh,d.defaults=xv,d.defaultsDeep=Sv,d.defer=Dm,d.delay=jm,d.difference=iy,d.differenceBy=ny,d.differenceWith=sy,d.drop=oy,d.dropRight=ay,d.dropRightWhile=cy,d.dropWhile=uy,d.fill=hy,d.filter=fm,d.flatMap=gm,d.flatMapDeep=ym,d.flatMapDepth=mm,d.flatten=Mh,d.flattenDeep=ly,d.flattenDepth=fy,d.flip=Mm,d.flow=N0,d.flowRight=C0,d.fromPairs=dy,d.functions=Cv,d.functionsIn=$v,d.groupBy=vm,d.initial=gy,d.intersection=yy,d.intersectionBy=my,d.intersectionWith=vy,d.invert=jv,d.invertBy=Mv,d.invokeMap=bm,d.iteratee=pc,d.keyBy=_m,d.keys=Mt,d.keysIn=or,d.map=vo,d.mapKeys=Uv,d.mapValues=qv,d.matches=$0,d.matchesProperty=D0,d.memoize=bo,d.merge=zv,d.mergeWith=nl,d.method=j0,d.methodOf=M0,d.mixin=gc,d.negate=_o,d.nthArg=U0,d.omit=kv,d.omitBy=Hv,d.once=Lm,d.orderBy=Em,d.over=q0,d.overArgs=Um,d.overEvery=z0,d.overSome=k0,d.partial=ac,d.partialRight=Jh,d.partition=Im,d.pick=Kv,d.pickBy=sl,d.property=fl,d.propertyOf=H0,d.pull=Ey,d.pullAll=Uh,d.pullAllBy=Iy,d.pullAllWith=xy,d.pullAt=Sy,d.range=K0,d.rangeRight=B0,d.rearg=qm,d.reject=Pm,d.remove=Py,d.rest=zm,d.reverse=nc,d.sampleSize=Rm,d.set=Fv,d.setWith=Vv,d.shuffle=Am,d.slice=Oy,d.sortBy=Cm,d.sortedUniq=Dy,d.sortedUniqBy=jy,d.split=g0,d.spread=km,d.tail=My,d.take=Ly,d.takeRight=Uy,d.takeRightWhile=qy,d.takeWhile=zy,d.tap=tm,d.throttle=Hm,d.thru=mo,d.toArray=el,d.toPairs=ol,d.toPairsIn=al,d.toPath=J0,d.toPlainObject=rl,d.transform=Wv,d.unary=Km,d.union=ky,d.unionBy=Hy,d.unionWith=Ky,d.uniq=By,d.uniqBy=Fy,d.uniqWith=Vy,d.unset=Gv,d.unzip=sc,d.unzipWith=qh,d.update=Jv,d.updateWith=Qv,d.values=_n,d.valuesIn=Yv,d.without=Wy,d.words=hl,d.wrap=Bm,d.xor=Gy,d.xorBy=Jy,d.xorWith=Qy,d.zip=Yy,d.zipObject=Xy,d.zipObjectDeep=Zy,d.zipWith=em,d.entries=ol,d.entriesIn=al,d.extend=il,d.extendWith=xo,gc(d,d),d.add=Y0,d.attempt=ll,d.camelCase=t0,d.capitalize=cl,d.ceil=X0,d.clamp=Xv,d.clone=Vm,d.cloneDeep=Gm,d.cloneDeepWith=Jm,d.cloneWith=Wm,d.conformsTo=Qm,d.deburr=ul,d.defaultTo=T0,d.divide=Z0,d.endsWith=r0,d.eq=Ur,d.escape=i0,d.escapeRegExp=n0,d.every=lm,d.find=dm,d.findIndex=Dh,d.findKey=Pv,d.findLast=pm,d.findLastIndex=jh,d.findLastKey=Ov,d.floor=ew,d.forEach=kh,d.forEachRight=Hh,d.forIn=Rv,d.forInRight=Av,d.forOwn=Tv,d.forOwnRight=Nv,d.get=hc,d.gt=Ym,d.gte=Xm,d.has=Dv,d.hasIn=lc,d.head=Lh,d.identity=ar,d.includes=wm,d.indexOf=py,d.inRange=Zv,d.invoke=Lv,d.isArguments=Wi,d.isArray=ye,d.isArrayBuffer=Zm,d.isArrayLike=sr,d.isArrayLikeObject=vt,d.isBoolean=ev,d.isBuffer=Ri,d.isDate=tv,d.isElement=rv,d.isEmpty=iv,d.isEqual=nv,d.isEqualWith=sv,d.isError=cc,d.isFinite=ov,d.isFunction=ci,d.isInteger=Qh,d.isLength=Eo,d.isMap=Yh,d.isMatch=av,d.isMatchWith=cv,d.isNaN=uv,d.isNative=hv,d.isNil=fv,d.isNull=lv,d.isNumber=Xh,d.isObject=st,d.isObjectLike=pt,d.isPlainObject=Yn,d.isRegExp=uc,d.isSafeInteger=dv,d.isSet=Zh,d.isString=Io,d.isSymbol=mr,d.isTypedArray=bn,d.isUndefined=pv,d.isWeakMap=gv,d.isWeakSet=yv,d.join=wy,d.kebabCase=s0,d.last=Ar,d.lastIndexOf=by,d.lowerCase=o0,d.lowerFirst=a0,d.lt=mv,d.lte=vv,d.max=tw,d.maxBy=rw,d.mean=iw,d.meanBy=nw,d.min=sw,d.minBy=ow,d.stubArray=mc,d.stubFalse=vc,d.stubObject=F0,d.stubString=V0,d.stubTrue=W0,d.multiply=aw,d.nth=_y,d.noConflict=L0,d.noop=yc,d.now=wo,d.pad=c0,d.padEnd=u0,d.padStart=h0,d.parseInt=l0,d.random=e0,d.reduce=xm,d.reduceRight=Sm,d.repeat=f0,d.replace=d0,d.result=Bv,d.round=cw,d.runInContext=P,d.sample=Om,d.size=Tm,d.snakeCase=p0,d.some=Nm,d.sortedIndex=Ry,d.sortedIndexBy=Ay,d.sortedIndexOf=Ty,d.sortedLastIndex=Ny,d.sortedLastIndexBy=Cy,d.sortedLastIndexOf=$y,d.startCase=y0,d.startsWith=m0,d.subtract=uw,d.sum=hw,d.sumBy=lw,d.template=v0,d.times=G0,d.toFinite=ui,d.toInteger=me,d.toLength=tl,d.toLower=w0,d.toNumber=Tr,d.toSafeInteger=wv,d.toString=$e,d.toUpper=b0,d.trim=_0,d.trimEnd=E0,d.trimStart=I0,d.truncate=x0,d.unescape=S0,d.uniqueId=Q0,d.upperCase=P0,d.upperFirst=fc,d.each=kh,d.eachRight=Hh,d.first=Lh,gc(d,function(){var e={};return Wr(d,function(i,o){je.call(d.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),d.VERSION=s,xr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),xr(["drop","take"],function(e,i){xe.prototype[e]=function(o){o=o===r?1:$t(me(o),0);var c=this.__filtered__&&!i?new xe(this):this.clone();return c.__filtered__?c.__takeCount__=Ft(o,c.__takeCount__):c.__views__.push({size:Ft(o,Y),type:e+(c.__dir__<0?"Right":"")}),c},xe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),xr(["filter","map","takeWhile"],function(e,i){var o=i+1,c=o==b||o==ie;xe.prototype[e]=function(l){var p=this.clone();return p.__iteratees__.push({iteratee:ue(l,3),type:o}),p.__filtered__=p.__filtered__||c,p}}),xr(["head","last"],function(e,i){var o="take"+(i?"Right":"");xe.prototype[e]=function(){return this[o](1).value()[0]}}),xr(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");xe.prototype[e]=function(){return this.__filtered__?new xe(this):this[o](1)}}),xe.prototype.compact=function(){return this.filter(ar)},xe.prototype.find=function(e){return this.filter(e).head()},xe.prototype.findLast=function(e){return this.reverse().find(e)},xe.prototype.invokeMap=be(function(e,i){return typeof e=="function"?new xe(this):this.map(function(o){return Fn(o,e,i)})}),xe.prototype.reject=function(e){return this.filter(_o(ue(e)))},xe.prototype.slice=function(e,i){e=me(e);var o=this;return o.__filtered__&&(e>0||i<0)?new xe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=me(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},xe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},xe.prototype.toArray=function(){return this.take(Y)},Wr(xe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),l=d[c?"take"+(i=="last"?"Right":""):i],p=c||/^find/.test(i);l&&(d.prototype[i]=function(){var w=this.__wrapped__,E=c?[1]:arguments,R=w instanceof xe,k=E[0],H=R||ye(w),F=function(_e){var Pe=l.apply(d,_i([_e],E));return c&&Z?Pe[0]:Pe};H&&o&&typeof k=="function"&&k.length!=1&&(R=H=!1);var Z=this.__chain__,se=!!this.__actions__.length,he=p&&!Z,we=R&&!se;if(!p&&H){w=we?w:new xe(this);var le=e.apply(w,E);return le.__actions__.push({func:mo,args:[F],thisArg:r}),new Pr(le,Z)}return he&&we?e.apply(this,E):(le=this.thru(F),he?c?le.value()[0]:le.value():le)})}),xr(["pop","push","shift","sort","splice","unshift"],function(e){var i=Hs[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var p=this.value();return i.apply(ye(p)?p:[],l)}return this[o](function(w){return i.apply(ye(w)?w:[],l)})}}),Wr(xe.prototype,function(e,i){var o=d[i];if(o){var c=o.name+"";je.call(gn,c)||(gn[c]=[]),gn[c].push({name:i,func:o})}}),gn[uo(r,ce).name]=[{name:"wrapper",func:r}],xe.prototype.clone=Sp,xe.prototype.reverse=Pp,xe.prototype.value=Op,d.prototype.at=rm,d.prototype.chain=im,d.prototype.commit=nm,d.prototype.next=sm,d.prototype.plant=am,d.prototype.reverse=cm,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=um,d.prototype.first=d.prototype.head,Un&&(d.prototype[Un]=om),d},fn=np();mt?((mt.exports=fn)._=fn,ke._=fn):Se._=fn}).call(ns)})(Wc,Wc.exports);var uS=Object.defineProperty,hS=Object.defineProperties,lS=Object.getOwnPropertyDescriptors,Pf=Object.getOwnPropertySymbols,fS=Object.prototype.hasOwnProperty,dS=Object.prototype.propertyIsEnumerable,Of=(n,t,r)=>t in n?uS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,To=(n,t)=>{for(var r in t||(t={}))fS.call(t,r)&&Of(n,r,t[r]);if(Pf)for(var r of Pf(t))dS.call(t,r)&&Of(n,r,t[r]);return n},pS=(n,t)=>hS(n,lS(t));function Ni(n,t,r){var s;const a=Jw(n);return((s=t.rpcMap)==null?void 0:s[a.reference])||`${cS}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function en(n){return n.includes(":")?n.split(":")[1]:n}function $d(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function gS(n,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const u=t.namespaces[a].accounts;s.push(...u)}),s}function yS(n={},t={}){const r=Rf(n),s=Rf(t);return Wc.exports.merge(r,s)}function Rf(n){var t,r,s,a;const u={};if(!On(n))return u;for(const[f,g]of Object.entries(n)){const v=iu(f)?[f]:g.chains,y=g.methods||[],_=g.events||[],x=g.rpcMap||{},M=ss(f);u[M]=pS(To(To({},u[M]),g),{chains:bc(v,(t=u[M])==null?void 0:t.chains),methods:bc(y,(r=u[M])==null?void 0:r.methods),events:bc(_,(s=u[M])==null?void 0:s.events),rpcMap:To(To({},x),(a=u[M])==null?void 0:a.rpcMap)})}return u}function mS(n){return n.includes(":")?n.split(":")[2]:n}function vS(n){const t={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],u=s.events||[],f=s.accounts||[],g=iu(r)?[r]:s.chains?s.chains:$d(s.accounts);t[r]={chains:g,methods:a,events:u,accounts:f}}return t}function Cc(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const Dd={},et=n=>Dd[n],$c=(n,t)=>{Dd[n]=t};class wS{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=et("events"),this.client=et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=en(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ci(s,et("disableProviderPing")))}}class bS{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=et("events"),this.client=et("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Ni(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ci(s,et("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=parseInt(en(r));t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const u=parseInt(a,16);if(this.isChainApproved(u))this.setDefaultChain(`${u}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${u}`);else throw new Error(`Failed to switch to chain 'eip155:${u}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class _S{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=et("events"),this.client=et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=en(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ci(s,et("disableProviderPing")))}}class ES{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=et("events"),this.client=et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=en(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ci(s,et("disableProviderPing")))}}class IS{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=et("events"),this.client=et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),a=en(r);t[a]=this.createHttpProvider(a,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ci(s,et("disableProviderPing")))}}class xS{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=et("events"),this.client=et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=en(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ci(s,et("disableProviderPing")))}}class SS{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=et("events"),this.client=et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=en(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new yi(new Ci(s,et("disableProviderPing")))}}class PS{constructor(t){this.name="near",this.namespace=t.namespace,this.events=et("events"),this.client=et("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Ni(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace);return typeof s>"u"?void 0:new yi(new Ci(s,et("disableProviderPing")))}}var OS=Object.defineProperty,RS=Object.defineProperties,AS=Object.getOwnPropertyDescriptors,Af=Object.getOwnPropertySymbols,TS=Object.prototype.hasOwnProperty,NS=Object.prototype.propertyIsEnumerable,Tf=(n,t,r)=>t in n?OS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,No=(n,t)=>{for(var r in t||(t={}))TS.call(t,r)&&Tf(n,r,t[r]);if(Af)for(var r of Af(t))NS.call(t,r)&&Tf(n,r,t[r]);return n},Dc=(n,t)=>RS(n,AS(t));class du{constructor(t){this.events=new Xc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ko(Bo({level:(t==null?void 0:t.logger)||xf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new du(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:No({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:bt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(u=>{this.session=u,this.namespaces||(this.namespaces=vS(u.namespaces),this.persist("namespaces",this.namespaces))}).catch(u=>{if(u.message!==Nd)throw u;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Xr(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await tS.init({logger:this.providerOpts.logger||xf,relayUrl:this.providerOpts.relayUrl||sS,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>ss(r)))];$c("client",this.client),$c("events",this.events),$c("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=gS(r,this.session),a=$d(s),u=yS(this.namespaces,this.optionalNamespaces),f=Dc(No({},u[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new bS({namespace:f});break;case"solana":this.rpcProviders[r]=new _S({namespace:f});break;case"cosmos":this.rpcProviders[r]=new ES({namespace:f});break;case"polkadot":this.rpcProviders[r]=new wS({namespace:f});break;case"cip34":this.rpcProviders[r]=new IS({namespace:f});break;case"elrond":this.rpcProviders[r]=new xS({namespace:f});break;case"multiversx":this.rpcProviders[r]=new SS({namespace:f});break;case"near":this.rpcProviders[r]=new PS({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&Xr(a)&&this.events.emit("accountsChanged",a.map(mS))}else if(s.name==="chainChanged"){const a=r.chainId,u=r.event.data,f=ss(a),g=Cc(a)!==Cc(u)?`${f}:${Cc(u)}`:a;this.onChainChanged(g)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,u=(s=this.client)==null?void 0:s.session.get(t);this.session=Dc(No({},u),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Dc(No({},bt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(mi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(f=>ss(f)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=ss(Object.keys(this.namespaces)[0]),u=this.rpcProviders[a].getDefaultChain();return[a,u]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[a,u]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(u),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${u}`]).defaultChain=u,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",u)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Sf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Sf}/${t}`)}}const CS=du,$S="wc",DS="ethereum_provider",jS=`${$S}@2:${DS}:`,MS="https://rpc.walletconnect.com/v1/",Gc=["eth_sendTransaction","personal_sign"],LS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Jc=["chainChanged","accountsChanged"],US=["chainChanged","accountsChanged","message","disconnect","connect"];var qS=Object.defineProperty,zS=Object.defineProperties,kS=Object.getOwnPropertyDescriptors,Nf=Object.getOwnPropertySymbols,HS=Object.prototype.hasOwnProperty,KS=Object.prototype.propertyIsEnumerable,Cf=(n,t,r)=>t in n?qS(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,as=(n,t)=>{for(var r in t||(t={}))HS.call(t,r)&&Cf(n,r,t[r]);if(Nf)for(var r of Nf(t))KS.call(t,r)&&Cf(n,r,t[r]);return n},$f=(n,t)=>zS(n,kS(t));function zo(n){return Number(n[0].split(":")[1])}function jc(n){return`0x${n.toString(16)}`}function BS(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:a,events:u,optionalEvents:f,rpcMap:g}=n;if(!Xr(t))throw new Error("Invalid chains");const v={chains:t,methods:s||Gc,events:u||Jc,rpcMap:as({},t.length?{[zo(t)]:g[zo(t)]}:{})},y=u==null?void 0:u.filter(z=>!Jc.includes(z)),_=s==null?void 0:s.filter(z=>!Gc.includes(z));if(!r&&!f&&!a&&!(y!=null&&y.length)&&!(_!=null&&_.length))return{required:t.length?v:void 0};const x=(y==null?void 0:y.length)&&(_==null?void 0:_.length)||!r,M={chains:[...new Set(x?v.chains.concat(r||[]):r)],methods:[...new Set(v.methods.concat(a!=null&&a.length?a:LS))],events:[...new Set(v.events.concat(f!=null&&f.length?f:US))],rpcMap:g};return{required:t.length?v:void 0,optional:r.length?M:void 0}}class pu{constructor(){this.events=new Cr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=jS,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new pu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=BS(this.rpc);try{const a=await new Promise(async(f,g)=>{var v;this.rpc.showQrModal&&((v=this.modal)==null||v.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect($f(as({namespaces:as({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(y=>{f(y)}).catch(y=>{g(new Error(y.message))})});if(!a)return;const u=Qw(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:u),this.setAccounts(u),this.events.emit("connect",{chainId:jc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",jc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",$f(as({},bt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",jc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,a]=t.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const a=(r=t==null?void 0:t.chains)!=null?r:[],u=(s=t==null?void 0:t.optionalChains)!=null?s:[],f=a.concat(u);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=a.length?(t==null?void 0:t.methods)||Gc:[],v=a.length?(t==null?void 0:t.events)||Jc:[],y=(t==null?void 0:t.optionalMethods)||[],_=(t==null?void 0:t.optionalEvents)||[],x=(t==null?void 0:t.rpcMap)||this.buildRpcMap(f,t.projectId),M=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(z=>this.formatChainId(z)),optionalChains:u.map(z=>this.formatChainId(z)),methods:g,events:v,optionalMethods:y,optionalEvents:_,rpcMap:x,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:M,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?zo(this.rpc.chains):zo(this.rpc.optionalChains),this.signer=await CS.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await Cw(()=>import("./index-ONNC42Bc.js").then(a=>a.i),__vite__mapDeps([0,1,2]));r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(as({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:a}=t;r&&Xr(r)&&(this.rpc.chains=r.map(u=>this.formatChainId(u)),r.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)})),s&&Xr(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(u=>this.formatChainId(u)),s.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${MS}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const cP=pu;export{cP as EthereumProvider,US as OPTIONAL_EVENTS,LS as OPTIONAL_METHODS,Jc as REQUIRED_EVENTS,Gc as REQUIRED_METHODS,pu as default};
